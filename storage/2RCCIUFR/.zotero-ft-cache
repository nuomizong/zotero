The Finite Element Method: Its Basis and Fundamentals
Sixth edition
O.C. Zienkiewicz, CBE, FRS
UNESCO Professor of Numerical Methods in Engineering International Centre for Numerical Methods in Engineering, Barcelona Previously Director of the Institute for Numerical Methods in Engineering University of Wales, Swansea

R.L. Taylor
Professor in the Graduate School Department of Civil and Environmental Engineering University of California at Berkeley Berkeley, California

J.Z. Zhu
Senior Scientist ESI US R & D Inc. 5850 Waterloo Road, Suite 140 Columbia, Maryland

AMSTERDAM • BOSTON • HEIDELBERG • LONDON • NEW YORK • OXFORD PARIS • SAN DIEGO • SAN FRANCISCO • SINGAPORE • SYDNEY • TOKYO

Elsevier Butterworth-Heinemann Linacre House, Jordan Hill, Oxford OX2 8DP 30 Corporate Drive, Burlington, MA 01803 First published in 1967 by McGraw-Hill Fifth edition published by Butterworth-Heinemann 2000 Reprinted 2002 Sixth edition 2005 Copyright c 2000, 2005. O.C. Zienkiewicz, R.L. Taylor and J.Z. Zhu. All rights reserved The rights of O.C. Zienkiewicz, R.L. Taylor and J.Z. Zhu to be identiﬁed as the authors of this work have been asserted in accordance with the Copyright, Designs and Patents Act 1988
No part of this publication may be reproduced in any material form (including photocopying or storing in any medium by electronic means and whether or not transiently or incidentally to some other use of this publication) without the written permission of the copyright holder except in accordance with the provisions of the Copyright, Designs and Patents Act 1988 or under the terms of a licence issued by the Copyright Licensing Agency Ltd, 90, Tottenham Court Road, London, England W1T 4LP. Applications for the copyright holder’s written permission to reproduce any part of this publication should be addressed to the publisher. Permissions may be sought directly from Elsevier’s Science & Technology Rights Department in Oxford, UK: phone: (+44) 1865 843830, fax: (+44) 1865 853333, e-mail: permissions @ elsevier.co.uk. You may also complete your request on-line via the Elsevier homepage (http://www.elsevier.com), by selecting ‘Customer Support’ and then ‘Obtaining Permissions’

British Library Cataloguing in Publication Data A catalogue record for this book is available from the British Library Library of Congress Cataloguing in Publication Data A catalogue record for this book is available from the Library of Congress ISBN 0 7506 6320 0 Published with the cooperation of CIMNE, the International Centre for Numerical Methods in Engineering, Barcelona, Spain (www.cimne.upc.es) For information on all Elsevier Butterworth-Heinemann publications visit our website at http://books.elsevier.com Typeset by Kolam Information Services P Ltd, Pondicherry, India

Dedication

This book is dedicated to our wives Helen, Mary Lou and Song and our families for their support and patience during the preparation of this book, and also to all of our students and colleagues who over the years have contributed to our knowledge of the ﬁnite element method. In particular we would like to mention Professor Eugenio Onate and his ˜ group at CIMNE for their help, encouragement and support during the preparation process.

Preface

It is thirty-eight years since the The Finite Element Method in Structural and Continuum Mechanics was ﬁrst published. This book, which was the ﬁrst dealing with the ﬁnite element method, provided the basis from which many further developments occurred. The expanding research and ﬁeld of application of ﬁnite elements led to the second edition in 1971, the third in 1977, the fourth as two volumes in 1989 and 1991 and the ﬁfth as three volumes in 2000. The size of each of these editions expanded geometrically (from 272 pages in 1967 to the ﬁfth edition of 1482 pages). This was necessary to do justice to a rapidly expanding ﬁeld of professional application and research. Even so, much ﬁltering of the contents was necessary to keep these editions within reasonable bounds. In the present edition we have decided not to pursue the course of having three contiguous volumes but rather we treat the whole work as an assembly of three separate works, each one capable of being used without the others and each one appealing perhaps to a different audience. Though naturally we recommend the use of the whole ensemble to people wishing to devote much of their time and study to the ﬁnite element method. In particular the ﬁrst volume which was entitled The Finite Element Method: The Basis is now renamed The Finite Element Method: Its Basis and Fundamentals. This volume has been considerably reorganized from the previous one and is now, we believe, better suited for teaching fundamentals of the ﬁnite element method. The sequence of chapters has been somewhat altered and several examples of worked problems have been added to the text. A set of problems to be worked out by students has also been provided. In addition to its previous content this book has been considerably enlarged by including more emphasis on use of higher order shape functions in formulation of problems and a new chapter devoted to the subject of automatic mesh generation. A beginner in the ﬁnite element ﬁeld will ﬁnd very rapidly that much of the work of solving problems consists of preparing a suitable mesh to deal with the whole problem and as the size of computers has seemed to increase without limits the size of problems capable of being dealt with is also increasing. Thus, meshes containing sometimes more than several million nodes have to be prepared with details of the material interfaces, boundaries and loads being well speciﬁed. There are many books devoted exclusively to the subject of mesh generation but we feel that the essence of dealing with this difﬁcult problem should be included here for those who wish to have a complete ‘encyclopedic’ knowledge of the subject.

xiv

Preface

The chapter on computational methods is much reduced by transferring the computer source program and user instructions to a web site.† This has the very substantial advantage of not only eliminating errors in program and manual but also in ensuring that the readers have the beneﬁt of the most recent version of the program available at all times. The two further volumes form again separate books and here we feel that a completely different audience will use them. The ﬁrst of these is entitled The Finite Element Method in Solid and Structural Mechanics and the second is a text entitled The Finite Element Method in Fluid Dynamics. Each of these two volumes is a standalone text which provides the full knowledge of the subject for those who have acquired an introduction to the ﬁnite element method through other texts. Of course the viewpoint of the authors introduced in this volume will be continued but it is possible to start at a different point. We emphasize here the fact that all three books stress the importance of considering the ﬁnite element method as a unique and whole basis of approach and that it contains many of the other numerical analysis methods as special cases. Thus, imagination and knowledge should be combined by the readers in their endeavours. The authors are particularly indebted to the International Center of Numerical Methods in Engineering (CIMNE) in Barcelona who have allowed their pre- and post-processing code (GiD) to be accessed from the web site. This allows such difﬁcult tasks as mesh generation and graphic output to be dealt with efﬁciently. The authors are also grateful to Professors Eric Kasper and Jose Luis Perez-Aparicio for their careful scrutiny of the entire text and Drs Joaquim Peiro and C.K. Lee for their review of the new chapter on mesh generation. ´

Resources to accompany this book
Worked solutions to selected problems in this book are available online for teachers and lecturers who either adopt or recommend the text. Please visit http://books.elsevier.com/ manuals and follow the registration and log in instructions on screen. OCZ, RLT and JZZ

† Complete source code and user manual for program FEAPpv may be obtained at no cost from the publisher’s web page: http://books.elsevier.com/companions or from the authors’ web page: http://www.ce.berkeley.edu/˜rlt

Contents

Preface 1 The standard discrete system and origins of the ﬁnite element method 1.1 Introduction 1.2 The structural element and the structural system 1.3 Assembly and analysis of a structure 1.4 The boundary conditions 1.5 Electrical and ﬂuid networks 1.6 The general pattern 1.7 The standard discrete system 1.8 Transformation of coordinates 1.9 Problems 2 A direct physical approach to problems in elasticity: plane stress 2.1 Introduction 2.2 Direct formulation of ﬁnite element characteristics 2.3 Generalization to the whole region – internal nodal force concept abandoned 2.4 Displacement approach as a minimization of total potential energy 2.5 Convergence criteria 2.6 Discretization error and convergence rate 2.7 Displacement functions with discontinuity between elements – non-conforming elements and the patch test 2.8 Finite element solution process 2.9 Numerical examples 2.10 Concluding remarks 2.11 Problems 3 Generalization of the ﬁnite element concepts. Galerkin-weighted residual and variational approaches 3.1 Introduction 3.2 Integral or ‘weak’ statements equivalent to the differential equations 3.3 Approximation to integral formulations: the weighted residualGalerkin method

xiii 1 1 3 5 6 7 9 10 11 13 19 19 20 31 34 37 38 39 40 40 46 47 54 54 57 60

viii

Contents

3.4 3.5 3.6 3.7 3.8 3.9 3.10 3.11 3.12 3.13 3.14 3.15 4

Virtual work as the ‘weak form’ of equilibrium equations for analysis of solids or ﬂuids Partial discretization Convergence What are ‘variational principles’? ‘Natural’ variational principles and their relation to governing differential equations Establishment of natural variational principles for linear, self-adjoint, differential equations Maximum, minimum, or a saddle point? Constrained variational principles. Lagrange multipliers Constrained variational principles. Penalty function and perturbed lagrangian methods Least squares approximations Concluding remarks – ﬁnite difference and boundary methods Problems

69 71 74 76 78 81 83 84 88 92 95 97 103 103 104 107 109 110 112 116 119 120 121 122 125 125 128 128 130 131 132 134 134 138 138 139 143 143

‘Standard’ and ‘hierarchical’ element shape functions: some general families of C0 continuity 4.1 Introduction 4.2 Standard and hierarchical concepts 4.3 Rectangular elements – some preliminary considerations 4.4 Completeness of polynomials 4.5 Rectangular elements – Lagrange family 4.6 Rectangular elements – ‘serendipity’ family 4.7 Triangular element family 4.8 Line elements 4.9 Rectangular prisms – Lagrange family 4.10 Rectangular prisms – ‘serendipity’ family 4.11 Tetrahedral elements 4.12 Other simple three-dimensional elements 4.13 Hierarchic polynomials in one dimension 4.14 Two- and three-dimensional, hierarchical elements of the ‘rectangle’ or ‘brick’ type 4.15 Triangle and tetrahedron family 4.16 Improvement of conditioning with hierarchical forms 4.17 Global and local ﬁnite element approximation 4.18 Elimination of internal parameters before assembly – substructures 4.19 Concluding remarks 4.20 Problems Mapped elements and numerical integration – ‘inﬁnite’ and ‘singularity elements’ 5.1 Introduction 5.2 Use of ‘shape functions’ in the establishment of coordinate transformations 5.3 Geometrical conformity of elements 5.4 Variation of the unknown function within distorted, curvilinear elements. Continuity requirements

5

Contents

ix

5.5 5.6 5.7 5.8 5.9 5.10 5.11 5.12 5.13 5.14 5.15 5.16 5.17 6

Evaluation of element matrices. Transformation in ξ, η, ζ coordinates Evaluation of element matrices. Transformation in area and volume coordinates Order of convergence for mapped elements Shape functions by degeneration Numerical integration – one dimensional Numerical integration – rectangular (2D) or brick regions (3D) Numerical integration – triangular or tetrahedral regions Required order of numerical integration Generation of ﬁnite element meshes by mapping. Blending functions Inﬁnite domains and inﬁnite elements Singular elements by mapping – use in fracture mechanics, etc. Computational advantage of numerically integrated ﬁnite elements Problems

145 148 151 153 160 162 164 164 169 170 176 177 178 187 187 188 201 207 209 217 229 229 230 233 237 239 253 253 264 264 266 286 303 323 323 329 329 330 332 334 336 336

Problems in linear elasticity 6.1 Introduction 6.2 Governing equations 6.3 Finite element approximation 6.4 Reporting of results: displacements, strains and stresses 6.5 Numerical examples 6.6 Problems Field problems – heat conduction, electric and magnetic potential and ﬂuid ﬂow 7.1 Introduction 7.2 General quasi-harmonic equation 7.3 Finite element solution process 7.4 Partial discretization – transient problems 7.5 Numerical examples – an assessment of accuracy 7.6 Concluding remarks 7.7 Problems

7

8 Automatic mesh generation 8.1 Introduction 8.2 Two-dimensional mesh generation – advancing front method 8.3 Surface mesh generation 8.4 Three-dimensional mesh generation – Delaunay triangulation 8.5 Concluding remarks 8.6 Problems 9 The patch test, reduced integration, and non-conforming elements 9.1 Introduction 9.2 Convergence requirements 9.3 The simple patch test (tests A and B) – a necessary condition for convergence 9.4 Generalized patch test (test C) and the single-element test 9.5 The generality of a numerical patch test 9.6 Higher order patch tests

x

Contents

9.7

Application of the patch test to plane elasticity elements with ‘standard’ and ‘reduced’ quadrature 9.8 Application of the patch test to an incompatible element 9.9 Higher order patch test – assessment of robustness 9.10 Concluding remarks 9.11 Problems

337 343 347 347 350 356 356 358 360 363 370 375 379 379 383 383 383 384 393 398 404 407 421 422 429 429 430 436 442 445 451 451 451 456 456 459 465

10

Mixed formulation and constraints – complete ﬁeld methods 10.1 Introduction 10.2 Discretization of mixed forms – some general remarks 10.3 Stability of mixed approximation. The patch test 10.4 Two-ﬁeld mixed formulation in elasticity 10.5 Three-ﬁeld mixed formulations in elasticity 10.6 Complementary forms with direct constraint 10.7 Concluding remarks – mixed formulation or a test of element ‘robustness’ 10.8 Problems Incompressible problems, mixed methods and other procedures of solution 11.1 Introduction 11.2 Deviatoric stress and strain, pressure and volume change 11.3 Two-ﬁeld incompressible elasticity (u–p form) 11.4 Three-ﬁeld nearly incompressible elasticity (u–p–εv form) 11.5 Reduced and selective integration and its equivalence to penalized mixed problems 11.6 A simple iterative solution process for mixed problems: Uzawa method 11.7 Stabilized methods for some mixed elements failing the incompressibility patch test 11.8 Concluding remarks 11.9 Problems Multidomain mixed approximations – domain decomposition and ‘frame’ methods 12.1 Introduction 12.2 Linking of two or more subdomains by Lagrange multipliers 12.3 Linking of two or more subdomains by perturbed lagrangian and penalty methods 12.4 Interface displacement ‘frame’ 12.5 Linking of boundary (or Trefftz)-type solution by the ‘frame’ of speciﬁed displacements 12.6 Subdomains with ‘standard’ elements and global functions 12.7 Concluding remarks 12.8 Problems Errors, recovery processes and error estimates 13.1 Deﬁnition of errors 13.2 Superconvergence and optimal sampling points 13.3 Recovery of gradients and stresses

11

12

13

Contents

xi

Superconvergent patch recovery – SPR Recovery by equilibration of patches – REP Error estimates by recovery Residual-based methods Asymptotic behaviour and robustness of error estimators – the Babu ska patch test ˇ 13.9 Bounds on quantities of interest 13.10 Which errors should concern us? 13.11 Problems 14 Adaptive ﬁnite element reﬁnement 14.1 Introduction 14.2 Adaptive h-reﬁnement 14.3 p-reﬁnement and hp-reﬁnement 14.4 Concluding remarks 14.5 Problems 15 Point-based and partition of unity approximations. Extended ﬁnite element methods 15.1 Introduction 15.2 Function approximation 15.3 Moving least squares approximations – restoration of continuity of approximation 15.4 Hierarchical enhancement of moving least squares expansions 15.5 Point collocation – ﬁnite point methods 15.6 Galerkin weighting and ﬁnite volume methods 15.7 Use of hierarchic and special functions based on standard ﬁnite elements satisfying the partition of unity requirement 15.8 Concluding remarks 15.9 Problems

13.4 13.5 13.6 13.7 13.8

467 474 476 478 488 490 494 495 500 500 503 514 518 520 525 525 527 533 538 540 546 549 558 558 563 563 563 570 571 576 578 579 579 583 584 589 589

16 The time dimension – semi-discretization of ﬁeld and dynamic problems and analytical solution procedures 16.1 Introduction 16.2 Direct formulation of time-dependent problems with spatial ﬁnite element subdivision 16.3 General classiﬁcation 16.4 Free response – eigenvalues for second-order problems and dynamic vibration 16.5 Free response – eigenvalues for ﬁrst-order problems and heat conduction, etc. 16.6 Free response – damped dynamic eigenvalues 16.7 Forced periodic response 16.8 Transient response by analytical procedures 16.9 Symmetry and repeatability 16.10 Problems 17 The time dimension – discrete approximation in time 17.1 Introduction

xii

Contents

17.2 17.3 17.4 17.5 17.6 17.7 17.8 17.9 18

Simple time-step algorithms for the ﬁrst-order equation General single-step algorithms for ﬁrst- and second-order equations Stability of general algorithms Multistep recurrence algorithms Some remarks on general performance of numerical algorithms Time discontinuous Galerkin approximation Concluding remarks Problems

590 600 609 615 618 619 624 626 631 631 634 645 653 655 660 664 664 664 666 666 667 668 674 683 692 693 694 699 701 704 711 719

Coupled systems 18.1 Coupled problems – deﬁnition and classiﬁcation 18.2 Fluid–structure interaction (Class I problems) 18.3 Soil–pore ﬂuid interaction (Class II problems) 18.4 Partitioned single-phase systems – implicit–explicit partitions (Class I problems) 18.5 Staggered solution processes 18.6 Concluding remarks Computer procedures for ﬁnite element analysis 19.1 Introduction 19.2 Pre-processing module: mesh creation 19.3 Solution module 19.4 Post-processor module 19.5 User modules

19

Appendix A: Matrix algebra Appendix B: Tensor-indicial notation in the approximation of elasticity problems Appendix C: Solution of simultaneous linear algebraic equations Appendix D: Some integration formulae for a triangle Appendix E: Some integration formulae for a tetrahedron Appendix F: Some vector algebra Appendix G: Integration by parts in two or three dimensions (Green’s theorem) Appendix H: Solutions exact at nodes Appendix I: Matrix diagonalization or lumping Author index Subject index

1 The standard discrete system and origins of the finite element method
1.1 Introduction
The limitations of the human mind are such that it cannot grasp the behaviour of its complex surroundings and creations in one operation. Thus the process of subdividing all systems into their individual components or ‘elements’, whose behaviour is readily understood, and then rebuilding the original system from such components to study its behaviour is a natural way in which the engineer, the scientist, or even the economist proceeds. In many situations an adequate model is obtained using a ﬁnite number of well-deﬁned components. We shall term such problems discrete. In others the subdivision is continued indeﬁnitely and the problem can only be deﬁned using the mathematical ﬁction of an inﬁnitesimal. This leads to differential equations or equivalent statements which imply an inﬁnite number of elements. We shall term such systems continuous. With the advent of digital computers, discrete problems can generally be solved readily even if the number of elements is very large. As the capacity of all computers is ﬁnite, continuous problems can only be solved exactly by mathematical manipulation. The available mathematical techniques for exact solutions usually limit the possibilities to oversimpliﬁed situations. To overcome the intractability of realistic types of continuous problems (continuum), various methods of discretization have from time to time been proposed by engineers, scientists and mathematicians. All involve an approximation which, hopefully, approaches in the limit the true continuum solution as the number of discrete variables increases. The discretization of continuous problems has been approached differently by mathematicians and engineers. Mathematicians have developed general techniques applicable directly to differential equations governing the problem, such as ﬁnite difference approximations,1–3 various weighted residual procedures,4, 5 or approximate techniques for determining the stationarity of properly deﬁned ‘functionals’.6 The engineer, on the other hand, often approaches the problem more intuitively by creating an analogy between real discrete elements and ﬁnite portions of a continuum domain. For instance, in the ﬁeld of solid mechanics McHenry,7 Hrenikoff,8 Newmark,9 and Southwell2 in the 1940s, showed that reasonably good solutions to an elastic continuum problem can be obtained by replacing small portions of the continuum by an arrangement of simple elastic bars. Later, in the same context, Turner et al.10 showed that a more direct, but no less intuitive, substitution of properties

2

The standard discrete system and origins of the finite element method

can be made much more effectively by considering that small portions or ‘elements’ in a continuum behave in a simpliﬁed manner. It is from the engineering ‘direct analogy’ view that the term ‘ﬁnite element’ was born. Clough11 appears to be the ﬁrst to use this term, which implies in it a direct use of a standard methodology applicable to discrete systems (see also reference 12 for a history on early developments). Both conceptually and from the computational viewpoint this is of the utmost importance. The ﬁrst allows an improved understanding to be obtained; the second offers a uniﬁed approach to the variety of problems and the development of standard computational procedures. Since the early 1960s much progress has been made, and today the purely mathematical and ‘direct analogy’approaches are fully reconciled. It is the object of this volume to present a view of the ﬁnite element method as a general discretization procedure of continuum problems posed by mathematically deﬁned statements. In the analysis of problems of a discrete nature, a standard methodology has been developed over the years. The civil engineer, dealing with structures, ﬁrst calculates force– displacement relationships for each element of the structure and then proceeds to assemble the whole by following a well-deﬁned procedure of establishing local equilibrium at each ‘node’ or connecting point of the structure. The resulting equations can be solved for the unknown displacements. Similarly, the electrical or hydraulic engineer, dealing with a network of electrical components (resistors, capacitances, etc.) or hydraulic conduits, ﬁrst establishes a relationship between currents (ﬂuxes) and potentials for individual elements and then proceeds to assemble the system by ensuring continuity of ﬂows. All such analyses follow a standard pattern which is universally adaptable to discrete systems. It is thus possible to deﬁne a standard discrete system, and this chapter will be primarily concerned with establishing the processes applicable to such systems. Much of what is presented here will be known to engineers, but some reiteration at this stage is advisable. As the treatment of elastic solid structures has been the most developed area of activity this will be introduced ﬁrst, followed by examples from other ﬁelds, before attempting a complete generalization. The existence of a uniﬁed treatment of ‘standard discrete problems’ leads us to the ﬁrst deﬁnition of the ﬁnite element process as a method of approximation to continuum problems such that (a) the continuum is divided into a ﬁnite number of parts (elements), the behaviour of which is speciﬁed by a ﬁnite number of parameters, and (b) the solution of the complete system as an assembly of its elements follows precisely the same rules as those applicable to standard discrete problems. The development of the standard discrete system can be followed most closely through the work done in structural engineering during the nineteenth and twentieth centuries. It appears that the ‘direct stiffness process’ was ﬁrst introduced by Navier in the early part of the nineteenth century and brought to its modern form by Clebsch13 and others. In the twentieth century much use of this has been made and Southwell,14 Cross15 and others have revolutionized many aspects of structural engineering by introducing a relaxation iterative process. Just before the Second World War matrices began to play a larger part in casting the equations and it was convenient to restate the procedures in matrix form. The work of Duncan and Collar,16–18 Argyris,19 Kron20 and Turner 10 should be noted. A thorough study of direct stiffness and related methods was recently conducted by Samuelsson.21

The structural element and the structural system

3

It will be found that most classical mathematical approximation procedures as well as the various direct approximations used in engineering fall into this category. It is thus difﬁcult to determine the origins of the ﬁnite element method and the precise moment of its invention. Table 1.1 shows the process of evolution which led to the present-day concepts of ﬁnite element analysis. A historical development of the subject of ﬁnite element methods has been presented by the ﬁrst author in references 34–36. Chapter 3 will give, in more detail, the mathematical basis which emerged from these classical ideas.1, 22–27, 29, 30, 32

1.2 The structural element and the structural system
To introduce the reader to the general concept of discrete systems we shall ﬁrst consider a structural engineering example with linear elastic behaviour. Figure 1.1 represents a two-dimensional structure assembled from individual components and interconnected at the nodes numbered 1 to 6. The joints at the nodes, in this case, are pinned so that moments cannot be transmitted. As a starting point it will be assumed that by separate calculation, or for that matter from the results of an experiment, the characteristics of each element are precisely known. Thus, if a typical element labelled (1) and associated with nodes 1, 2, 3 is examined, the forces acting at the nodes are uniquely deﬁned by the displacements of these nodes, the distributed loading acting on the element ( p), and its initial strain. The last may be due to temperature, shrinkage, or simply an initial ‘lack of ﬁt’. The forces and the corresponding
Table 1.1 History of approximate methods ENGINEERING Trial functions Rayleigh 187022 Ritz 190823 Variational methods Rayleigh 187022 Ritz 190823 − − − −− → Structural analogue substitution Hrenikoff 19418 McHenry 194328 Newmark 19499 − −→ − Direct continuum − − − − elements − − − − Turner et al. 195610 − − −− → MATHEMATICS Finite differences Richardson 19101 Liebman 191824 Southwell 19462 Weighted residuals Gauss 179525 Galerkin 191526 Biezeno–Koch 192327 −−−−−−−−−− − − − − − − − − − −→

Piecewise continuous trial functions Courant 194329 Prager–Synge 194730 Argyris 195519 Zienkiewicz 196431 −−−−−− − − − − − −→ PRESENT-DAY FINITE ELEMENT METHOD

→ −− − − − − − − − − − −

− −− −− →

Variational ﬁnite differences Varga 196232 Wilkins 196433

4

The standard discrete system and origins of the finite element method
Y4 3 p y (1) 1 x v3(V3) 3 p y (1) 2 1 x A typical element (1) Nodes u3(U3) (3) 2 5 (2) 4 X4 (4) 6

Fig. 1.1 A typical structure built up from interconnected elements.

displacements are deﬁned by appropriate components (U , V and u, v) in a common coordinate system (x, y). Listing the forces acting on all the nodes (three in the case illustrated) of the element (1) as a matrix† we have ⎧ 1⎫ ⎪q1 ⎪ ⎨ ⎬ U1 1 1 1 q1 = , etc. (1.1) q = q2 V1 ⎪ 1⎪ ⎩ ⎭ q3 and for the corresponding nodal displacements ⎧ 1⎫ ⎪ u1 ⎪ ⎨ ⎬ 1 u1 = u = u1 1 ⎪ 2⎪ ⎩ 1⎭ u3

u1 , v1

etc.

(1.2)

Assuming linear elastic behaviour of the element, the characteristic relationship will always be of the form (1.3) q 1 = K 1 u1 + f 1 in which f 1 represents the nodal forces required to balance any concentrated or distributed loads acting on the element. The ﬁrst of the terms represents the forces induced by displacement of the nodes. The matrix K e is known as the stiffness matrix for the element (e). Equation (1.3) is illustrated by an example of an element with three nodes with the interconnection points capable of transmitting only two components of force. Clearly, the
†A limited knowledge of matrix algebra will be assumed throughout this book. This is necessary for reasonable conciseness and forms a convenient book-keeping form. For readers not familiar with the subject a brief appendix (Appendix A) is included in which sufﬁcient principles of matrix algebra are given to follow the development intelligently. Matrices and vectors will be distinguished by bold print throughout.

Assembly and analysis of a structure

5

same arguments and deﬁnitions will apply generally. An element (2) of the hypothetical structure will possess only two points of interconnection; others may have quite a large number of such points. Quite generally, therefore, ⎧ e⎫ ⎧ ⎫ ⎪ q1 ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ e⎪ ⎪ u1 ⎪ ⎪q ⎪ ⎪ ⎪ ⎨ 2⎬ ⎨ u2 ⎬ e e q = and u = (1.4) . . ⎪ ⎪ . ⎪ ⎪ . ⎪ ⎪ . ⎪ ⎪ . ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎩ ⎭ ⎩ e⎭ um qm
e with each qa and ua possessing the same number of components or degrees of freedom. The stiffness matrices of the element will clearly always be square and of the form ⎤ ⎡ e e e K11 K12 · · · K1m ⎢ e . ⎥ .. . ⎥ ⎢K . . ⎥ K e = ⎢ .21 (1.5) ⎢ . . . ⎥ . . ⎦ ⎣ . . . e e Km1 · · · · · · Kmm e e in which K11 , K12 , etc., are submatrices which are again square and of the size l × l, where l is the number of force and displacement components to be considered at each node. The element properties were assumed to follow a simple linear relationship. In principle, similar relationships could be established for non-linear materials, but discussion of such problems will be postponed at this stage. In most cases considered in this volume the element matrices K e will be symmetric.

1.3 Assembly and analysis of a structure
Consider again the hypothetical structure of Fig. 1.1. To obtain a complete solution the two conditions of (a) displacement compatibility and (b) equilibrium have to be satisﬁed throughout. Any system of nodal displacements u:

⎧ ⎫ ⎪ u1 ⎪ ⎨ ⎬ . . u= ⎪.⎪ ⎩ ⎭ un

(1.6)

listed now for the whole structure in which all the elements participate, automatically satisﬁes the ﬁrst condition. As the conditions of overall equilibrium have already been satisﬁed within an element, all that is necessary is to establish equilibrium conditions at the nodes (or assembly points) of the structure. The resulting equations will contain the displacements as unknowns, and once these have been solved the structural problem is determined. The internal forces in elements, or the stresses, can easily be found by using the characteristics established a priori for each element.

6

The standard discrete system and origins of the finite element method

If now the equilibrium conditions of a typical node, a, are to be established, the sum of the component forces contributed by the elements meeting at the node are simply accumulated. Thus, considering all the force components we have
m e=1 1 2 in which qa is the force contributed to node a by element 1, qa by element 2, etc. Clearly, only the elements which include point a will contribute non-zero forces, but for conciseness in notation all the elements are included in the summation. Substituting the forces contributing to node a from the deﬁnition (1.3) and noting that nodal variables ua are common (thus omitting the superscript e), we have m e=1 e Ka1 u1 + m e=1 e Ka2 u2 + · · · + m e=1 e 1 2 qa = qa + qa + · · · = 0

(1.7)

fie = 0

(1.8)

The summation again only concerns the elements which contribute to node a. If all such equations are assembled we have simply Ku + f = 0 in which the submatrices are
m

(1.9)

Kab =
e=1

e Kab

m

and

fa =
e=1

e fa

(1.10)

with summations including all elements. This simple rule for assembly is very convenient because as soon as a coefﬁcient for a particular element is found it can be put immediately into the appropriate ‘location’ speciﬁed in the computer. This general assembly process can be found to be the common and fundamental feature of all ﬁnite element calculations and should be well understood by the reader. If different types of structural elements are used and are to be coupled it must be remembered that at any given node the rules of matrix summation permit this to be done only if these are of identical size. The individual submatrices to be added have therefore to be built up of the same number of individual components of force or displacement.

1.4 The boundary conditions
The system of equations resulting from Eq. (1.9) can be solved once the prescribed support displacements have been substituted. In the example of Fig. 1.1, where both components of displacement of nodes 1 and 6 are zero, this will mean the substitution of u1 = u6 = 0 0

which is equivalent to reducing the number of equilibrium equations (in this instance 12) by deleting the ﬁrst and last pairs and thus reducing the total number of unknown displacement

Electrical and fluid networks

7

components to eight. It is, nevertheless, often convenient to assemble the equation according to relation (1.9) so as to include all the nodes. Clearly, without substitution of a minimum number of prescribed displacements to prevent rigid body movements of the structure, it is impossible to solve this system, because the displacements cannot be uniquely determined by the forces in such a situation. This physically obvious fact will be interpreted mathematically as the matrix K being singular, i.e., not possessing an inverse. The prescription of appropriate displacements after the assembly stage will permit a unique solution to be obtained by deleting appropriate rows and columns of the various matrices. If all the equations of a system are assembled, their form is K11 u1 + K12 u2 + · · · + f1 = 0 K21 u1 + K22 u2 + · · · + f2 = 0 etc. ¯ and it will be noted that if any displacement, such as u1 = u1 , is prescribed then the total ‘force’ f1 cannot be simultaneously speciﬁed and remains unknown. The ﬁrst equa¯ tion could then be deleted and substitution of known values u1 made in the remaining equations. When all the boundary conditions are inserted the equations of the system can be solved for the unknown nodal displacements and the internal forces in each element obtained. (1.11)

1.5 Electrical and fluid networks
Identical principles of deriving element characteristics and of assembly will be found in many non-structural ﬁelds. Consider, for instance, the assembly of electrical resistances shown in Fig. 1.2. If a typical resistance element, ab, is isolated from the system we can write, by Ohm’s law, the relation between the currents (J ) entering the element at the ends and the end voltages (V ) as 1 1 e e Ja = e (Va − Vb ) and Jb = e (Vb − Va ) (1.12) r r or in matrix form e Va 1 1 −1 Ja = e e −1 1 Jb r Vb which in our standard form is simply Je = K e Ve (1.13)

This form clearly corresponds to the stiffness relationship (1.3); indeed if an external current were supplied along the length of the element the element ‘force’ terms could also be found. To assemble the whole network the continuity of the voltage (V ) at the nodes is assumed and a current balance imposed there. With no external input of current at node a we must

8

The standard discrete system and origins of the finite element method

b

Pa

Jb,Vb b

a re

Ja ,Va a

Fig. 1.2 A network of electrical resistances.

have, with complete analogy to Eq. (1.8),
n m

e Kab Vb = 0

(1.14)

b=1 e=1

where the second summation is over all ‘elements’, and once again for all the nodes KV = 0 in which
m

(1.15)

Kab =
e=1

e Kab

Matrix notation in the latter has been dropped since the quantities such as voltage and current, and hence also the coefﬁcients of the ‘stiffness’ matrix, are scalars. If the resistances were replaced by ﬂuid-carrying pipes in which a laminar regime pertained, an identical formulation would once again result, with V standing for the hydraulic head and J for the ﬂow. For pipe networks that are usually encountered, however, the linear laws are in general not valid and non-linear equations must be solved. Finally it is perhaps of interest to mention the more general form of an electrical network subject to an alternating current. It is customary to write the relationships between

The general pattern

9

the current and voltage in complex arithmetic form with the resistance being replaced by complex impedance. Once again the standard forms of (1.13)–(1.15) will be obtained but with each quantity divided into real and imaginary parts. Identical solution procedures can be used if the equality of the real and imaginary quantities is considered at each stage. Indeed with modern digital computers it is possible to use standard programming practice, making use of facilities available for dealing with complex numbers. Reference to some problems of this class will be made in the sections dealing with vibration problems in Chapter 15.

1.6 The general pattern
An example will be considered to consolidate the concepts discussed in this chapter. This is shown in Fig. 1.3(a) where ﬁve discrete elements are interconnected. These may be of structural, electrical, or any other linear type. In the solution: The ﬁrst step is the determination of element properties from the geometric material and loading data. For each element the ‘stiffness matrix’ as well as the corresponding ‘nodal
1 2 1 3 4 (a) 6 12 7 4 5 8 3 4 5 2 3 5

+

+

+

+

u

=
(b)

+
[K ]

+

+
{f}

+

a

=
BAND

(c)

Fig. 1.3 The general pattern.

10

The standard discrete system and origins of the finite element method

loads’ are found in the form of Eq. (1.3). Each element shown in Fig. 1.3(a) has its own identifying number and speciﬁed nodal connection. For example: element 1 2 3 4 5 connection 1 1 2 3 4 3 4 5 6 7 4 2 7 8 4 5

Assuming that properties are found in global coordinates we can enter each ‘stiffness’ or ‘force’ component in its position of the global matrix as shown in Fig. 1.3(b). Each shaded square represents a single coefﬁcient or a submatrix of type Kab if more than one quantity is being considered at the nodes. Here the separate contribution of each element is shown and the reader can verify the position of the coefﬁcients. Note that the various types of ‘elements’ considered here present no difﬁculty in speciﬁcation. (All ‘forces’, including nodal ones, are here associated with elements for simplicity.) The second step is the assembly of the ﬁnal equations of the type given by Eq. (1.9). This is accomplished according to the rule of Eq. (1.10) by simple addition of all numbers in the appropriate space of the global matrix. The result is shown in Fig. 1.3(c) where the non-zero coefﬁcients are indicated by shading. If the matrices are symmetric only the half above the diagonal shown needs, in fact, to be found. All the non-zero coefﬁcients are conﬁned within a band or proﬁle which can be calculated a priori for the nodal connections. Thus in computer programs only the storage of the elements within the proﬁle (or sparse structure) is necessary, as shown in Fig. 1.3(c). Indeed, if K is symmetric only the upper (or lower) half need be stored. The third step is the insertion of prescribed boundary conditions into the ﬁnal assembled matrix, as discussed in Sec. 1.3. This is followed by the ﬁnal step. The ﬁnal step solves the resulting equation system. Here many different methods can be employed, some of which are summarized in Appendix C. The general subject of equation solving, though extremely important, is in general beyond the scope of this book. The ﬁnal step discussed above can be followed by substitution to obtain stresses, currents, or other desired output quantities. All operations involved in structural or other network analysis are thus of an extremely simple and repetitive kind. We can now deﬁne the standard discrete system as one in which such conditions prevail.

1.7 The standard discrete system
In the standard discrete system, whether it is structural or of any other kind, we ﬁnd that: 1. A set of discrete parameters, say ua , can be identiﬁed which describes simultaneously the behaviour of each element, e, and of the whole system. We shall call these the system parameters.

Transformation of coordinates
e 2. For each element a set of quantities qa can be computed in terms of the system parameters ua . The general function relationship can be non-linear, for example e e qa = qa (u)

11

(1.16)

but in many cases a linear form exists giving
e e e e qa = Ka1 u1 + Ka2 u2 + · · · + fa

(1.17)

3. The ﬁnal system equations are obtained by a simple addition
m

ra =
e=1

e qa = 0

(1.18)

where ra are system quantities (often prescribed as zero). In the linear case this results in a system of equations Ku + f = 0 = 0 (1.19) such that Kab =
e=1 m e Kab m

and

fa =
e=1

e fa

(1.20)

from which the solution for the system variables u can be found after imposing necessary boundary conditions. The reader will observe that this deﬁnition includes the structural, hydraulic, and electrical examples already discussed. However, it is broader. In general neither linearity nor symmetry of matrices need exist – although in many problems this will arise naturally. Further, the narrowness of interconnections existing in usual elements is not essential. While much further detail could be discussed (we refer the reader to speciﬁc books for more exhaustive studies in the structural context37, 38 ), we feel that the general expos´ given e here should sufﬁce for further study of this book. Only one further matter relating to the change of discrete parameters need be mentioned here. The process of so-called transformation of coordinates is vital in many contexts and must be fully understood.

1.8 Transformation of coordinates
It is often convenient to establish the characteristics of an individual element in a coordinate system which is different from that in which the external forces and displacements of the assembled structure or system will be measured. A different coordinate system may, in fact, be used for every element, to ease the computation. It is a simple matter to transform the coordinates of the displacement and force components of Eq. (1.3) to any other coordinate system. Clearly, it is necessary to do so before an assembly of the structure can be attempted. Let the local coordinate system in which the element properties have been evaluated be denoted by a prime sufﬁx and the common coordinate system necessary for assembly have no embellishment. The displacement components can be transformed by a suitable matrix of direction cosines L as u = Lu (1.21)

12

The standard discrete system and origins of the finite element method

As the corresponding force components must perform the same amount of work in either system† qT u = q T u (1.22) On inserting (1.21) we have qT u = q T Lu or q = LT q The set of transformations given by (1.21) and (1.23) is called contravariant. To transform ‘stiffnesses’ which may be available in local coordinates to global ones note that if we write q =Ku (1.24) then by (1.23), (1.24), and (1.21) q = LT K Lu or in global coordinates K = LT K L (1.25) In many complex problems an external constraint of some kind may be imagined, enforcing the requirement (1.21) with the number of degrees of freedom of u and u being quite different. Even in such instances the relations (1.22) and (1.23) continue to be valid. An alternative and more general argument can be applied to many other situations of discrete analysis. We wish to replace a set of parameters u in which the system equations have been written by another one related to it by a transformation matrix T as u = Tv In the linear case the system equations are of the form Ku = −f and on the substitution we have KTv = −f The new system can be premultiplied simply by T , yielding (TT KT)v = TT − TT f (1.29)
T

(1.23)

(1.26)

(1.27) (1.28)

which will preserve the symmetry of equations if the matrix K is symmetric. However, occasionally the matrix T is not square and expression (1.26) represents in fact an approximation in which a larger number of parameters u is constrained. Clearly the system of equations (1.28) gives more equations than are necessary for a solution of the reduced set of parameters v, and the ﬁnal expression (1.29) presents a reduced system which in some sense approximates the original one. We have thus introduced the basic idea of approximation, which will be the subject of subsequent chapters where inﬁnite sets of quantities are reduced to ﬁnite sets.
†With ( )T standing for the transpose of the matrix.

Problems

13

1.9 Problems
1.1 A simple ﬂuid network to transport water is shown in Fig. 1.4. Each ‘element’ of the network is modelled in terms of the ﬂow, J, and head, V, which are approximated by the linear relation Je = −K e Ve where K e is the coefﬁcient array for element (e). The individual terms in the ﬂow vector denote the total amount of ﬂow entering (+) or leaving (−) each end point. The properties of the elements are given by ⎡ ⎤ 3 −2 −1 4 −2⎦ K e = ce ⎣−2 −1 −2 3 for elements 1 and 4, and for elements 2 and 3 by K e = ce 1 −1 −1 1

where ce is an element related parameter. The system is operating with a known head of 100 m at node 1 and 30 m at node 6. At node 2, 30 cubic metres of water per hour are being used and at node 4, 10 cubic metres per hour. (a) For all ce = 1, assemble the total matrix from the individual elements to give J = KV N.B. J contains entries for the speciﬁed usage and connection points. (b) Impose boundary conditions by modifying J and K such that the known heads at nodes 1 and 6 are recovered. (c) Solve the equations for the heads at nodes 2 to 5. (Result at node 4 should be V4 = 30.8133 m.) (d) Determine the ﬂow entering and leaving each element. 1.2 A plane truss may be described as a standard discrete problem by expressing the characteristics for each member in terms of end displacements and forces. The behaviour of the elastic member shown in Fig. 1.5 with modulus E, cross-section A and length L is given by q = Ke u
3 1 (4) (1) (3) 2 5 6 (2) 4

Fig. 1.4 Fluid network for Problem 1.1.

14

The standard discrete system and origins of the finite element method

EA 1 −1 1 L −1 To obtain the ﬁnal assembled matrices for a standard discrete problem it is necessary to transform the behaviour to a global frame using Eqs 1.23 and 1.25 where ⎧ ⎫ ⎧ ⎫ ⎪ u1 ⎪ ⎪U1 ⎪ ⎪ ⎪ ⎪ ⎬ ⎨ ⎬ ⎨ ⎪ V1 v1 cos θ sin θ 0 0 and u = L= ; q= 0 0 cos θ sin θ ⎪u2 ⎪ ⎪U2 ⎪ ⎪ ⎪ ⎪ ⎪ ⎩ ⎭ ⎩ ⎭ V2 v2 q = U1 ; u = U2 u1 u2 and Ke = (a) Compute relations for q and K in terms of L, q and Ke . (b) If the numbering for the end nodes is reversed what is the ﬁnal form for K compared to that given in (a)? Verify your answer when θ = 30o . 1.3 A plane truss has nodes numbered as shown in Fig. 1.6(a). (a) Use the procedure shown in Fig. 1.3 to deﬁne the non-zero structure of the coefﬁcient matrix K. Compute the maximum bandwidth. (b) Determine the non-zero structure of K for the numbering of nodes shown in 1.6(b). Compute the maximum bandwidth. Which order produces the smallest band? 1.4 Write a small computer program (e.g., using MATLAB39 ) to solve the truss problem shown in Fig. 1.6(b). Let the total span of the truss be 2.5 m and the height 0.8 m and use steel as the property for each member with E = 200 GPa and A = 0.001 m2 . Restrain node 1 in both the u and v directions and the right bottom node in the v direction only. Apply a vertical load of 100 N at the position of node 6 shown in Fig. 1.6(b). Determine the maximum vertical displacement at any node. Plot the undeformed and deformed position of the truss (increase the magnitude of displacements to make the shape visible on the plot). You can verify your result using the program FEAPpv available at the publisher’s web site (see Chapter 18). 1.5 An axially loaded elastic bar has a variable cross-section and lengths as shown in Fig. 1.7(a). The problem is converted into a standard discrete system by considering each prismatic section as a separate member. The array for each member segment is given as q e = K e ue
y (v,V ) u 92 x9

where

y9 u1 9 θ 1

2

u9

v

x (u,U ) (a) Truss member description

q u (b) Displacements

Fig. 1.5 Truss member for Problem 1.2.

Problems

15

where Ke = EAe 1 h −1 −1 e q = 1
e qe e qe+1

and ue =

ue ue+1

Equilibrium for the standard discrete problem at joint e is obtained by combining results from segment e − 1 and e as
e e−1 qe + qe + Ue = 0

where Ue is any external force applied to a joint. Boundary conditions are applied for any joint at which the value of ue is known a priori. Solve the problem shown in Fig. 1.7(b) for the joint displacements using the data E1 = E2 = E3 = 200 GPa, A1 = 25 cm2 , A2 = 20 cm2 , A3 = 12 cm2 , L1 = 37.5 cm, L2 = 25.0 cm, L3 = 12.5 cm, P2 = 10 kN, P3 = −3.5 kN and P4 = 6 kN. 1.6 Solve Problem 1.5 for the boundary conditions and loading shown in Fig. 1.7(c). Let E1 = E2 = E3 = 200 GPa, A1 = 30 cm2 , A2 = 20 cm2 , A3 = 10 cm2 , L1 = 37.5 cm, L2 = 30.0 cm, L3 = 25.0 cm, P2 = −10 kN and P3 = 3.5 kN. 1.7 A tapered bar is loaded by an end load P and a uniform loading b as shown in Fig. 1.8(a). The area varies as A(x) = A x/L when the origin of coordinates is located as shown in the ﬁgure. The problem is converted into a standard discrete system by dividing it into equal length segments of constant area as shown in Fig. 1.8(b). The array for each segment is determined from q e = K e ue + f e

7

8

9

10

1

2

3 (a)

4

5

6

3

5

7

9

1

2

4 (b)

6

8

10

Fig. 1.6 Truss for Problems 1.3 and 1.4.

16

The standard discrete system and origins of the finite element method
E1,A1 u1 L1 e=1 E2,A2 u2 L2 (a) Bar geometry e=2 E3,A3 u3 e=3 L3 u4

u1=0

P2

P3

P4

(b) Problem 1.5 u1=0 P2 (c) Problem 1.6 P3 u4=0

Fig. 1.7 Elastic bars. Problems 1.5 and 1.6.

y u1 P L A L (a) Tapered bar geometry b
2A

u2 e=2

u3 e=3 h=L /4

u4 e=4

u5=0

x

e=1

(b) Approximation by 4 segments

Fig. 1.8 Tapered bar. Problem 1.7.

where K e and ue are deﬁned in Problem 1.5 and fe = 1 1

1 2

bh

For the properties L = 100 cm, A = 2 cm2 , E = 104 kN/cm2 , P = 2 kN, b = −0.25 kN/cm and u(2L) = 0, the displacement from the solution of the differential equation is u(L) = −0.03142513 cm. Write a small computer program (e.g., using MATLAB39 ) that solves the problem for the case where e = 1, 2, 4, 8, · · · segments. Continue the solution until the absolute error in the tip displacement is less than 10−5 cm (let error be E = |u(L) − u1 | where u1 is the numerical solution at the end).

References

17

References
1. L.F. Richardson. The approximate arithmetical solution by ﬁnite differences of physical problems. Trans. Roy. Soc. (London), A210:307–357, 1910. 2. R.V. Southwell. Relaxation Methods in Theoretical Physics. Clarendon Press, Oxford, 1st edition, 1946. 3. D.N. de G. Allen. Relaxation Methods. McGraw-Hill, London, 1955. 4. S. Crandall. Engineering Analysis. McGraw-Hill, New York, 1956. 5. B.A. Finlayson. The Method of Weighted Residuals and Variational Principles. Academic Press, New York, 1972. 6. K. Washizu. Variational Methods in Elasticity and Plasticity. Pergamon Press, New York, 3rd edition, 1982. 7. D. McHenry. A lattice analogy for the solution of plane stress problems. J. Inst. Civ. Eng., 21:59–82, 1943. 8. A. Hrenikoff. Solution of problems in elasticity by the framework method. J. Appl. Mech., ASME, A8:169–175, 1941. 9. N.M. Newmark. Numerical methods of analysis in bars, plates and elastic bodies. In L.E. Grinter, editor, Numerical Methods in Analysis in Engineering. Macmillan, New York, 1949. 10. M.J. Turner, R.W. Clough, H.C. Martin, and L.J. Topp. Stiffness and deﬂection analysis of complex structures. J. Aero. Sci., 23:805–823, 1956. 11. R.W. Clough. The ﬁnite element method in plane stress analysis. In Proc. 2nd ASCE Conf. on Electronic Computation, Pittsburgh, Pa., Sept. 1960. 12. R.W. Clough. Early history of the ﬁnite element method from the view point of a pioneer. Int. J. Numer. Meth. Eng., 60:283–287, 2004. 13. R.F. Clebsch. Theorie de l’elasticite des corps solides. Dunod, Paris, 1883. ´ ´ 14. R.V. Southwell. Stress calculation in frame works by the method of systematic relaxation of constraints, Part I & II. Proc. Roy. Soc. London (A), 151:56–95, 1935. 15. Hardy Cross. Continuous Frames of Reinforced Concrete. John Wiley & Sons, New York, 1932. 16. W.J. Duncan and A.R. Collar. A method for the solution of oscillation problems by matrices. Phil. Mag., 17:865, 1934. Series 7. 17. W.J. Duncan and A.R. Collar. Matrices applied to the motions of damped systems. Phil. Mag., 19:197, 1935. Series 7. 18. R.R. Frazer, W.J. Duncan, and A.R. Collar. Elementary Matrices. Cambridge University Press, London, 1960. 19. J.H. Argyris and S. Kelsey. Energy Theorems and Structural Analysis. Butterworths, London, 1960. Reprinted from a series of articles in Aircraft Eng., 1954–55. 20. G. Kron. Equivalent Circuits of Electrical Machinery. John Wiley & Sons, New York, 1951. 21. A. Samuelsson. Personal communication, 2003. 22. Lord Rayleigh (J.W. Strutt). On the theory of resonance. Trans. Roy. Soc. (London), A161:77–118, 1870. ¨ 23. W. Ritz. Uber eine neue Methode zur L¨ sung gewisser variationsproblem der mathematischen o physik. Journal fur die reine und angewandte Mathematik, 135:1–61, 1908. ¨ 24. H. Liebman. Die angen¨ herte Ermittlung: harmonishen, functionen und konformer Abbildung. a Sitzber. Math. Physik Kl. Bayer Akad. Wiss. Munchen, 3:65–75, 1918. ¨ 25. C.F. Gauss. Werke. Dietrich, G¨ ttingen, 1863–1929. See: Theoretishe Astronomie, Bd. VII. o 26. B.G. Galerkin. Series solution of some problems in elastic equilibrium of rods and plates. Vestn. Inzh. Tech., 19:897–908, 1915. 27. C.B. Biezeno and J.J. Koch. Over een Nieuwe Methode ter Berekening van Vlokke Platen. Ing. Grav., 38:25–36, 1923. 28. D. McHenry. A new aspect of creep in concrete and its application to design. Proc. ASTM, 43:1064, 1943.

18

The standard discrete system and origins of the finite element method 29. R. Courant. Variational methods for the solution of problems of equilibrium and vibration. Bull. Am. Math Soc., 49:1–61, 1943. 30. W. Prager and J.L. Synge. Approximation in elasticity based on the concept of function space. Quart. J. Appl. Math, 5:241–269, 1947. 31. O.C. Zienkiewicz and Y.K. Cheung. The ﬁnite element method for analysis of elastic isotropic and orthotropic slabs. Proc. Inst. Civ. Eng., 28:471–488, 1964. 32. R.S. Varga. Matrix Iterative Analysis. Prentice-Hall, Englewood Cliffs, N.J., 1962. 33. M.L. Wilkins. Calculation of elastic-plastic ﬂow. In B. Alder, editor, Methods in Computational Physics, volume 3, pages 211–263. Academic Press, New York, 1964. 34. O.C. Zienkiewicz. Origins, milestones and directions of the ﬁnite element method. Arch. Comp. Meth. Eng., 2:1–48, 1995. 35. O.C. Zienkiewicz. Origins, milestones and directions of the ﬁnite element method. A personal view. In P.G. Ciarlet and J.L Lyons, editors, Handbook of Numerical Analysis, volume IV, pages 3–65. North Holland, 1996. 36. O.C. Zienkiewicz. The birth of the ﬁnite element method and of computational mechanics. Int. J. Numer. Meth. Eng., 60:3–10, 2004. 37. J.S. Przemieniecki. Theory of Matrix Structural Analysis. McGraw-Hill, New York, 1968. 38. R.K. Livesley. Matrix Methods in Structural Analysis. Pergamon Press, New York, 2nd edition, 1975. 39. MATLAB. www.mathworks.com, 2003.

2 A direct physical approach to problems in elasticity: plane stress
2.1 Introduction
The process of approximating the behaviour of a continuum by ‘ﬁnite elements’ which behave in a manner similar to the real, ‘discrete’, elements described in the previous chapter can be introduced through the medium of particular physical applications or as a general mathematical concept. We have chosen here to follow the ﬁrst path, narrowing our view to a set of problems associated with structural mechanics which historically were the ﬁrst to which the ﬁnite element method was applied. In Chapter 3 we shall generalize the concepts and show that the basic ideas are widely applicable. In many phases of engineering the solution of stress and strain distributions in elastic continua is required. Special cases of such problems may range from two-dimensional plane stress or strain distributions, axisymmetric solids, plate bending, and shells, to fully three-dimensional solids. In all cases the number of interconnections between any ‘ﬁnite element’ isolated by some imaginary boundaries and the neighbouring elements is continuous and therefore inﬁnite. It is difﬁcult to see at ﬁrst glance how such problems may be discretized in the same manner as was described in the preceding chapter for simpler systems. The difﬁculty can be overcome (and the approximation made) in the following manner: 1. The continuum is separated by imaginary lines or surfaces into a number of ‘ﬁnite elements’. 2. The elements are assumed to be interconnected at a discrete number of nodal points situated on their boundaries and occasionally in their interior. The displacements of these nodal points will be the basic unknown parameters of the problem, just as in simple, discrete, structural analysis. 3. A set of functions is chosen to deﬁne uniquely the state of displacement within each ‘ﬁnite element’ and on its boundaries in terms of its nodal displacements. 4. The displacement functions now deﬁne uniquely the state of strain within an element in terms of the nodal displacements. These strains, together with any initial strains and the constitutive properties of the material, deﬁne the state of stress throughout the element and, hence, also on its boundaries. 5. A system of ‘equivalent forces’ concentrated at the nodes and equilibrating the boundary stresses and any distributed loads is determined, resulting in a stiffness relationship

20

A direct physical approach to problems in elasticity: plane stress

of the form of Eq. (1.3). The determination of these equivalent forces is done most conveniently and generally using the principle of virtual work which is a particular mathematical relation known as a weak form of the problem. Once this stage has been reached the solution procedure can follow the standard discrete system pattern described in Chapter 1. Clearly a series of approximations has been introduced. First, it is not always easy to ensure that the chosen displacement functions will satisfy the requirement of displacement continuity between adjacent elements. Thus, the compatibility condition on such lines may be violated (though within each element it is obviously satisﬁed due to the uniqueness of displacements implied in their continuous representation). Second, by concentrating the equivalent forces at the nodes, equilibrium conditions are satisﬁed in the overall sense only. Local violation of equilibrium conditions within each element and on its boundaries will usually arise. The choice of element shape and of the form of the displacement function for speciﬁc cases leaves many opportunities for the ingenuity and skill of the analyst to be employed, and obviously the degree of approximation which can be achieved will strongly depend on these factors. The approach outlined here is known as the displacement formulation.1, 2 The use of the principle of virtual work (weak form) is extremely convenient and powerful. Here it has only been justiﬁed intuitively though in the next chapter we shall see its mathematical origins. However, we will also show the determination of these equivalent forces can be done by minimizing the total potential energy. This is applicable to situations where elasticity predominates and the behaviour is reversible. While the virtual work form is always valid, the principle of minimum potential energy is not and care has to be taken. The recognition of the equivalence of the ﬁnite element method to a minimization process was late.2, 3 However, Courant4 in 1943† and Prager and Synge5 in 1947 proposed minimizing methods that are in essence identical. This broader basis of the ﬁnite element method allows it to be extended to other continuum problems where a variational formulation is possible. Indeed, general procedures are now available for a ﬁnite element discretization of any problem deﬁned by a properly constituted set of differential equations. Such generalizations will be discussed in Chapter 3, and throughout the book application to structural and some non-structural problems will be made. It will be found that the process described in this chapter is essentially an application of trial-function and Galerkin-type approximations to the particular case of solid mechanics.

2.2 Direct formulation of finite element characteristics
The ‘prescriptions’ for deriving the characteristics of a ‘ﬁnite element’ of a continuum, which were outlined in general terms, will now be presented in more detailed mathematical form.
† It appears that Courant had anticipated the essence of the ﬁnite element method in general, and of a triangular element in particular, as early as 1923 in a paper entitled ‘On a convergence principle in the calculus of variations.’ K¨ n. Gesellschaft der Wissenschaften zu G¨ ttingen, Nachrichten, Berlin, 1923. He states: ‘We imagine a mesh o o of triangles covering the domain . . . the convergence principles remain valid for each triangular domain.’

Direct formulation of finite element characteristics

21

It is desirable to obtain results in a general form applicable to any situation, but to avoid introducing conceptual difﬁculties the general relations will be illustrated with a very simple example of plane stress analysis of a thin slice. In this a division of the region into triangular-shaped elements may be used as shown in Fig. 2.1. Alternatively, regions may be divided into rectangles or, indeed using a combination of triangles and rectangles. In later chapters we will show how many other shapes also may be used to deﬁne elements.

2.2.1 Displacement function
A typical ﬁnite element, e, with a triangular shape is deﬁned by local nodes 1, 2 and 3, and straight line boundaries between the nodes as shown in Fig. 2.2(a). Similarly, a rectangular element could be deﬁned by local nodes 1, 2, 3 and 4 as shown in Fig. 2.2(b). The choice of displacement functions for each element is of paramount importance and in Chapters 4 and 5 we will show how they may be developed for a wide range of types; however, in the rest of this chapter we will consider only the 3-node triangular and 4-node rectangular element shapes. Let the displacements u at any point within the element be approximated as a column ˆ vector, u: ⎧ ⎫e ⎪ u1 ⎪ ⎨˜ ⎬ ˜ u 2 = N ue ˆ ˜ ˜a u≈u= Na ue = N1 , N2 , . . . (2.1) ⎪.⎪ ⎩.⎭ a .

y

va(Va) 1 t=
tx ty

a

ua(Ua) e 3 2

x

Fig. 2.1 A plane stress region divided into finite elements.

22

A direct physical approach to problems in elasticity: plane stress
y 1 Ni 1 2 x (a) 3-node triangle (b) 4-node rectangle x 3 Ni 1 2 y 4 3 1

Fig. 2.2 Shape function N3 for one element.

In the case of plane stress, for instance, u= u(x, y) v(x, y)

represents horizontal and vertical movements (see Fig. 2.1) of a typical point within the element and ˜ ua ˜ ua = va ˜ the corresponding displacements of a node a. The functions Na , a = 1, 2, . . . are called shape functions (or basis functions, and, occasionally interpolation functions) and must be chosen to give appropriate nodal displacements when coordinates of the corresponding nodes are inserted in Eq. (2.1). Clearly in general we have Na (xa , ya ) = I (identity matrix) while Na (xb , yb ) = 0, a = b If both components of displacement are speciﬁed in an identical manner then we can write Na = Na I (2.2)

and obtain Na from Eq. (2.1) by noting that Na (xa , ya ) = 1 but is zero at other vertices. The shape functions N will be seen later to play a paramount role in ﬁnite element analysis. The most obvious linear function in the case of a triangle will yield the shape of Na of the form shown in Fig. 2.2(a). Writing, the two displacements as u = α1 + α2 x + α3 y v = α4 + α5 x + α6 y (2.3)

Triangle with 3 nodes

we may evaluate the six constants by solving two sets of three simultaneous equations which arise if the nodal coordinates are inserted and the displacements equated to the appropriate nodal values. For example, the u displacement gives ˜ u1 = α1 + α2 x1 + α3 y1 ˜ u2 = α1 + α2 x2 + α3 y2 ˜ u3 = α1 + α2 x3 + α3 y3 (2.4)

Direct formulation of finite element characteristics

23

˜ ˜ ˜ We can easily solve for α1 , α2 and α3 in terms of the nodal displacements u1 , u2 and u3 and obtain ﬁnally u= 1 ˜ ˜ ˜ [(a1 + b1 x + c1 y) u1 + (a2 + b2 x + c2 y) u2 + (a3 + b3 x + c3 y) u3 ] 2 (2.5)

in which a1 = x2 y3 − x3 y2 b1 = y2 − y3 c1 = x3 − x2 (2.6)

with other coefﬁcients obtained by cyclic permutation of the subscripts in the order 1, 2, 3, and where 1 x1 y1 2 = det 1 x2 y2 = 2 · (area of triangle 123) (2.7) 1 x3 y3 From (2.5) we see that the shape functions are given by Na = (aa + ba x + ca y)/(2 ); a = 1, 2, 3 (2.8)

Since displacements with these shape functions vary linearly along any side of a triangle the interpolation (2.5) guarantees continuity between adjacent elements and, with identical nodal displacements imposed, the same displacement will clearly exist along an interface between elements. We note, however, that in general the derivatives will not be continuous between elements.

Rectangle with 4 nodes
An alternative subdivision can use rectangles of the form shown in Fig. 2.3. The rectangular element has side lengths of a and b in the x and y directions, respectively. For the derivation
y y9 4 3

b

x9 1 a 2 x

Fig. 2.3 Rectangular element geometry and local node numbers.

24

A direct physical approach to problems in elasticity: plane stress

of the shape functions it is convenient to use a local cartesian system x , y deﬁned by x = x − x1 y = y − y1 We now need four functions for each displacement component in order to uniquely deﬁne the shape functions. In addition these functions must have linear behaviour along each edge of the element to ensure interelement continuity. A suitable choice is given by u = α 1 + x α 2 + y α3 + x y α 4 v = α5 + x α6 + y α7 + x y α8 The coefﬁcients αa may be obtained by expressing (2.9) at each node, giving for u ˜ u1 ˜ u2 ˜ u3 ˜ u4 = α1 = α1 + a α2 = α1 + a α2 + b α3 + ab α4 = α1 + b α3 (2.10) (2.9)

We can again easily solve for αa in terms of the nodal displacements to obtain ﬁnally u= 1 ˜ ˜ ˜ ˜ [(a − x )(b − y ) u1 + x (b − y ) u2 + x y u3 + (a − x ) y u4 ] ab (2.11)

˜ ˜ An identical expression is obtained for v by replacing ua by va . From (2.11) we obtain the shape functions N1 = (a − x )(b − y )/(ab) N2 = x (b − y )/(ab) N3 = x y /(ab) N4 = (a − x ) y /(ab)

(2.12)

2.2.2 Strains
With displacements known at all points within the element the ‘strains’ at any point can be determined. These will always result in a relationship that can be written in matrix notation as† ε = Su (2.13) where S is a suitable linear differential operator. Using Eq. (2.1), the above equation can be approximated by ε ≈ ε = B˜ e ˆ u (2.14) with B = SN (2.15)
† It is known that strain is a second rank tensor by its transformation properties; however, in this book we will normally represent quantities using matrix (Voigt) notation. The interested reader is encouraged to consult Appendix B for the relations between tensor forms and the matrix quantities.

Direct formulation of finite element characteristics

25

For the plane stress case the relevant strains of interest are those occurring in the plane and are deﬁned in terms of the displacements by well-known relations6 which deﬁne the operator S ⎧ ⎫ ⎡ ⎤ ∂ ⎪ ∂u ⎪ ⎪ ⎪ ⎪ ∂x ⎪ ⎢ ∂x , 0 ⎥ ⎧ ⎫ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎥ ⎨ εx ⎬ ⎨ ∂v ⎬ ⎢ ⎢ ∂ ⎥ u ⎥ ε = εy = = ⎢ 0, ⎩ ⎭ ⎪ ∂y ⎪ ⎢ ∂y ⎥ v ⎪ ⎪ ⎢ ⎥ γxy ⎪ ⎪ ∂u ∂v ⎪ ⎣ ∂ ⎪ ⎪ ⎪ ∂ ⎦ ⎪ ⎪ ⎩ ⎭ + , ∂y ∂x ∂y ∂x With the shape functions N1 , N2 and N3 already determined for a triangular element, the matrix B can easily be obtained using (2.15). If the linear form of the shape functions is adopted then, in fact, the strains are constant throughout the element (i.e., the B matrix is constant). A similar result may be obtained for the rectangular element by adding the results for N4 ; however, in this case the strains are not constant but have linear terms in x and y.

2.2.3 Stresses
In general, the material within the element boundaries may be subjected to initial strains such as those due to temperature changes, shrinkage, crystal growth, and so on. If such strains are denoted by ε0 then the stresses will be caused by the difference between the actual and initial strains. In addition it is convenient to assume that at the outset of the analysis the body is stressed by some known system of initial residual stresses σ 0 which, for instance, could be measured, but the prediction of which is impossible without the full knowledge of the material’s history. These stresses can simply be added on to the general deﬁnition. Thus, assuming linear elastic behaviour, the relationship between stresses and strains will be linear and of the form σ = D(ε − ε0 ) + σ 0 (2.16) where D is an elasticity matrix containing the appropriate material properties. Again for the particular case of plane stress three components of stress corresponding to the strains already deﬁned have to be considered. These are, in familiar notation, ⎧ ⎫ ⎨ σx ⎬ σ = σy ⎩ ⎭ τxy and for an isotropic material the D matrix may be simply obtained from the usual stress– strain relationship6 εx − εx0 = εy − εy0 γxy − γxy0 1 ν (σx − σx0 ) − (σy − σy0 ) E E ν 1 = − (σx − σx0 ) + (σy − σy0 ) E E 2(1 + ν) = (τxy − τxy0 ) E

26

A direct physical approach to problems in elasticity: plane stress

i.e., on solving,

1 E ⎣ ν D= 1 − ν2 0

⎡

ν 1 0

⎤ 0 ⎦ 0 (1 − ν)/2

2.2.4 Equivalent nodal forces
Let ⎧ e⎫ ⎪ q1 ⎪ ⎨ e⎬ e q = q2 ⎪.⎪ ⎩.⎭ .

deﬁne the nodal forces which are statically equivalent to the boundary stresses and dise tributed body forces acting on the element. Each of the forces qa must contain the same ˜ number of components as the corresponding nodal displacement ua and be ordered in the appropriate, corresponding directions. The distributed body forces b are deﬁned as those acting on a unit volume of material within the element with directions corresponding to those of the displacements u at that point. In the particular case of plane stress the nodal forces are, for instance,
e qa = e Ua e Va

with components U and V corresponding to the directions of u and v, respectively (viz. Fig. 2.1), and the distributed body forces are b= bx by

in which bx and by are the ‘body force’ components per unit of volume. In the absence of body forces equivalent nodal forces for the 3-node triangular element can be computed directly from equilibrium considerations. In Fig. 2.4(a) we show a triangular element together with the geometric properties which are obtained by the linear interpolation of the displacements using (2.1) to (2.8). In particular we note from the ﬁgure [and (2.6)] that b1 + b2 + b3 = 0 and c1 + c2 + c3 = 0 The stresses in the element are given by (2.16) in which we assume that ε0 and σ 0 are constant in each element and strains are computed from (2.14) and, for the 3-node triangular element, are also constant in each element. To determine the nodal forces resulting from the stresses, the boundary tractions are ﬁrst computed from ⎧ ⎫ ⎨ σx ⎬ t n 0 ny σ t= x =t x (2.17) ty 0 n y nx ⎩ y ⎭ τxy where t is a constant thickness of the plane strain slice and nx , ny are the direction cosines of the outward normal to the element boundary. For the triangular element the tractions

Direct formulation of finite element characteristics
c2 3 3 b1 b2 2 sx sx 2 c1 sy txy

27

b3 1 c3 (a) Triangle and geometry txy

1

sy (b) Uniform stress state

Fig. 2.4 3-node triangle, geometry and constant stress state.

are constant. The resultant for each side of the triangle is the product of the triangle side length (la ) times the traction. Here la is the length of the side opposite the triangle node a and we note from Fig. 2.4(a) that la nx = − ba and la ny = − ca Therefore, la t = la tx la ty =t −ba 0 0 −ca −ca −ba ⎧ ⎫ ⎨ σx ⎬ σy ⎩ ⎭ τxy (2.18)

The resultant acts at the middle of each side of the triangle and, thus, by sum of forces and moments is equivalent to placing half at each end node. Thus, by static equivalence the nodal forces at node 1 are given by q1 = = t 2 −b2 0 t b1 2 0 0 −c2 0 c1 −b3 −c2 + −b2 0 t 0 −c3 −c3 −b3 σ (2.19a)

c1 σ = BT σ 1 b1

Similarly, the forces at nodes 2 and 3 are given by q2 = B2 σ q3 = B3 σ t t (2.19b)

Combining with the expression for stress and strain for each element we obtain q = BT D B˜ e − ε0 + σ 0 u e e ˜ = K u + fe t (2.20a)

28

A direct physical approach to problems in elasticity: plane stress

where

K e = BT D B

t and f e = BT (σ 0 − D ε0 )

t

(2.20b)

The above gives a result which is now in the form of the standard discrete problem deﬁned in Sec. 1.2. However, when body forces are present or we consider other element forms the above procedure fails and we need a more general approach. To make the nodal forces statically equivalent to the actual boundary stresses and distributed body forces, the simplest general procedure is to impose an arbitrary (virtual) nodal displacement and to equate the external and internal work done by the various forces and stresses during that displacement. ˜ Let such a virtual displacement be δ ue at the nodes. This results, by Eqs (2.1) and (2.14), in virtual displacements and strains within the element equal to ˜ ˜ δu = N δ ue and δε = B δ ue (2.21)

respectively. The external work done by the nodal forces is equal to the sum of the products of the individual force components and corresponding displacements, i.e., in matrix form ˜ ˜2 e ˜1 e δ ueT q1 + δ ueT q2 . . . = δ ueT qe (2.22)

Similarly, the internal work per unit volume done by the stresses and distributed body forces subjected to a set of virtual strains and displacements is δεT σ − δuT b or, after using (2.21),† ˜ δ ueT BT σ − NT b (2.23) (2.24)

Equating the external work with the total internal work obtained by integrating (2.24) over the volume of the element, e , we have ˜ ˜ δ ueT qe = δ ueT
e

BT σ d

−
e

NT b d

(2.25)

As this relation is valid for any value of the virtual displacement, the multipliers must be equal. Thus qe =
e

BT σ d

−
e

NT b d

(2.26)

This statement is valid quite generally for any stress–strain relation. With (2.14) and the linear law of Eq. (2.16) we can write Eq. (2.26) as ˜ q e = K e ue + f e where Ke =
e

(2.27)

BT D B d BT D ε0 d
e

(2.28a) +
e

and fe = −
e

NT b d

−

BT σ 0 d

(2.28b)

† Note that by the rules of matrix algebra for the transpose of products (A B)T = BT AT .

Direct formulation of finite element characteristics

29

For the plane stress problem (·) d
e

=

Ae

(·) t dA

where Ae is the area of the element. Here t now can be allowed to vary over the element. In the last equation the three terms represent forces due to body forces, initial strain, and initial stress respectively. The relations have the characteristics of the discrete structural elements described in Chapter 1. If the initial stress system is self-equilibrating, as must be the case with normal residual stresses, then the forces given by the initial stress term of Eq. (2.28b) are identically zero after assembly. Thus frequent evaluation of this force component is omitted. However, if for instance a machine part is manufactured out of a block in which residual stresses are present or if an excavation is made in rock where known tectonic stresses exist a removal of material will cause a force imbalance which results from the above term. For the particular example of the plane stress triangular element these characteristics will be obtained by appropriate substitution. It has already been noted that the B matrix in that example was not dependent on the coordinates; hence the integration will become particularly simple and, in the absence of body forces, K e and f e are identical to those given in (2.20b). The interconnection and solution of the whole assembly of elements follows the simple structural procedures outlined in Chapter 1. This gives r=
e

qe = 0

(2.29)

A note should be added here concerning elements near the boundary. If, at the boundary, displacements are speciﬁed, no special problem arises as these can be satisﬁed by specifying ˜ some of the nodal parameters u. Consider, however, the boundary as subject to a distributed ¯ external loading, say t per unit area (traction). A loading term on the nodes of the element which has a boundary face e will now have to be added. By the virtual work consideration, this will simply result in fe → fe −
e

¯ NT t d

(2.30)

¯ with integration taken over the boundary area of the element. It will be noted that t must have the same number of components as u for the above expression to be valid. Such a boundary element is shown again for the special case of plane stress in Fig. 2.1. Once the nodal displacements have been determined by solution of the overall ‘structural’type equations, the stresses at any point of the element can be found from the relations in Eqs (2.14) and (2.16), giving σ = D B˜ e − ε0 + σ 0 u (2.31)

Example 2.1: Stiffness matrix for 3-node triangle. The stiffness matrix for an individual element is computed by evaluating Eq. (2.28a). For a 3-node triangle in which the moduli and thickness are constant over the element the solution for the stiffness becomes K e = BT D B t (2.32)

30

A direct physical approach to problems in elasticity: plane stress

where is the area of the triangle computed from (2.7). Evaluating (2.15) using the shape functions in (2.8) gives ⎤ ⎡ ba 0 1 ⎣ 0 ca ⎦ (2.33) Ba = 2 ca ba Thus, the expression for the stiffness of the triangular element is given by ⎤⎡ ⎤ ⎡ bb 0 D D12 D13 t ba 0 ca ⎣ 11 D21 D22 D23 ⎦ ⎣ 0 cb ⎦ Kab = 0 c a ba 4 D D D c b
31 32 33 b b

(2.34)

where Dij = Dj i are the elastic moduli. Example 2.2: Nodal forces for boundary traction. Let us consider a problem in which a traction boundary condition is to be imposed along a vertical surface located at x = xb . A triangular element has one of its edges located along the boundary as shown in Fig. 2.5 and is loaded by a speciﬁed traction given by ¯ t= tx ty =t σx τxy

The normal stress σx is given by a linearly varying stress in the y direction and the shearing stress τxy is assumed zero, thus, to compute nodal forces we use the expressions σx = kx y and τxy = 0

in which kx is a speciﬁed constant. Along the boundary the shape functions for either a triangular element or a rectangular element are linear functions in y and are given by N1 = (y2 − y)/(y2 − y1 ) and N2 = (y − y1 )/(y2 − y1 )

(xb,y2)

(tx,ty)

(xb,y1)

Γ

Fig. 2.5 Traction on vertical face.

Generalization to the whole region – internal nodal force concept abandoned

31

thus, the nodal forces for the element shown are computed from Eq. (2.30) and given by f1 = − and f2 = −
y2 y1 y2 y1

t N1

σx τxy σx τxy

dy = −

kx t (2y1 + y2 )(y2 − y1 )/6 0 kx t (y1 + 2y2 )(y2 − y1 )/6 0

tN2

dy = −

2.3 Generalization to the whole region – internal nodal force concept abandoned
In the preceding section the virtual work principle was applied to a single element and the concept of equivalent nodal force was retained. The assembly principle thus followed the conventional, direct equilibrium, approach. The idea of nodal forces contributed by elements replacing the continuous interaction of stresses between elements presents a conceptual difﬁculty. However, it has a considerable appeal to ‘practical’ engineers and does at times allow an interpretation which otherwise would not be obvious to the more rigorous mathematician. There is, however, no need to consider each element individually and the reasoning of the previous section may be applied directly to the whole continuum. Equation (2.1) can be interpreted as applying to the whole structure, that is, ¯ ˜ ¯ ˜ u = N u and δu = N δ u ˜ ˜ in which u and δ u list all the nodal points and ¯ Na =
e e Na

(2.35)

(2.36)

when the point concerned is within a particular element e and a is a node point associated with the element. If a point does not occur within the element (see Fig. 2.6) ¯ Na = 0 (2.37)

¯ A matrix B can be similarly deﬁned and we shall drop the bar, considering simply that the shape functions, etc., are always deﬁned over the whole domain, . ˜ For any virtual displacement δ u we can now write the sum of internal and external work for the whole region as ˜ δ uT r = δεT σ d − δuT b d − ¯ δuT t d = 0 (2.38)

˜ In the above equation, δ u, δu and δε can be completely arbitrary, providing they stem from a continuous displacement assumption. If for convenience we assume they are simply variations linked by relations (2.35) and (2.14) we obtain, on substitution of the constitutive relation (2.16), a system of algebraic equations ˜ Ku+f = 0 (2.39)

32

A direct physical approach to problems in elasticity: plane stress
Na y

a

x

¯ Fig. 2.6 Shape function N a for whole domain.

where K= and f =− NT b d − ¯ NT t d + BT (σ 0 − D ε0 ) d (2.40b) on BT D B d (2.40a)

The integrals are taken over the whole domain which tractions are given. It is immediately obvious from the above that Kab =
e

and over the whole surface area

e Kab and fa =

e

e fa

(2.41)

by virtue of the property of deﬁnite integrals requiring that the total be the sum of the parts: (·)d =
e
e

(·)d

and

(·)d =
e
e

(·)d

(2.42)

The same is obviously true for the surface integrals in Eq. (2.40b). We thus see that the ‘secret’ of the approximation possessing the required behaviour of a ‘standard discrete system’ of Chapter 1 lies simply in the requirement of writing the relationships in integral form. The assembly rule as well as the whole derivation has been achieved without involving the concept of ‘interelement forces’ (i.e., qe ). In the remainder of this book the element superscript will be dropped unless speciﬁcally needed. Also no differentiation between element and system shape functions will be made. However, an important point arises immediately. In considering the virtual work for the whole system [Eq. (2.38)] and equating this to the sum of the element contributions it is implicitly assumed that no discontinuity in displacement between adjacent elements develops. If such a discontinuity developed, a contribution equal to the work done by the stresses in the separations would have to be added.

Generalization to the whole region – internal nodal force concept abandoned
∆ Smoothing zone

33

u

du dx

d2u dx2

−

Fig. 2.7 Differentiation of function with sloped discontinuity (C0 continuous).

Put in other words, we require that the terms integrated in Eq. (2.42) be ﬁnite. These terms arise from the shape functions Na used in deﬁning the displacement u [by Eq. (2.35)] and its derivatives associated with the deﬁnition of strain [viz. Eq. (2.14)]. If, for instance, the ‘strains’ are deﬁned by ﬁrst derivatives of the functions N, the displacements must be continuous. In Fig. 2.7 we see how ﬁrst derivatives of continuous functions may involve a ‘jump’ but are still ﬁnite, while second derivatives may become inﬁnite. Such functions we call C0 continuous. In some problems the ‘strain’ in a generalized sense may be deﬁned by second derivatives. In such cases we shall obviously require that both the function N and its slope (ﬁrst derivative) be continuous. Such functions are more difﬁcult to derive but are used in the analysis of thin plate and shell problems (e.g., see volume on solid mechanics7 ). The continuity involved now is called C1 .

34

A direct physical approach to problems in elasticity: plane stress

2.4 Displacement approach as a minimization of total potential energy
The principle of virtual displacements used in the previous sections ensured satisfaction of equilibrium conditions within the limits prescribed by the assumed displacement pattern. Only if the virtual work equality for all, arbitrary, variations of displacement was ensured would the equilibrium be complete. ˜ As the number of parameters of u which prescribes the displacement increases without limit then ever closer approximation of all equilibrium conditions can be ensured. The virtual work principle as written in Eq. (2.38) can be restated in a different form if ˜ the virtual quantities δ u, δu, and δε are considered as variations of the real quantities.8, 9 Thus, for instance, we can write the ﬁrst term of Eq. (2.38), for elastic materials, as δU = δεT σ d (2.43)

where U is the strain energy of the system. For the linear elastic material described by Eq. (2.16) the strain energy is given by U= 1 2 εT D ε d + εT (σ 0 − D ε0 ) d (2.44)

and will, after variation, yield the correct expression providing D is a symmetric matrix (this is a necessary condition for a single-valued U to exist).8, 9 The last two terms of Eq. (2.38) can be written as δW = −δ uT b d + ¯ uT t d (2.45)

where W is the potential energy of the external loads. The above is certainly true if b and ¯ t are conservative (or independent of displacement) where we obtain simply W =− uT b d − ¯ uT t d , as (2.47) (2.46)

Thus, instead of Eq. (2.38), we can write the total potential energy, =U +W in which U is given by (2.44) and W by (2.46) and require δ = δ(U + W ) = 0

(2.48)

In this form is known as a functional and (2.48) is a requirement which renders the functional stationary. The above statement means that for equilibrium to be ensured the total potential energy must be stationary for variations of the admissible displacements. The ﬁnite element equations for the total potential energy are obtained by substituting the approximation for displacements [viz. Eq. (2.35)] into Eqs (2.44) and (2.46) giving = 1 T ˜ ˜ ˜ u K u + uT f 2 (2.49)

Displacement approach as a minimization of total potential energy

35

in which K (where K = K T ) and f are given by Eqs (2.40a) to (2.41). The variation with ˜ respect to displacements with the ﬁnite number of parameters u is now written as ⎧∂ ⎫ ⎪ ⎪ ⎪ ⎪ ∂u ⎪ ⎪ ⎪ ˜1 ⎪ ⎪ ⎪ ⎬ ⎨ ∂ ∂ ˜ = Ku+f = 0 (2.50) = ⎪ ∂ u2 ⎪ ˜ ∂u ⎪ ˜ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ . ⎪ ⎩ . ⎭ . It can also be shown that in stable elastic situations the total potential energy is not only stationary but is a minimum.8 Thus the ﬁnite element process seeks such a minimum within the constraint of an assumed displacement pattern. The greater the number of degrees of freedom, the more closely the solution will approximate the true one, ensuring complete equilibrium, providing the true displacement can, in the limit, be represented. The necessary convergence conditions for the ﬁnite element process could thus be derived. Discussion of these will, however, be deferred to subsequent sections. It is of interest to note that if true equilibrium requires an absolute minimum of the total potential energy, , a ﬁnite element solution by the displacement approach will always provide an approximate greater than the correct one. Thus a bound on the value of the total potential energy is always achieved. If the functional could be speciﬁed, a priori, then the ﬁnite element equations could be derived directly by the differentiation speciﬁed by Eq. (2.50). The well-known Rayleigh10 –Ritz11 process of approximation frequently used in elastic analysis is based precisely on this approach. The total potential energy expression is formulated and the displacement pattern is assumed to vary with a ﬁnite set of undetermined parameters. A set of simultaneous equations minimizing the total potential energy with respect to these parameters is set up. Thus the ﬁnite element process as described so far can be considered to be the Rayleigh–Ritz procedure. The difference is only in the manner in which the assumed displacements are prescribed. In the traditionally used Ritz process the functions are usually given by expressions valid throughout the whole region, thus leading to simultaneous equations in which the coefﬁcient matrix is full. In the ﬁnite element process this speciﬁcation is usually piecewise, each nodal parameter inﬂuencing only adjacent elements, and thus a sparse and usually banded matrix of coefﬁcients is found. By its nature the conventional Ritz process is limited to relatively simple geometrical shapes of the total region while this limitation only occurs in ﬁnite element analysis in the element itself. Thus complex, realistic, conﬁgurations can be assembled from relatively simple element shapes. ˜ A further difference is in the usual association of the undetermined parameter ua with a particular nodal displacement. This allows a simple physical interpretation invaluable to an engineer. Doubtless much of the early popularity of the ﬁnite element process is due to this fact.

2.4.1 Bound on strain energy in a displacement formulation
While the approximation obtained by the ﬁnite element displacement approach always overestimates the true value of the total potential energy (the absolute minimum corresponding

36

A direct physical approach to problems in elasticity: plane stress

to the exact solution), this is not directly useful in practice. It is, however, possible to obtain a more useful limit in special cases. Consider the problem in which no initial strains ε0 or initial stresses σ 0 exist. Now by the principle of energy conservation the strain energy will be equal to the work done by the external loads which increase uniformly from zero.12 This work done is equal to −W/2 where W is the potential energy of the loads. Thus, 1 U+ W =0 2 or = U + W = −U (2.52) whether an exact or approximate displacement ﬁeld is assumed. If only one external concentrated load Ra is present, the strain energy bound immediately informs us that the ﬁnite element deﬂection under this load has been underestimated (as U = −W/2 = −Ra ua /2, where ua is the deﬂection at the load point). In more complex loading cases the usefulness of this bound is limited as neither local displacements nor local stresses, i.e., the quantities of real engineering interest, can be bounded. It is also important to remember that this bound on strain energy is only valid in the absence of any initial stresses or strains. The expression for U in this case can be obtained from Eq. (2.44) as U= which becomes by Eq. (2.14) simply U= 1 T ˜ u 2 ˜ BT D B d u = 1 T ˜ ˜ u Ku 2 (2.54) 1 2 εT D ε d (2.53) (2.51)

a quadratic matrix form in which K is the stiffness matrix previously discussed. When sufﬁcient supports are provided to prevent rigid body motion and only linear elastic materials are considered, the above energy expression is always positive from physical considerations. It follows therefore that the matrix K occurring in all the ﬁnite element assemblies is not only symmetric but is positive deﬁnite (a property deﬁned in fact by the requirement that the quadratic form should always be greater than zero). This feature is of importance when the numerical solution of the simultaneous equations is considered, as simpliﬁcations arise in the case of symmetric positive deﬁnite equations.13

2.4.2 Direct minimization
The fact that the ﬁnite element approximation reduces to the problem of minimizing the total potential energy deﬁned in terms of a ﬁnite number of nodal parameters led us to the formulation of the simultaneous set of equations given symbolically by Eq. (2.50). This is the most usual and convenient approach, especially in linear solutions, but other search procedures, now well developed in the ﬁeld of optimization, could be used to estimate the lowest value of . In this text we shall continue with the simultaneous equation process but the interested reader could well bear the alternative possibilities in mind.14, 15

Convergence criteria

37

2.5 Convergence criteria
The assumed shape functions limit the inﬁnite degrees of freedom of the real system, and the true minimum of the energy may never be reached, irrespective of the ﬁneness of subdivision. To ensure convergence to the correct result certain simple requirements must be satisﬁed. Obviously, for instance, the displacement function should be able to represent the true displacement distribution as closely as desired. It will be found that this is not so if the chosen functions are such that straining is possible when the element is subjected to rigid body displacements at the nodes. Thus, the ﬁrst criterion that the displacement function must obey is: Criterion 1. The displacement shape functions chosen should be such that they do not permit straining of an element to occur when the nodal displacements are caused by a rigid body motion. This self-evident condition can be violated easily if certain types of function are used; care must therefore be taken in the choice of displacement functions. A second criterion stems from similar requirements. Clearly, as elements get smaller nearly constant strain conditions will prevail in them. If, in fact, constant strain conditions exist, it is most desirable for good accuracy that a ﬁnite size element is able to reproduce these exactly. It is possible to formulate functions that satisfy the ﬁrst criterion but at the same time require a strain variation throughout the element when the nodal displacements are compatible with a constant strain solution. Such functions will, in general, not show good convergence to an accurate solution and cannot, even in the limit, represent the true strain distribution. The second criterion can therefore be formulated as follows: Criterion 2. The displacement shape functions have to be of such a form that if nodal displacements are compatible with a constant strain condition such constant strain will in fact be obtained. It will be observed that Criterion 2 in fact incorporates the requirement of Criterion 1, as rigid body displacements are a particular case of constant strain – with a value of zero. This criterion was ﬁrst stated by Bazeley et al.16 in 1966. Strictly, both criteria need only be satisﬁed in the limit as the size of the element tends to zero. However, the imposition of these criteria on elements of ﬁnite size leads to improved accuracy, although in certain situations (such as in axisymmetric analysis) the imposition of the second one is not possible or essential. Lastly, as already mentioned in Sec. 2.3, it is implicitly assumed in this derivation that no contribution to the virtual work arises at element interfaces. It therefore appears necessary that the following criterion be included: Criterion 3. The displacement shape functions should be chosen such that the strains at the interface between elements are ﬁnite (even though they may be discontinuous). This criterion implies a certain continuity of displacements between elements. In the case of strains being deﬁned by ﬁrst derivatives, as in the plane stress example quoted here, the displacements only have to be continuous (C0 continuity). If, however, the ‘strains’ are deﬁned by second derivatives, ﬁrst derivatives of these have also to be continuous (C1 continuity).2

38

A direct physical approach to problems in elasticity: plane stress

The above criteria are included mathematically in a statement of ‘functional completeness’ and the reader is referred elsewhere for full mathematical discussion.17–22 The ‘heuristic’ proof of the convergence requirements given here is sufﬁcient for practical purposes and we shall generalize all of the above criteria in Sec. 3.6 and more fully in Chapter 9. Indeed in the latter we shall show a universal test which justiﬁes convergence even if some of the above criteria are violated.

2.6 Discretization error and convergence rate
In the foregoing sections we have assumed that the approximation to the displacement as represented by Eq. (2.1) will yield the exact solution in the limit as the size h of elements decreases. The arguments for this are simple: if the expansion is capable, in the limit, of exactly reproducing any displacement form conceivable in the continuum, then as the solution of each approximation is unique it must approach, in the limit of h → 0, the unique exact solution. In some cases the exact solution is indeed obtained with a ﬁnite number of subdivisions (or even with one element only) if the polynomial expansion used in that element ﬁts the exact solution. Thus, for instance, if the exact solution is of the form of a quadratic polynomial and the shape functions include all the polynomials of that order, the approximation will yield the exact answer. The last argument helps in determining the order of convergence of the ﬁnite element procedure as the exact solution can always be expanded in a Taylor series in the vicinity of any point (or node) a as a polynomial: u = ua + ∂u ∂x
a

(x − xa ) +

∂u ∂y

a

(y − ya ) + · · ·

(2.55)

If within an element of ‘size’ h a polynomial expansion complete to degree p is employed, this can ﬁt locally the Taylor expansion up to that degree and, as x − xa and y − ya are of the order of magnitude h, the error in u will be of the order O(hp+1 ). Thus, for instance, in the case of the plane elasticity problem discussed, we used a complete linear expansion and p = 1. We should therefore expect a convergence rate of order O(h2 ), i.e., the error in displacement being reduced to 1/4 for a halving of the mesh spacing. By a similar argument the strains (or stresses) which are given by the mth derivatives of displacement should converge with an error of O(hp+1−m ), i.e., as O(h) in the plane stress example, where m = 1. The strain energy, being given by the square of the stresses, will show an error of O(h2(p+1−m) ) or O(h2 ) in the plane stress example. The arguments given here are perhaps ‘heuristic’ from a mathematical viewpoint – they are, however, true21, 22 and correctly give the orders of convergence, which can be expected to be achieved asymptotically as the element size tends to zero and if the exact solution does not contain singularities. Such singularities may result in inﬁnite values of the coefﬁcients in terms omitted in the Taylor expansion of Eq. (2.55) and invalidate the arguments. However, in many well-behaved problems the mere determination of the order of convergence often sufﬁces to extrapolate the solution to the correct result. Thus, for instance, if the displacement converges at O(h2 ) and we have two approximate solutions u1 and u2 obtained with meshes of size h and h/2, we can write, with u being the exact solution, u1 − u O(h2 ) ≈4 = 2−u O(h/2)2 u (2.56)

Non-conforming elements and the patch test

39

From the above an (almost) exact solution u can be predicted. This type of extrapolation was ﬁrst introduced by Richardson23 and is of use if convergence is monotonic and nearly asymptotic. We shall return to the important question of estimating errors due to the discretization process in Chapter 13 and will show that much more precise methods than those arising from convergence rate considerations are possible today. Indeed automatic mesh reﬁnement processes can be introduced so that the speciﬁed accuracy can be achieved (viz. Chapters 8 and 14). Discretization error is not the only error possible in a ﬁnite element computation. In addition to obvious mistakes which can occur when introducing data into computers, errors due to round-off are always possible. With the computer operating on numbers rounded off to a ﬁnite number of digits, a reduction of accuracy occurs every time differences between ‘like’ numbers are being formed. In the process of equation solving many subtractions are necessary and accuracy decreases. Problems of matrix conditioning, etc., enter here and the user of the ﬁnite element method must at all times be aware of accuracy limitations which simply do not allow the exact solution ever to be obtained. Fortunately in many computations, by using modern machines which carry a large number of signiﬁcant digits, these errors are often small. Another error that is often encountered occurs in approximation of curved boundaries by polynomials on faces of elements. For example, use of linear triangles to approximate a circular boundary causes an error of O(h2 ) to be introduced.

2.7 Displacement functions with discontinuity between elements – non-conforming elements and the patch test
In some cases considerable difﬁculty is experienced in ﬁnding displacement functions for an element which will automatically be continuous along the whole interface between adjacent elements. As already pointed out, the discontinuity of displacement will cause inﬁnite strains at the interfaces, a factor ignored in this formulation because the energy contribution is limited to the elements themselves. However, if, in the limit, as the size of the subdivision decreases continuity is restored, then the formulation already obtained will still tend to the correct answer. This condition is always reached if (a) constant strain condition automatically ensures displacement continuity, and (b) the constant strain criteria of the previous section are satisﬁed. To test that such continuity is achieved for any mesh conﬁguration when using such non-conforming elements it is necessary to impose, on an arbitrary patch of elements, nodal displacements corresponding to any state of constant strain. If nodal equilibrium is simultaneously achieved without the imposition of external, nodal, forces and if a state of constant stress is obtained, then clearly no external work has been lost through interelement discontinuity. Elements which pass such a patch test will converge, and indeed at times non-conforming elements will show a superior performance to conforming elements.

40

A direct physical approach to problems in elasticity: plane stress

The patch test was ﬁrst introduced by Irons16 and has since been demonstrated to give a sufﬁcient condition for convergence.22, 24–28 The concept of the patch test can be generalized to give information on the rate of convergence which can be expected from a given element. We shall return to this problem in detail in Chapter 9 where the test will be fully discussed.

2.8 Finite element solution process
The ﬁnite element solution of a problem follows a standard methodology. The steps in any solution process are always performed by the following steps: 1. Deﬁne the problem to be solved in terms of differential equations. Construct the integral form for the problem as a virtual work, variational or weak formulation. 2. Select the type and order of ﬁnite elements to be used in the analysis. 3. Deﬁne the mesh for the problem. This involves the description of the node and element layout, as well as the speciﬁcation of boundary conditions and parameters for the formulation used. The process for mesh generation will be described in more detail in Chapter 8. 4. Compute and assemble the element arrays. The particular virtual work, variational or weak form provide the basis for computing speciﬁc relationships of each element. 5. Solve the resulting set of linear algebraic equations for the unknown parameters. See Appendix C for a brief discussion on solution of linear algebraic equations. 6. Output the results for the nodal and element variables. Graphical outputs also are useful for this step. An accurate procedure to project element values to nodes is described in Chapter 6. Much of the discussion in the following chapters is concerned with the development of the theory needed to compute element arrays. For a steady-state problem the two arrays are a coefﬁcient array K, which we refer to as a ‘stiffness’ matrix, and a force array f . In the next section, however, we ﬁrst illustrate the solution steps for two problems for which the exact solution is available.

2.9 Numerical examples
Let us now consider the solution to a set of problems for which an exact solution is known. This will enable us to see how the ﬁnite element results compare to the known solution and also to demonstrate the convergence properties for different element types. Of course, the power of the ﬁnite element method is primarily for use on problems for which no alternative solution is possible using results from classical books on elasticity and in later chapters we will include results for several such example problems.

2.9.1 Problems for accuracy assessment
Example 2.3: Beam subjected to end shear. We consider a rectangular beam in a state of plane stress. The geometric properties are shown in Fig. 2.8(a). The solution to the problem is given in Timoshenko and Goodier based on use of a stress function solution.6 The solution for stresses is given by

Numerical examples
y

41

c P c x

L (a) (b)

Fig. 2.8 End loaded beam: (a) Problem geometry and (b) coarse mesh.

3 P xy 2 c3 σy = 0 3P y τxy = − 1− 4c c σx = −

2

where P is the applied load and c the half-depth of the beam. For the displacement boundary conditions u(L, 0) = v(L, 0) = 0 and u(L, c) = u(L, −c) = 0 As shown in Fig. 2.8(a), the solution for displacements is given by u=− v= P (x 2 − L2 )y νP y(y 2 − c2 ) P y(y 2 − c2 ) − + 2EI 6EI 6GI P L2 νP c2 P c2 + + 2EI 6EI 3GI (x − L)

νP xy 2 P (x 3 − L3 ) + − 2EI 6EI

In the above E and ν are the elastic modulus and Poisson ratio, G is the shear modulus given by E/[2(1 + ν)] and I is the area moment of inertia which is equal to 2tc3 /3 where t is a constant beam thickness. For this solution the tractions on the boundaries become tx ty tx ty =t =t 0 −τxy σx τxy for x = 0 ; − c ≤ y ≤ c for x = L ; − c ≤ y ≤ c

For the numerical solution we choose the properties c = 10; L = 100; t = 1; P = 80; E = 1000 and ν = 0.25 In order to perform a ﬁnite element solution to the problem we need to compute the nodal forces for the tractions using Eq. 2.30. When many elements are used in an analysis this

42

A direct physical approach to problems in elasticity: plane stress
100 Triangles Rectangles 10-1 Energy error

10-2

10-3

10-4 10-1 h/h1 100

Fig. 2.9 Convergence in energy error for 3-node triangles and 4-node rectangular elements.

step can be quite tedious and it is best to write a small computer program to carry out the integrations (e.g., using MATLAB29 or any other programming language).† The solution to the problem is carried out using a uniform mesh of (a) 3-node triangular elements and (b) 4-node rectangular elements and the results for the error in energy given by |Eex − Ef e | ηE = ≈ C h2 Eex is plotted versus the log in element size h in Fig. 2.9. Here Eex is the energy of the exact solution and Ef e that of the ﬁnite element solution. Results for the energy are given in Table 2.1 and the exact value for the geometry and properties selected is 3296 (energy here is work done which is twice the stored elastic strain energy). The element size is normalized to that of the coarsest mesh [h1 shown in Fig. 2.8(b)] and the energy error is computed using the exact value. The expected slope of 2 is achieved for both element types with the 4-node element giving a smaller constant C due to the presence of the xy term in each shape function. The stresses in each triangle are constant. The values for σx , σy and τxy obtained in the elements at the right end of the beam (where σx is largest) are shown in Fig. 2.10(a). The distribution of σx for x = 90 is shown in Fig. 2.10(b) where we also include values computed by a nodal averaging method. In Chapter 6 we will show how more accurate stresses may be obtained at nodes. Example 2.4: Circular beam subjected to end shear. We consider a circular beam in a state of plane stress. The geometric properties are shown in Fig. 2.11. The solution to the problem is given in Timoshenko and Goodier based on use of a stress function.6 The geometry and loading for the problem are shown in Fig. 2.11. The solution for stresses is
† For the triangular elements discussed in this chapter, the program FEAPpv available as a companion to this book includes automatic computation of nodal forces for this type of loading.30

Numerical examples
Table 2.1 Mesh size and energy for end loaded beam (a) 3-node triangles Nodes 55 189 697 2673 10 465 41 409 Exact Elmts 80 320 1280 5120 20 480 81 920 – Energy 2438.020814633 3027.225730752 3223.959303515 3277.628191064 3291.381304522 3294.843527071 3296.000000000 (b) 4-node rectangles Elmts 40 160 640 2560 10 240 40 960 – Energy 2984.863896144 3212.088124234 3274.561666674 3290.607667261 3294.649630776 3295.662249951 3296.000000000

43

(-78.28, 5.96, 11.91) (-47.92, -6.83, -10.86) (-44.55, 6.66, -24.62) (-1.64, -6.56, 7.56) (1.64, 6.56, 7.56) (44.55, -6.66, (47.92, 6.83, (78.28, -5.96, 11.91) -24.62) -10.86)

(a)

(b)

sx = 108

Fig. 2.10 End loaded beam: (a) Element stresses (σ x, σ y, τ xy) and (b) σ x stress distribution for x = 90, element values and 2 nodal average values.

b r
θ

a P
(a) (b)

Fig. 2.11 End loaded circular beam: (a) Problem geometry and (b) coarse mesh.

44

A direct physical approach to problems in elasticity: plane stress

given by σrr = σθθ = τrθ = − P N r+ a 2 b2 a 2 + b2 − 3 r r sin θ sin θ cos θ

a 2 + b2 a 2 b2 P 3r − 3 − r N r P N r+ a 2 + b2 a 2 b2 − r3 r

where N = a 2 −b2 +(a 2 +b2 ) log b/a. For the restraints shown in Fig. 2.11(a) the solution for displacements is given by ur = P NE a 2 b2 (1 + ν) 1 − (a 2 + b2 )(1 − ν) log r sin θ (1 − 3ν)r 2 − 2r 2 2 − K sin θ

+(a 2 + b2 )(θ − π) cos θ uθ = P NE

a 2 b2 (1 + ν) 1 + (a 2 + b2 )[(1 − ν) log r − (1 + ν)] cos θ (5 + ν)r 2 − 2 2r 2 − K cos θ

−(a 2 + b2 )(θ − π) sin θ

where for ur (a, π/2) = 0 we obtain K= P b2 (1 + ν) 1 − (a 2 + b2 )(1 − ν) log a (1 − 3ν)a 2 − 2 NE 2

In the above E and ν are the elastic modulus and Poisson ratio; a and b are the inner and outer radii, respectively (see Fig. 2.11). For this solution the displacement ur for θ = 0 is constant and given by ur (r, 0) = − πP 2 (a + b2 ) = u0 EN

Thus, instead of computing the nodal forces for the traction on this boundary we merely set all the nodal displacements in the x direction to a constant value. For the numerical solution we choose the properties a = 5; b = 10; t = 1; u0 = −0.01; E = 10 000 and ν = 0.25 In addition the displacements on the boundaries are prescribed as u(x, 0) = u0 and u(0, y) = v(0, a) = 0 The ﬁnite element solution to the problem is carried out using a uniform mesh of 3-node triangular elements oriented as shown in Fig. 2.11(b). Results for the energy are given in Table 2.2 and the ‘exact’ value is computed from Eex = 1 log 2 − 0.6 = 0.02964966844238 π

Numerical examples

45

for the geometry and properties selected. The element size is normalized to that of the coarsest mesh [shown in Fig. 2.11(b)] and the energy error given in Table 2.2 again has the expected slope of 2. Finally, in Fig. 2.13 we compare the ur and uθ displacements from the ﬁnite element solution of the coarsest mesh to the exact values. We observe that even with this coarse distribution of elements the solution is quite good. Unfortunately, the stress distribution is not as accurate and quite ﬁne meshes are needed to obtain good values. In Chapter 6 we will show how use of higher order elements can signiﬁcantly improve both the displacements and stresses obtained.

2.9.2 A practical application
Obviously, the practical applications of the ﬁnite element method are limitless, and it has superseded experimental technique for plane problems because of its high accuracy, low cost, and versatility. The ease of treatment of general boundary shapes and conditions, material anisotropy, thermal stresses, or body force problems add to its practical advantages.

Stress flow around a reinforced opening
An example of an actual early application of the ﬁnite element method to complex problems of engineering practice is a steel pressure vessel or aircraft structure in which openings are introduced in the stressed skin. The penetrating duct itself provides some reinforcement round the edge and, in addition, the skin itself is increased in thickness to reduce the stresses due to concentration effects. Analysis of such problems treated as cases of plane stress present no difﬁculties. The elements are chosen so as to follow the thickness variation, and appropriate values of this are assigned. The narrow band of thick material near the edge can be represented either by special bar-type elements, or by very thin triangular elements of the usual type, to which appropriate thickness is assigned. The latter procedure was used in the problem shown in Fig. 2.14 which gives some of the resulting stresses near the opening itself. The fairly large extent of the region introduced in the analysis and the grading of the mesh should be noted.
Table 2.2 Mesh size and energy for curved beam 3-node triangles Energy 0.04056964168222 0.03245261212845 0.03035760000738 0.02982725603614 0.02969411302439 0.02966078320581 0.02964966844238

Nodes 35 117 425 1617 6305 24 897 Exact

Elmts 48 192 768 3072 12 288 49 152 –

Error (%) 36.830 9.454 2.388 0.598 0.150 0.037 –

46

A direct physical approach to problems in elasticity: plane stress
100

10-1 Energy error

10-2

10-3

10-4 10-1 h/h1 100

Fig. 2.12 Curved beam: Convergence in energy error for 3-node triangles.
0 -0.001 -0.002 -0.003 ur displacement -0.004 -0.005 -0.006 -0.007 -0.008 -0.009 -0.01 0 10 20 30 40 50 60 70 80 90 uq displacement 2 1.5 1 0.5 0 -0.5 -1 -1.5 -2 -2.5 -3 0 10 20 30 40 50 60 70 80 90 x 10−3

q degrees

q degrees

(a)

(b)

Fig. 2.13 End loaded circular beam: (a) u r displacement and (b) uθ displacement for r = a.

2.10 Concluding remarks
The ‘displacement’ approach to the analysis of elastic solids is still undoubtedly the most popular and easily understood procedure. In many of the following chapters we shall use the general formulae developed here in the context of linear elastic analysis (e.g., in Chapter 6). These are also applicable in the context of non-linear analysis, the main variants being the deﬁnitions of the stresses, generalized strains, and other associated quantities.7 In Chapter 3 we shall show that the procedures developed here are but a particular case of ﬁnite element discretization applied to the governing differential equations written in terms of displacements.31 Clearly, alternative starting points are possible. Some of these will be mentioned in Chapters 10 and 11.

Problems
y 52 100 49

47

47

100

C B
48

A

100

x

Restrained in y direction from movement

Fig. 2.14 A reinforced opening in a plate. Uniform stress field at a distance from opening σ x = 100, σ y = 50. Thickness of plate regions A, B, and C is in the ratio of 1 : 3 : 23.

2.11 Problems
2.1 For the triangular element shown in Fig. 2.15(a), the dimensions are: a = 3 cm and b = 4 cm. Compute the shape functions N for the three nodes of the element. 2.2 For the rectangular element shown in Fig. 2.15(b), the dimensions are: a = 6 cm and b = 4 cm. Compute the shape functions N for the four nodes of the element. 2.3 Use the results from Problem 2.1 to compute the strain-displacement matrix B for the triangular element shown in Fig. 2.15(a). 2.4 Use the results from Problem 2.2 to compute the strain-displacement matrix B for the rectangular element shown in Fig. 2.15(b). The body force vector in a plane stress problem is given by bx = 5 and by = 0. Using the shape functions determined in Problem 2.1 compute the body force vector for the triangular element shown in Fig. 2.15(a). 2.5 Repeat Problem 2.4 using bx = 0 and by = −30. 2.6 The body force vector in a plane stress problem is given by bx = 5 and by = 0. Using the shape functions determined in Problem 2.2 compute the body force vector for the rectangular element shown in Fig. 2.15(b). 2.7 Repeat Problem 2.6 using bx = 0 and by = −30. 2.8 The edge of the triangular element deﬁned by nodes 2–3 shown in Fig. 2.15(a) is to be assigned boundary conditions un = 0 and ts = 0 where n is a direction normal to the edge and s tangential to the edge. Determine the transformation matrix L

48

A direct physical approach to problems in elasticity: plane stress
3 4 3

b

b

1

a (a) Triangle

2

1

a (b) Rectangle

2

Fig. 2.15 Elements for Problems 2.1 to 2.4.

[viz. Eq. (1.21)] required to transform the nodal degrees of freedom at node 2 and 3 to be able to impose the boundary conditions. 2.9 A concentrated load, F , is applied to the edge of a two-dimensional plane strain problem as shown in Fig. 2.16(a). (a) Use equilibrium conditions to compute the statically equivalent forces acting at nodes 1 and 2. (b) Use virtual work to compute the equivalent forces acting on nodes 1 and 2. 2.10 A triangular traction load is applied to the edge of a two-dimensional plane strain problem as shown in Fig. 2.16(b). (a) Use equilibrium conditions to compute the statically equivalent forces acting at nodes 1 and 2. (b) Use virtual work to compute the equivalent forces acting on nodes 1 and 2. 2.11 For the rectangular and triangular element shown in Fig. 2.17, compute and assemble the stiffness matrices associated with nodes 2 and 5 (i.e., K22 , K25 and K55 ). Let E = 1000, ν = 0.25 for the rectangle and E = 1200, ν = 0 for the triangle. The thickness for the assembly is constant with t = 0.2 cm.

F

q

1 a h (a) Point loading

2

1 a h (b) Hydrostatic loading

2

Fig. 2.16 Traction loading on boundary for Problems 2.9 and 2.10.

Problems
4 5

49

4 cm

1 6 cm

2 3 cm

3

Fig. 2.17 Element assembly for Problem 2.11.

2.12 The formulation given in Sec. 2.3 may be specialized to one dimension by using displacement functions ˜ ˜ ue = α1 + α2 x = N1 (x) u1 + N2 (x) u2 e ˜ ˜ δu = N1 (x) δ u1 + N2 (x) δ u2 and simplifying the equation to: Strain: ε = du = B˜ u dx Stress: σ = E ε = EB˜ u

where E is the modulus of elasticity and we assume initial stress σ0 and initial strain ε0 are zero. e e (a) For a two-node element with coordinates located at x1 and x2 compute the shape functions Na which satisfy the linear approximation given above. (b) Compute the strain matrix B for the shape functions determined in (a). (c) Using Eqs (2.25) to (2.28b) compute the element stiffness and force vector. Assume the body force b in the x direction is constant in each element. (d) For the two element problem shown in Fig. 2.18 let each element have length a = 5, the end traction t = 4, the body force b = 2 and the modulus of elasticity E = 200. i. Generalize the element formulation given in (b) to form the whole problem. ˜ ii. Impose the boundary condition u(0) = u1 = 0. ˜ ˜ iii. Determine the solution for u2 and u3 . iv. Plot the computed ﬁnite element displacement u and stress σ vs x.
1 1 a 2 2 a 3 t

Fig. 2.18 One-dimensional elasticity. Problem 2.12.

50

A direct physical approach to problems in elasticity: plane stress

(e) The exact solution to the problem satisﬁes the equilibrium equation dσ +b =0 dx and boundary conditions u(0) = 0 and t (10) = σ (10) = 4. Compute and plot the exact solution for u(x) and σ (x). (f) What is the maximum error in the ﬁnite element solutions for u and σ ? (g) Subdivide the mesh into four elements and repeat the above solution steps. Download the program FEAPpv and user manual from a web site given in Chapter 19. Note that both source code for the program and an executable version for Windowsbased systems are available at the site. If source code is used it is necessary to compile the program to obtain an executable version. Use FEAPpv (or any available program) to solve the rectangular beam problem given in Example 2.3 – verify results shown in Table 2.1. Use FEAPpv (or any available program) to solve the curved beam problem given in Example 2.4 – verify results shown in Table 2.2. The uniformly loaded cantilever beam shown in Fig. 2.19 has properties L = 2 m; h = 0.4 m; t = 0.05 m and q0 = 100 N/m Use FEAPpv (or any available program) to perform a plane stress analysis of the problem assuming linear isotropic elastic behaviour with E = 200 GPa and ν = 0.3. In your analysis: (a) Use 3-node triangular elements with an initial mesh of two elements in the depth and ten elements in the length directions. (b) Compute consistent nodal forces for the uniform loading. (c) Compute nodal forces for a parabolically distributed shear traction at the restrained end which balances the uniform loading q0 . (d) Report results for the centreline displacement in the vertical direction and the stored energy in the beam. (e) Repeat the analysis three additional times using meshes of 4 × 20, 8 × 40 and 16 × 80 elements. Tabulate the tip vertical displacement and stored energy for each solution.
y q0

2.13

2.14 2.15 2.16

h

x

L

Fig. 2.19 Uniformly loaded cantilever beam. Problem 2.16.

Problems
y

51

4

3

5

x 1 6 2 σx = 2

Fig. 2.20 Patch test for triangles. Problem 2.17.

(f) If the energy error is given by E = En − En−1 = Chp estimate C and p for your solution. (g) Repeat the above analysis using rectangular 4-node elements. 2.17 Program development project:† Write a MATLAB29 program‡ to solve plane stress problems. Your program system should have the following features: (a) Input module which describes: i. Nodal coordinate values, xa ; ii. Nodes connected to each element and material properties of each element; iii. Node and degree-of-freedom (dof) for each applied nodal forces; iv Node and dof for ﬁxed (essential) boundary condition – also value if non-zero. (b) Module to compute the stiffness matrix for a 3-node triangular element [use Eq. (2.34)]. (c) Module to assemble element arrays into global arrays and speciﬁed nodal forces and displacements. ˜ (d) Module to solve K u + f = 0. (e) Module to output nodal displacements and element stress and strains. Use your program to solve the patch test problem shown in Fig. 2.20. Use the properties: E = 2 · 105 , ν = 0.3 and t = 1 (t is thickness of slab). You can verify the correctness of your answer by computing an exact solution to the problem. The correctness of computed arrays may be obtained using results from FEAPpv (or any available plane stress program).
† If programming is included as a part of your study, it is recommended that this problem be solved. Several extensions will be suggested later to create a solution system capable of performing all steps of ﬁnite element analysis. ‡Another programming language may be used; however, MATLAB offers many advantages to write simple programs and is also useful to easily complete later exercises.

52

A direct physical approach to problems in elasticity: plane stress

2.18 Program development project: Add a graphics capability to the program developed in Problem 2.17 to plot contours of the computed ﬁnite element displacements. (Hint: MATLAB has contour and surf options to easily perform this operation.) Solve the curved beam problem for the mesh shown in Fig. 2.11. Plot contours for u and v displacements. (Hint: Write a separate MATLAB program to generate the nodal coordinates and element connections for the simple geometry of the curved beam.) Reﬁne the mesh by increasing the number of segments in each direction by a factor of 2 and repeat the solution of the curved beam problem.

References
1. R.W. Clough. The ﬁnite element method in plane stress analysis. In Proc. 2nd ASCE Conf. on Electronic Computation, Pittsburgh, Pa., Sept. 1960. 2. R.W. Clough. The ﬁnite element method in structural mechanics. In O.C. Zienkiewicz and G.S. Holister, editors, Stress Analysis, Chapter 7. John Wiley & Sons, Chichester, 1965. 3. J. Szmelter. The energy method of networks of arbitrary shape in problems of the theory of elasticity. In W. Olszak, editor, Proc. IUTAM Symposium on Non-Homogeneity in Elasticity and Plasticity. Pergamon Press, 1959. 4. R. Courant. Variational methods for the solution of problems of equilibrium and vibration. Bull. Am. Math Soc., 49:1–61, 1943. 5. W. Prager and J.L. Synge. Approximation in elasticity based on the concept of function space. Quart. J. Appl. Math., 5:241–269, 1947. 6. S.P. Timoshenko and J.N. Goodier. Theory of Elasticity. McGraw-Hill, New York, 3rd edition, 1969. 7. O.C. Zienkiewicz and R.L. Taylor. The Finite Element Method for Solid and Structural Mechanics. Butterworth-Heinemann, Oxford, 6th edition, 2005. 8. K. Washizu. Variational Methods in Elasticity and Plasticity. Pergamon Press, New York, 3rd edition, 1982. 9. F.B. Hildebrand. Methods of Applied Mathematics. Prentice-Hall (reprinted by Dover Publishers, 1992), 2nd edition, 1965. 10. Lord Rayleigh (J.W. Strutt). On the theory of resonance. Trans. Roy. Soc. (London), A161:77– 118, 1870. ¨ 11. W. Ritz. Uber eine neue Methode zur L¨ sung gewisser variationsproblem der mathematischen o physik. Journal fur die reine und angewandte Mathematik, 135:1–61, 1908. ¨ 12. B. Fraeijs de Veubeke. Displacement and equilibrium models in ﬁnite element method. In O.C. Zienkiewicz and G.S. Holister, editors, Stress Analysis, Chapter 9, pages 145–197. John Wiley & Sons, Chichester, 1965. 13. J. Demmel. Applied Numerical Linear Algebra. Society for Industrial and Applied Mathematics, Philadelphia, PA, 1997. 14. R.L. Fox and E.L. Stanton. Developments in structural analysis by direct energy minimization. J. AIAA, 6:1036–1044, 1968. 15. F.K. Bogner, R.H. Mallett, M.D. Minich, and L.A. Schmit. Development and evaluation of energy search methods in non-linear structural analysis. In Proc. 1st Conf. Matrix Methods in Structural Mechanics, volume AFFDL-TR-66-80, Wright Patterson Air Force Base, Ohio, Oct. 1966. 16. G.P. Bazeley, Y.K. Cheung, B.M. Irons, and O.C. Zienkiewicz. Triangular elements in bending – conforming and non-conforming solutions. In Proc. 1st Conf. Matrix Methods in Structural Mechanics, volume AFFDL-TR-66-80, pages 547–576, Wright Patterson Air Force Base, Ohio, Oct. 1966.

References 17. S.C. Mikhlin. The Problem of the Minimum of a Quadratic Functional. Holden-Day, San Francisco, 1966. 18. M.W. Johnson and R.W. McLay. Convergence of the ﬁnite element method in the theory of elasticity. J. Appl. Mech., ASME, 274–278, 1968. 19. P.G. Ciarlet. The Finite Element Method for Elliptic Problems. North-Holland, Amsterdam, 1978. 20. T.H.H. Pian and P. Tong. The convergence of ﬁnite element method in solving linear elastic problems. Int. J. Solids Struct., 4:865–880, 1967. 21. E.R. de Arantes e Oliveira. Theoretical foundations of the ﬁnite element method. Int. J. Solids Struct., 4:929–952, 1968. 22. G. Strang and G.J. Fix. An Analysis of the Finite Element Method. Prentice-Hall, Englewood Cliffs, N.J., 1973. 23. L.F. Richardson. The approximate arithmetical solution by ﬁnite differences of physical problems. Trans. Roy. Soc. (London), A210:307–357, 1910. 24. B.M. Irons and A. Razzaque. Experience with the patch test for convergence of ﬁnite elements. In A.K. Aziz, editor, The Mathematics of Finite Elements with Application to Partial Differential Equations, pages 557–587. Academic Press, New York, 1972. 25. B. Fraeijs de Veubeke. Variational principles and the patch test. Int. J. Numer. Meth. Eng., 8:783–801, 1974. 26. R.L. Taylor, O.C. Zienkiewicz, J.C. Simo, and A.H.C. Chan. The patch test – a condition for assessing FEM convergence. Int. J. Numer. Meth. Eng., 22:39–62, 1986. 27. O.C. Zienkiewicz, S. Qu, R.L. Taylor, and S. Nakazawa. The patch test for mixed formulations. Int. J. Numer. Meth. Eng., 23:1873–1883, 1986. 28. O.C. Zienkiewicz and R.L. Taylor. The ﬁnite element patch test revisited: a computer test for convergence, validation and error estimates. Comp. Meth. Appl. Mech. Eng., 149:523–544, 1997. 29. MATLAB. www.mathworks.com, 2003. 30. R.L. Taylor. FEAP – A Finite Element Analysis Program: Personal version, User Manual. University of California, Berkeley. http://www.ce.berkeley.edu/˜rlt/feappv. 31. O.C. Zienkiewicz and K. Morgan. Finite Elements and Approximation. John Wiley & Sons, London, 1983.

53

3 Generalization of the finite element concepts. Galerkin-weighted residual and variational approaches
3.1 Introduction
We have so far dealt with one possible approach to the approximate solution of the particular problem of linear elasticity. Many other continuum problems arise in engineering and physics and usually these problems are posed by appropriate differential equations and boundary conditions to be imposed on the unknown function or functions. It is the object of this chapter to show that all such problems can be dealt with by the ﬁnite element method. Posing the problem to be solved in its most general terms we ﬁnd that we seek an unknown function u such that it satisﬁes a certain differential equation set ⎧ ⎫ ⎪A1 (u)⎪ ⎨ ⎬ A(u) = A2 (u) = 0 (3.1) ⎪ . ⎪ ⎩ . ⎭ . in a ‘domain’ (volume, area, etc.), , together with certain boundary conditions ⎧ ⎫ ⎪B1 (u)⎪ ⎨ ⎬ B(u) = B2 (u) = 0 ⎪ . ⎪ ⎩ . ⎭ .

(3.2)

on the boundaries, , of the domain as shown in Fig. 3.1. The function sought may be a scalar quantity or may represent a vector of several variables. Similarly, the differential equation may be a single one or a set of simultaneous equations and does not need to be linear. It is for this reason that we have resorted to matrix notation in the above. The ﬁnite element process, being one of approximation, will seek the solution in the approximate form†
n

ˆ u≈u=
a=1

˜ ˜ N a ua = N u

(3.3)

where Na are shape functions prescribed in terms of independent variables (such as the ˜ coordinates x, y, etc.) and all or most of the parameters ua are unknown.
˜ † In the sequel we will also use summation convention for any repeated index. Thus Na ua ≡
a

˜ Na ua , etc.

Introduction
Γe

55

y
Ω A (u) = 0

B(u) = 0

Subdomain Ωe (element) Γ x

Fig. 3.1 Problem domain

and boundary .

In the previous chapter we have seen that precisely the same form of approximation was used in the displacement approach to elasticity problems. We also noted there that (a) the shape functions were usually deﬁned locally for elements or subdomains and (b) the properties of discrete systems were recovered if the approximating equations were cast in an integral form [viz. Eqs (2.38)–(2.42)]. With this object in mind we shall seek to cast ˜ the equation from which the unknown parameters ua are to be obtained in the integral form ˆ Gb (u)d + ˆ gb (u)d = 0 b = 1 to n (3.4)

in which Gb and gb prescribe known functions or operators. These integral forms will permit the approximation to be obtained element by element and an assembly to be achieved by the use of the procedures developed for standard discrete systems in Chapter 1, since, providing the functions Gb and gb are integrable, we have
m

Gb d

+

gb d =
e=1
e

Gb d

+
e

gb d

=0

(3.5)

where e is the domain of each element and e its part of the boundary. Two distinct procedures are available for obtaining the approximation in such integral forms. The ﬁrst is the method of weighted residuals (known alternatively as the Galerkin procedure); the second is the determination of variational functionals for which stationarity is sought. We shall deal with both approaches in turn. If the differential equations are linear, i.e., if we can write (3.1) and (3.2) as A(u) ≡ Lu + b = 0 B(u) ≡ Mu + t = 0 ˜ Ku+f = 0 with Kab =
e=1 m e Kab m

in on

(3.6)

then the approximating equation system (3.4) will yield a set of linear equations of the form (3.7)
e fa

fa =
e=1

56

Generalization of the finite element concepts

The reader not used to abstraction may well now be confused about the meaning of the various terms. We shall introduce here some typical sets of differential equations for which we will seek solutions (and which will make the problems a little more deﬁnite). Example 3.1: Steady-state heat conduction equation in a two-dimensional domain. Here the equations are written as A(φ) = − ∂φ ∂ k ∂x ∂x − ∂ ∂φ k ∂y ∂y on on
φ q

+ Q = 0 in (3.8)

⎧ ¯ ⎨ φ−φ =0 B(φ) = ∂φ ⎩k ¯ +q =0 ∂n

¯ ¯ where u ≡ φ indicates temperature, k is the conductivity, Q is a heat source, φ and q are the prescribed values of temperature and heat ﬂow on the boundaries and n is the direction normal to . In the context of this equation the boundary condition for φ is called a Dirichlet condition and the one on q a Neumann one. In the above problem k and Q can be functions of position and, if the problem is nonlinear, of φ or its derivatives. Example 3.2: Steady-state heat conduction–convection equation in two dimensions. When convection effects are added the differential equation becomes A(φ) = − ∂ ∂φ k ∂x ∂x − ∂ ∂φ k ∂y ∂y + ux ∂φ ∂φ + uy + Q = 0 in ∂x ∂y (3.9)

with boundary conditions as in the ﬁrst example. Here ux and uy are known functions of position and represent velocities of an incompressible ﬂuid in which heat transfer occurs. Example 3.3: A system of three ﬁrst-order equations equivalent to Example 3.1. The steady-state heat equation in two dimensions may also be split into the three equations ⎧ ⎫ ⎪ ∂qx + ∂qy + Q⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ∂x ⎪ ⎪ ⎪ ∂y ⎪ ⎪ ⎪ ⎪ ⎨ ⎬ ∂φ qx + k A(u) = = 0 in (3.10) ⎪ ⎪ ∂x ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ qy + k ∂φ ⎪ ⎩ ⎭ ∂y and B(u) = ¯ φ−φ =0 ¯ qn − q = 0 on on
φ q

where qn is the ﬂux normal to the boundary. Here the unknown function vector u corresponds to the set ⎧ ⎫ ⎨φ ⎬ u = qx ⎩ ⎭ qy

Integral or ‘weak’ statements equivalent to the differential equations

57

This last example is typical of a so-called mixed formulation. In such problems the number of dependent unknowns can always be reduced in the governing equations by suitable algebraic operation, still leaving a solvable problem [e.g., obtaining Eq. (3.8) from (3.10) by eliminating qx and qy ]. If this cannot be done [viz. Eq.(3.8)] we have an irreducible formulation. Problems of mixed form present certain complexities in their solution which we shall discuss in Chapter 11. In Chapter 7 we shall return to detailed examples of the ﬁrst problem and other examples will be introduced throughout the book. The above three sets of problems will, however, be useful in their full form or reduced to one dimension (by suppressing the y variable) to illustrate the various approaches used in this chapter.

Weighted residual methods
3.2 Integral or ‘weak’ statements equivalent to the differential equations
As the set of differential equations (3.1) has to be zero at each point of the domain , it follows that vT A(u)d ≡ [v1 A1 (u) + v2 A2 (u) + · · · ]d ≡ 0 (3.11) where ⎧ ⎫ ⎪v1 ⎪ ⎪ ⎪ ⎨v ⎬ 2 v= . ⎪.⎪ ⎪.⎪ ⎩ ⎭

is a set of arbitrary functions equal in number to the number of equations (or components of u) involved. The statement is, however, more powerful. We can assert that if (3.11) is satisﬁed for all v then the differential equations (3.1) must be satisﬁed at all points of the domain. The proof of the validity of this statement is obvious if we consider the possibility that A(u) = 0 at any point or part of the domain. Immediately, a function v can be found which makes the integral of (3.11) non-zero, and hence the point is proved. If the boundary conditions (3.10) are to be simultaneously satisﬁed, then we require that ¯ vT B(u)d ≡ ¯ for any set of arbitrary functions v. Indeed, the integral statement that vT A(u)d + ¯ vT B(u)d = 0 (3.13) [¯ 1 B1 (u) + v2 B2 (u) + · · · ]d = 0 v ¯ (3.12)

¯ is satisﬁed for all v and v is equivalent to the satisfaction of the differential equations (3.1) and their boundary conditions (3.2). In the above discussion it was implicitly assumed that integrals such as those in Eq. (3.13) are capable of being evaluated. This places certain restrictions on the possible families to

58

Generalization of the finite element concepts
∆ ‘Smoothing’ zone

u

du dx

d2u dx 2

−

Fig. 3.2 Differentiation of function with slope discontinuity (C0 continuity).

which the functions v or u must belong. In general we shall seek to avoid functions which result in any term in the integrals becoming inﬁnite. Thus, in Eq. (3.13) we generally ¯ limit the choice of v and v to bounded functions without restricting the validity of previous statements. What restrictions need to be placed on the functions? The answer obviously depends on the order of differentiation implied in the equations A(u) [or B(u)]. Consider, for instance, a function u which is continuous but has a discontinuous slope in the x direction, as shown in Fig. 3.2 which is identical to Fig. 2.7 but is reproduced here for clarity. We imagine this discontinuity to be replaced by a continuous variation in a very small distance (a process known as ‘moliﬁcation’) and study the behaviour of the derivatives. It is easy to see that although the ﬁrst derivative is not deﬁned here, it has ﬁnite value and can be integrated easily but the second derivative tends to inﬁnity. This therefore presents difﬁculties if integrals are to be evaluated numerically by simple means, even though the integral is ﬁnite. If such derivatives are multiplied by each other the integral does not exist and the function is known

Integral or ‘weak’ statements equivalent to the differential equations

59

as non-square integrable. Such a function is said to be C0 continuous. In a similar way it is easy to see that if nth-order derivatives occur in any term of A or B then the function has to be such that its n − 1 derivatives are continuous (Cn−1 continuity). On many occasions it is possible to perform an integration by parts on Eq. (3.13) and replace it by an alternative statement of the form C(v)T D(u)d + E(¯ )T F (u)d = 0 v (3.14)

In this the operators C to F usually contain lower order derivatives than those occurring in operators A or B. Now a lower order of continuity is required in the choice of the u ¯ function at a price of higher continuity for v and v. The statement (3.14) is now more ‘permissive’ than the original problem posed by Eq. (3.1), (3.2), or (3.13) and is called a weak form of these equations. It is a somewhat surprising fact that often this weak form is more realistic physically than the original differential equation which implied an excessive ‘smoothness’ of the true solution. Integral statements of the form of (3.13) and (3.14) will form the basis of ﬁnite element approximations, and we shall discuss them later in fuller detail. Before doing so we shall apply the new formulation to an example. Example 3.4: Weak form of the heat conduction equation – forced and natural boundary conditions. Consider now the integral form of Eq. (3.8). We can write the statement (3.13) as v − ∂φ ∂ k ∂x ∂x − ∂ ∂φ k ∂y ∂y + Q dx dy +
q

v k ¯

∂φ ¯ +q d =0 ∂n

(3.15)

noting that v and v are scalar functions† and presuming that one of the boundary conditions, ¯ i.e., ¯ φ−φ =0 is automatically satisﬁed by the choice of the functions φ on φ . This type of boundary condition is often called a ‘forced’ or an ‘essential’ one. Equation (3.15) can now be integrated by parts to obtain a weak form similar to Eq. (3.14). We shall make use here of general formulae for such integration (Green’s formulae) which we derive in Appendix G and which on many occasions will be useful, i.e., v ∂ ∂φ k dx dy ≡ − ∂x ∂x ∂v ∂φ k dx dy + ∂x ∂x ∂v ∂φ k dx dy + ∂y ∂y v k ∂φ nx d ∂x (3.16)

∂φ ∂ k dx dy ≡ − v ∂y ∂y We have thus in place of Eq. (3.15)

∂φ ny d v k ∂y

∂v ∂φ ∂v ∂φ k + k + vQ dx dy − ∂x ∂x ∂y ∂y +

vk

q

∂φ ∂φ nx + ny d ∂x ∂y ∂φ ¯ +q d =0 v k ¯ ∂n

(3.17)

† Two functions are introduced such that simpliﬁcations are possible at later stages of the development.

60

Generalization of the finite element concepts

Noting that the derivative along the normal is given as ∂φ ∂φ ∂φ ≡ nx + ny ∂n ∂x ∂y and, further, making v=v ¯ on ∂φ d =0 ∂n (3.19) without loss of generality (as both functions are arbitrary), we can write Eq. (3.17) as (∇v)T (k∇φ)d + vQd +
q

(3.18)

¯ vqd −
φ

vk

(3.20)

where the operator ∇ is simply

⎧ ⎫ ⎪∂ ⎪ ⎪ ⎪ ⎨ ⎬ ∂x ∇= ⎪∂ ⎪ ⎪ ⎪ ⎩ ⎭ ∂y

We note that (a) the variable φ has disappeared from the integrals taken along the boundary q and that the boundary condition ∂φ ¯ B(φ) = k +q =0 ∂n on that boundary is automatically satisﬁed – such a condition is known as a natural boundary condition – and ¯ (b) if the choice of φ is restricted so as to satisfy the forced boundary conditions φ − φ = 0, we can omit the last term of Eq. (3.20) by restricting the choice of v to functions which give v = 0 on φ . The form of Eq. (3.20) is the weak form of the heat conduction statement equivalent to Eq. (3.8). It admits discontinuous conductivity coefﬁcients k and temperature φ which show discontinuous ﬁrst derivatives, a real possibility not easily admitted in the differential form.

3.3 Approximation to integral formulations: the weighted residual-Galerkin method
If the unknown function u is approximated by the expansion (3.3), i.e.,
n

ˆ u≈u=
a=1

˜ ˜ N a ua = N u

then it is clearly impossible to satisfy both the differential equation and the boundary conditions in the general case. The integral statements (3.13) or (3.14) allow an approximation to be made if, in place of any function v, we put a ﬁnite set of approximate functions
n n

v≈
b=1

˜ ˆ wb δ ub and v =
b=1

¯ ˜ wb δ u b

(3.21)

Approximation to integral formulations: the weighted residual-Galerkin method

61

˜ in which δ ub are arbitrary parameters. Inserting the approximations into Eq. (3.13) we have the relation ˜b δ uT
T ˜ wb A(N u) d

+

˜ ¯T wb B(N u) d

=0

˜ and since δ ub is arbitrary we have a set of equations which is sufﬁcient to determine the ˜ parameters u as
T ˜ wb A(N u) d

+

˜ ¯T wb B(N u) d = 0; b = 1, 2, . . . , n

(3.22)

Performing similar steps using Eq. (3.14) gives the set ˜ C T (wb )D(N u) d + ¯ ˜ E T (wb )F (N u) d = 0; b = 1, 2, . . . , n (3.23)

˜ If we note that A(Nu) represents the residual or error obtained by substitution of the ˜ approximation into the differential equation [and B(Nu), the residual of the boundary conditions], then Eq. (3.22) is a weighted integral of such residuals. The approximation may thus be called the method of weighted residuals. In its classical sense it was ﬁrst described by Crandall,1 who points out the various forms used since the end of the nineteenth century. Later a very full expos´ of the method was e given by Finlayson.2 Clearly, almost any set of independent functions wb could be used for the purpose of weighting and, according to the choice of function, a different name can be attached to each process. Thus the various common choices are: 1. Point collocation.3 wb = δ b in (3.22), where δ b is such that for x = xb ; y = yb , wb = 0 wb d = 1 (unit matrix). This procedure is equivalent to simply making the but residual zero at n points within the domain and integration is ‘nominal’ (incidentally although wb deﬁned here does not satisfy all the criteria of Sec. 3.2, it is nevertheless admissible in view of its properties). Finite difference methods are particular cases of this weighting. 2. Subdomain collocation.4 wb = I in subdomain b and zero elsewhere. This essentially makes the integral of the error zero over the speciﬁed subdomains. When used with (3.23) this is one of the many ﬁnite volume methods.5 3. The Galerkin method (Bubnov–Galerkin).4, 6 wb = Nb . Here simply the original shape (or basis) functions are used as weighting. This method, as we shall see, frequently (but by no means always) leads to symmetric matrices and for this and other reasons will be adopted in this book almost exclusively. The name of ‘weighted residuals’ is clearly much older than that of the ‘ﬁnite element method’. The latter uses mainly locally based (element) functions in the expansion of Eq. (3.3) but the general procedures are identical. As the process always leads to equations which, being of integral form, can be obtained by summation of contributions from various subdomains, we choose to embrace all weighted residual approximations under the name of generalized ﬁnite element method. On occasion, simultaneous use of both local and ‘global’ trial functions will be found to be useful. In the literature the names of Petrov and Galerkin6 are often associated with the use of weighting functions such that wb = Nb . It is important to remark that the well-known ﬁnite difference method of approximation is a particular case of collocation with locally deﬁned

62

Generalization of the finite element concepts

Q0

h L

Fig. 3.3 Problem description and loading for 1-d heat conduction example.

basis functions and is thus a case of a Petrov–Galerkin scheme. We shall return to such unorthodox deﬁnitions in more detail in Chapter 15. To illustrate the procedure of weighted residual approximation and its relation to the ﬁnite element process let us consider some speciﬁc examples. Example 3.5: One-dimensional equation of heat conduction. The problem here will be a one-dimensional representation of the heat conduction equation [Eq. (3.8)] with unit conductivity. (This problem could equally well represent many other physical situations, e.g., deﬂection of a loaded string with unit tension.) Here we have (see Fig. 3.3) A(φ) = − with Q(x) given by Q(x) = 0 −2 Q0 (x/L − 1/2) 0 < x ≤ L/2 L/2 < x < L (3.24b) d2 φ + Q(x) = 0 (0 < x < L) dx 2 (3.24a)

The boundary conditions assumed will be simply φ = 0 at x = 0 and x = L. The problem is solved by a Galerkin-weighted residual method in which the ﬁeld φ(x) is approximated by piecewise deﬁned (locally based) functions. Here we use the equivalent of Eq. (3.14) which results from an integration by parts of
L 0

wb − dwb dx

d2 dx 2

˜ Na φa
a

+ Q dx = 0

to obtain
0

L

a

dNa ˜ φa dx
N2

+ wb Q dx = 0

(3.25)

N1

1 x 1 h 2

Fig. 3.4 Linear locally based one-dimensional shape functions.

Approximation to integral formulations: the weighted residual-Galerkin method

63

in which the boundary terms disappear if we require wb = 0 at the two ends. For the Galerkin solution we use wb = Nb ; hence, the above equation can be written as ˜ Kφ+f = 0 where for each element of length h,
e Kba = h 0

(3.26)

dNb dNa dx dx dx Nb Q(x) dx

fbe

=
0

h

(3.27)

with the usual rules of adding pertaining, i.e., Kba =
e e Kba and fb = e

fbe

The reader will observe that the matrix K is symmetric, i.e., Kba = Kab . As the shape functions need only be of C0 continuity, a piecewise linear approximation is conveniently used, as shown in Fig. 3.4. Considering a typical element 1–2 shown, we can write (translating the cartesian origin of x to point 1) N1 = 1 − x/ h and N2 = x/ h giving for a typical element Ke = 1 h h 6 1 −1 −1 1 (3.29) (3.28)

fe = −

2 Q1 + Q2 Q1 + 2 Q2

where Q1 and Q2 are load intensities at the x1 and x2 coordinates, respectively. Assembly of four equal size elements results, after inserting the boundary conditions ˜ ˜ φ1 = φ5 = 0, in the equation set ⎧ ⎫ ⎡ ⎤⎧ ⎫ ˜ 2 −1 0 ⎨φ2 ⎬ Q L ⎨0⎬ 4 ⎣ 0 ˜ −1 2 −1 ⎦ φ3 = 1 (3.30) ⎩˜ ⎭ L 48 ⎩6⎭ 0 −1 2 φ4 The solution is shown in Fig. 3.5 along with the exact solution to the problem. For comparison purposes we also show a ﬁnite difference solution in which simple collocation is used in a weighted residual equation together with the approximation for the second derivative given by a Taylor expansion d2 φ dx 2 ≈ 1 ˜ ˜ ˜ φa−1 − 2φa + φa+1 h2 (3.31)

xa

which yields the approximation for each node point 1 ˜ ˜ ˜ −φa−1 + 2φa − φa+1 + Qa = 0 h2 (3.32)

64

Generalization of the finite element concepts

Again after including the boundary conditions a set of three equations for the points 2, 3 and 4 is expressed as ⎧ ⎫ ⎡ ⎤⎧ ⎫ ˜ 2 −1 0 ⎨φ2 ⎬ ⎨ 0 ⎬ 16 ⎣ ˜ −1 2 −1 ⎦ φ3 = Q0 0 (3.33) ⎩˜ ⎭ ⎩ ⎭ L2 0 −1 2 1/2 φ4 The reader will note that the coefﬁcient matrix for the ﬁnite element and ﬁnite difference methods differ by only a constant multiplier (for the boundary conditions assumed in this one-dimensional problem); however, the right sides differ signiﬁcantly. We also plot the solution to (3.33) (and one for half the mesh spacing) in Fig. 3.5. Here we note that the nodal results for the ﬁnite element method are exact whereas those for the ﬁnite difference solution are all in error (although convergence can be observed for the ﬁner subdivision). The nodal exactness is a property of the particular equation being solved and unfortunately does not carry over to general problems.7 (See also Appendix H.) However, based on the above result and other experiences we can say that the ﬁnite element method always achieves (the same or) better results than classical ﬁnite difference methods. In addition, the ﬁnite element method permits an approximation of the solution at all points in the domain as indicated by the dashed lines in Fig. 3.5 for the one-dimensional problem. The problem is repeated using 4-quadratic order ﬁnite elements and results are shown in Fig. 3.6. It is evident that the use of quadratic order greatly increases the accuracy of the results obtained. Indeed, if cubic order elements were used results would be exact, since for linear varying Q the solution over the loaded portion will only contain polynomials up to cubic order.
0.03

0.025

f/(Q0 L2) displacement

0.02

0.015

0.01

FE - h = L/4 FD - h = L/4 FD - h = L/8

0.005

0

0

0.2

0.4

0.6

0.8

1

x /L coordinate

Fig. 3.5 One-dimensional heat conduction. Solution by finite element method with linear elements and h = L/4; finite difference method with h = L/4 and h = L/8.

Approximation to integral formulations: the weighted residual-Galerkin method
0.03

65

0.025

f/(Q0 L2) displacement

0.02

0.015

0.01

0.005

0

0

0.2

0.4 0.6 x/L coordinate

0.8

1

Fig. 3.6 One-dimensional heat conduction. Solution by finite element method with quadratic elements and h = L/4.

Example 3.6: Steady-state heat conduction in two dimensions: Galerkin formulation with triangular elements. We have already introduced the problem in Sec. 3.1 and deﬁned it by Eq. (3.8) with appropriate boundary conditions. The weak form has been obtained in ˜ ˜ Eq. (3.20). Approximating the weight by v = Nb δ φb and solution by φ = Na φa we have immediately that ˜ Kφ+f = 0 where
e Kba =

∂Nb ∂Na ∂Nb ∂Na k + k ∂x ∂x ∂y ∂y Nb Q d + ¯ Nb q d

d (3.34)

fbe =

Once again the components of Kba and fb can be evaluated for a typical element or subdomain and the system of equations built by standard methods. For instance, considering the set of nodes and elements shown shaded in Fig. 3.7(b), to e compute the equation for node 1 it is only necessary to compute the Kba for two element shapes as indicated in Fig. 3.7. For the Type 1 element (left element in Fig. 3.7(c)) the shape functions evaluated from (2.8) using (2.6) and (2.7) gives N1 = 1 − y x y−x ; N2 = ; N3 = h h h

66

Generalization of the finite element concepts

thus, the derivatives are given by:

⎧ ⎫ ⎧ ⎪ ∂N1 ⎪ ⎪ 0 ⎪ ⎪ ⎪ ⎪ ∂x ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ∂N ⎨ ∂N2 ⎬ ⎨ 1 = = ⎪ ∂x ⎪ ⎪ h ∂x ⎪ ⎪ ⎪ ⎪ ⎪ ∂N ⎪ ⎪ 1 ⎪ 3⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎩ − ⎩ ⎭ h ∂x

⎫ ⎪ ⎪ ⎪ ⎪ ⎪ ⎬

⎫ ⎧ ⎪ −1 ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ h ⎪ ⎪ ⎪ ⎬ ⎨ ∂N 2 0 and = = ⎪ ⎪ ⎪ ∂y ⎪ ⎪ ∂y ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ∂N3 ⎪ ⎪ 1 ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎭ ⎭ ⎪ ⎩ ⎪ ⎭ ⎩ h ∂y

⎫ ⎧ ⎪ ∂N1 ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ∂y ⎪ ⎪ ⎪ ⎪ ⎬ ⎨ ∂N ⎪

Similarly, for the Type 2 element the shape functions are expressed by

N1 = 1 −
y

x x−y y ; N2 = ; N3 = h h h
N1 5 1 1 6 1 2 4 3

x h h (a) Shape function for triangle 3 2

7

8

9

(b) ‘Connected’ equations for node 1 3

h

h

1 h

1 h (c) Type 1 and Type 2 element shapes in mesh

2

Fig. 3.7 Linear triangular elements for heat conduction example.

Approximation to integral formulations: the weighted residual-Galerkin method

67

and their derivatives by ⎧ ⎫ ⎫ ⎧ ⎧ ⎫ ⎪ ∂N1 ⎪ ⎪ ⎪ ∂N1 ⎪ ⎧ 1 ⎫ 0 ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ∂y ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ∂x ⎪ ⎪ − ⎪ ⎪ ⎪ ⎪ ⎪ h ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎨ ⎪ ⎨ ∂N ⎪ ⎪ 1 ⎪ ⎬ ⎬ ⎬ ⎬ ⎨ ⎨ ∂N ∂N ∂N2 2 − 1 = and = = = ⎪ ∂y ⎪ ⎪ h ⎪ ⎪ ⎪ ∂x ⎪ ⎪ ∂y ∂x ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ∂N3 ⎪ ⎪ 1 ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ∂N ⎪ ⎪ h ⎪ ⎪ ⎪ ⎭ ⎩ ⎪ ⎪ ⎪ 3⎪ ⎪ ⎪ ⎭ ⎪ ⎪ ⎩ ⎪ ⎩ ⎭ ⎭ ⎩ 0 h ∂y ∂x
e Evaluation of the matrix Kba and fbe for Type 1 and Type 2 elements gives ⎡ ⎤⎧ e ⎫ ⎡ ⎤ ⎧ e⎫ ˜ ˜ 1 0 −1 ⎨φ1 ⎬ 1 −1 0 ⎨φ1 ⎬ 1 ⎣ 1 ⎣ e e e˜ ˜ ˜e ˜e ⎦ φ2 and K e φ = k −1 ⎦ φ2 , 0 1 −1 2 −1 K φ = k ⎩ ˜ e⎭ ⎩ ˜ e⎭ 2 2 −1 −1 2 0 −1 1 φ3 φ3

respectively. Note that the stiffness matrix does not depend on the size h of the element. This is a property of all two-dimensional elements in which the B matrix depends only on ﬁrst derivatives of C0 shape functions. The force vector for a constant Q over each element is given by ⎧ ⎫ ⎨1⎬ 1 f e = Qh2 1 ⎩ ⎭ 6 1 for both types of elements. Assembling the patch of elements shown in Fig. 3.7(b) gives the equation with non-zero coefﬁcients for node 1 as ⎧ ⎫ ˜ ⎪ φ1 ⎪ ⎪ ⎪ ⎪˜ ⎪ ⎪φ2 ⎪ ⎨ ⎬ ˜ k[4 −1 −1 −1 −1] φ4 = Q h2 ⎪˜ ⎪ ⎪ φ6 ⎪ ⎪ ⎪ ⎪ ⎪ ⎩˜ ⎭ φ8 The reader should note that the ﬁnal stiffness for node 1 does not depend on nodes 3 and 7 of the patch, whereas there are non-zero stiffness coefﬁcients in the individual elements. Thus, the ﬁnal result is only true when the arrangement of the nodes is regular. If the location of any of the nodes lies on an irregular pattern then ﬁnal stiffness coefﬁcients will remain for these nodes also. Repeating the construction of the stiffness terms using a ﬁnite difference approximation [as given in Eq. (3.31)] directly in the differential equation (3.8) gives the approximation ⎧ ⎫ ˜ ⎪ φ1 ⎪ ⎪ ⎪ ⎪˜ ⎪ ⎪φ2 ⎪ ⎨ ⎬ k ˜ [4 −1 −1 −1 −1] φ4 = Q ⎪˜ ⎪ h2 ⎪ φ6 ⎪ ⎪ ⎪ ⎪ ⎪ ⎩˜ ⎭ φ8 and once again the assembled node is identical to the ﬁnite difference approximation to ¯ within a constant multiplier. If all the boundary conditions are forced (i.e., φ = φ) no differences arise between a ﬁnite element and a ﬁnite difference solution for the regular mesh assumed. However, if any boundary conditions are of natural type or the mesh is

68

Generalization of the finite element concepts

irregular differences will arise. Indeed, no restrictions on shape of elements or assembly type are imposed by the ﬁnite element approach. Example 3.7: Steady-state heat conduction–convection in two dimensions: Galerkin formulation. We have already introduced the problem in Sec. 3.1 and deﬁned it by Eq. (3.9) with appropriate boundary conditions. The equation differs only in the convective terms from that of simple heat conduction for which the weak form has already been obtained in Eq. (3.20). We can write the weighted residual equation immediately from this, substituting ˜ v = wb δ φb and adding the convective terms. Thus we have (∇wb )T k ∇φd + wb ux ∂φ ∂φ + uy ∂x ∂y d + wb Q d +
q

¯ wb q d

=0

(3.35) ˆ ¯ ˜ with φ = a Na φa being such that the prescribed values of φ are given on the boundary ˜ φ and that δ φb = 0 on that boundary [ignoring that term in (3.35)]. Specializing to the Galerkin approximation, i.e., putting wb = Nb , we have immediately a set of equations of the form ˜ Kφ + f = 0 (3.36) with Kba = = fb = (∇Nb )T k∇Na d + N b ux ∂Na ∂Na + N b uy d ∂x ∂y ∂Na ∂Na N b ux d + + N b uy d ∂x ∂y

∂Nb ∂Na ∂Nb ∂Na k + k ∂x ∂x ∂y ∂y Nb Qd +
q

(3.37)

¯ Nb qd

Once again the components Kba and fb can be evaluated for a typical element or subdomain and systems of equations built up by standard methods. At this point it is important to mention that to satisfy the boundary conditions some of ˜ the parameters φa have to be prescribed and the number of approximation equations must be equal to the number of unknown parameters. It is nevertheless often convenient to form all equations for all parameters and prescribe the ﬁxed values at the end using precisely the same techniques as we have described in Chapter 1 for the insertion of prescribed boundary conditions in standard discrete problems. A further point concerning the coefﬁcients of the matrix K should be noted here. The ﬁrst part, corresponding to the pure heat conduction equation, is symmetric (Kab = Kba ) but the second is not and thus a system of non-symmetric equations needs to be solved. There is a basic reason for such non-symmetries which will be discussed in Sec. 3.9. To make the problem concrete consider the domain to be divided into regular square elements of side h (Fig. 3.8(b)). To preserve C0 continuity with nodes placed at corners, shape functions given as the product of the linear expansions can be written. For instance, for node 1, as shown in Fig. 3.8(a), x y N1 = h h and for node 2,

Virtual work as the ‘weak form’ of equilibrium equations for analysis of solids or fluids
N2 y N1 5 1 2 1 6 1 2 4 3

69

x h h (a) Shape functions for square element (b) ‘Connected’ equations for node 1 7 8 9

Fig. 3.8 Linear square elements for heat conduction–convection example.

(h − x) y , etc. h h With these shape functions the reader is invited to evaluate typical element contributions and to assemble the equations for point 1 of the mesh numbered as shown in Fig. 3.8(b). If Q is assumed to be constant, the result will be N2 = 8k ˜ φ1 − 3 − − k ux h ˜ − φ2 − 3 3 k ux h uy h − + 12 12 3 k uy h ˜ + φ8 − 3 3 k ux h uy h − − 3 12 12 ux h k ˜ φ5 − + 3 3 ux h uy h k − + 3 12 12 ˜ φ3 − ˜ φ6 − k uy h ˜ − φ4 3 3 ux h uy h ˜ k + + φ7 3 12 12

(3.38)

˜ φ9 = −Qh2

This equation is similar to those that would be obtained by using ﬁnite difference approximations to the same equations in a fairly standard manner.8, 9 In the example discussed some difﬁculties arise when the convective terms are large. In such cases the Galerkin weighting is not acceptable and other forms have to be used. For problems dealing with ﬂuid dynamics this is discussed in detail in reference 10.

3.4 Virtual work as the ‘weak form’ of equilibrium equations for analysis of solids or fluids
In Chapter 2 we introduced a ﬁnite element by way of an application to the solid mechanics problem of linear elasticity. The integral statement necessary for formulation in terms of the ﬁnite element approximation was supplied via the principle of virtual work, which was assumed to be so basic as not to merit proof. Indeed, to many this is so, and the virtual work principle is considered by some as a statement of mechanics more fundamental than the traditional equilibrium conditions of Newton’s laws of motion. Others will argue with this view and will point out that all work statements are derived from the classical laws pertaining to the equilibrium of the particle. We shall therefore show in this section that the virtual work statement is simply a ‘weak form’ of equilibrium equations. In a general three-dimensional continuum the equilibrium equations of an elementary volume can be written in terms of the components of the symmetric cartesian stress tensor

70

Generalization of the finite element concepts

as11, 12

⎫ ⎧ ⎪ ∂σx + ∂τxy + ∂τxz + bx ⎪ ⎪ ⎪ ⎪ ⎪ ∂x ⎪ ⎫ ⎪ ⎧ ∂y ∂z ⎪ ⎪ ⎪ ⎪ ⎬ ⎨ ∂τ ⎨ A1 ⎬ ∂τyz ∂σy xy + + by + A2 =0 =− ⎪ ⎭ ⎪ ∂x ⎩ ∂y ∂z ⎪ ⎪ A3 ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ∂τxz ∂τyz ∂σz ⎪ ⎭ ⎩ + bz ⎪ + + ∂z ∂x ∂y
T

(3.39)

where b = bx by bz stands for the body forces acting per unit volume (which may well include acceleration effects by the d’Alembert principle). In solid mechanics the six stress components will be some general functions of the six components of strain (ε) which are computed from the displacement u= u v w
T

(3.40)

and in ﬂuid mechanics of the velocity vector u, which has identically named components. Thus Eq. (3.39) can be considered as a general equation of the form Eq. (3.1), i.e., A(u) = 0. To obtain a weak form we shall proceed as before, introducing an arbitrary weighting function vector deﬁned as v ≡ δ u = δ u, δ v, δ w We can now write the integral statement of Eq. (3.11) as δuT A(u) d =− =0 (3.42) where the volume, , is the problem domain. Integrating each term by parts and rearranging we can write this as ∂δu σx + ∂x − where ∂δu ∂δv + ∂y ∂x τxy + · · · − δu bx − δv by − δw bz d (3.43) δu ∂σx ∂τxy ∂τxz + + + bx ∂x ∂y ∂y + δv(A2 ) + δw(A3 ) d
T

(3.41)

δu tx + δv ty + δw tz d = 0 ⎫ ⎧ ⎫ ⎧ ⎨tx ⎬ ⎨nx σx + ny τxy + nz τxz ⎬ t = ty = nx τxy + ny σy + nz τyz ⎭ ⎩ ⎭ ⎩ tz nx τxz + ny τyz + nz σz

(3.44)

are tractions acting per unit area of external boundary surface of the solid [in (3.43) Green’s formulae of Appendix G are again used]. In the ﬁrst set of bracketed terms in (3.43) we can recognize immediately the small strain operators acting on δu, which can be termed a virtual displacement (or virtual velocity).

Partial discretization

71

We can therefore introduce a virtual strain (or strain rate) deﬁned as ⎧ ⎫ ∂δu ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ∂x ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ∂δv ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ∂y ⎪ ⎪ ⎨ ⎬ ∂δw δε = = Sδu ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ∂z ⎪ ⎪ ∂δu ∂δv ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ + ⎪ ⎪ ⎪ ∂y ∂x ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ ⎪ . ⎩ ⎭ . .

(3.45)

where the strain operator is deﬁned as in Chapter 2 [Eqs (2.13)–(2.15)]. Arranging the six stress components in a vector σ in an order corresponding to that used for δε, we can write Eq. (3.43) simply as δεT σ d − δuT b d − δuT t d = 0 (3.46)

which is the three-dimensional equivalent virtual work statement used in Eqs (2.25) and (2.38) of Chapter 2. We see from the above that the virtual work statement is precisely the weak form of equilibrium equations and is valid for non-linear as well as linear stress–strain (or stress– strain rate) relations. The ﬁnite element approximation which we have derived in Chapter 2 is in fact a Galerkin formulation of the weighted residual process applied to the equilibrium equation. Thus if we take δu as the shape function times arbitrary parameters δu =
b

˜ N b δ ub

(3.47)

where the displacement ﬁeld is discretized, i.e., u=
a

˜ N a ua

(3.48)

together with the strain-displacement relations ε=
a

˜ S N a ua =
a

˜ B a ua

(3.49)

and constitutive relation of Eq. (2.16), we shall determine once again all the basic expressions of Chapter 2 which are so essential to the solution of elasticity problems. We shall consider this class of problems further in Chapter 6. Similar expressions are vital to the formulation of equivalent ﬂuid mechanics problems as discussed in reference 10.

3.5 Partial discretization
In the approximation to the problem of solving the differential equation (3.1) by an expression of the standard form of Eq. (3.3), we have assumed that the shape functions N include

72

Generalization of the finite element concepts

˜ all independent coordinates of the problem and that u was simply a set of constants. The ﬁnal approximation equations were thus always of an algebraic form, from which a unique set of parameters could be determined. In some problems it is convenient to proceed differently. Thus, for instance, if the ˜ independent variables are x, y and z we could allow the parameters u to be functions of z and do the approximate expansion only in the domain of x, y, say ¯ . Thus, in place of Eq. (3.3) we would have ˜ u = N(x, y) u(z) (3.50) ˜ Clearly the derivatives of u with respect to z will remain in the ﬁnal discretization and the result will be a set of ordinary differential equations with z as the independent variable. In linear problems such a set will have the appearance ˙ ˜ ˜ K u + Cu + · · · + f = 0 (3.51)

˙ ˜ ˜ where u ≡ du/dz, etc. Such a partial discretization can obviously be used in different ways, but is particularly useful when the domain ¯ is not dependent on z, i.e., when the problem is prismatic. In such a case the coefﬁcient matrices of the ordinary differential equations, (3.51), are independent of z and the solution of the system can frequently be carried out efﬁciently by standard analytical methods. This type of partial discretization has been applied extensively by Kantorovich13 and is frequently known by his name. Semi-analytical treatments are presented in reference 14 for prismatic solids where the ﬁnal solution is obtained in terms of Fourier (or other) series. However, the most frequently encountered ‘prismatic’ problem is one involving the time variable, where the space domain ¯ is not subject to change. We shall address such problems in Chapter 16 of this volume. It is convenient by way of illustration to consider here heat conduction in a two-dimensional equation in its transient state. This is obtained from Eq. (3.8) by addition of the heat storage term c(∂φ/∂t), where c is the speciﬁc heat per unit volume. We now have a problem posed in a domain (x, y, t) in which the following equation holds: A(φ) ≡ − ∂ ∂φ k ∂x ∂x − ∂ ∂φ k ∂y ∂y +Q+c ∂φ =0 ∂t (3.52)

with boundary conditions identical to those of Eq. (3.8) and the temperature taken as zero at time zero. Taking ˜ ˆ Na (x, y) φa (t) (3.53) φ≈φ=
a

and using the Galerkin weighting procedure we follow precisely the steps outlined in Eqs (3.35)–(3.37) and arrive at a system of ordinary differential equations ˜ Kφ + C ˜ dφ +f =0 dt (3.54)

Here the expression for Kba and fb are identical with that of Eq. (3.34) and the reader can verify that the matrix C is deﬁned by Cab = Na cNb dx dy (3.55)

Partial discretization

73

Once again the matrix C can be assembled from its element contributions. Various analytical and numerical procedures can be applied simply to the solution of such transient, ordinary, differential equations which, again, we shall discuss in detail in Chapters 16 and 17. However, to illustrate the detail and the possible advantage of the process of partial discretization, we shall consider a very simple problem. Example 3.8: Heat equation with heat generation. Consider a long bar with a square cross-section of size L × L in which the transient heat conduction equation (3.52) applies and assume that the rate of heat generation varies with time as Q = Q0 e−αt (3.56)

(this might approximate a problem of heat development due to hydration of concrete). We assume that at t = 0, φ = 0 throughout. Further, we shall take φ = 0 on all boundaries for all times. An approximation for the solution is taken:
M N

φ=
m=1 n=1

˜ Nmn (x, y) φmn (t)

Nmn

nπy mπ x cos ; m, n = 1, 3, 5, · · · = cos L L

(3.57)

with x and y measured from the centre (Fig. 3.9). The even components of the Fourier series are omitted due to the required symmetry of solution. Evaluating the coefﬁcients (only diagonal terms exist in K), we have Kmn = Cmn = fmn =
L/2 −L/2 L/2 −L/2 L/2 −L/2 L/2 −L/2 L/2 −L/2 L/2 −L/2

k

∂Nmn ∂x

2

+k L2 c 4

∂Nmn ∂y

2

dx dy =

π 2k 2 (m + n2 ) 4 (3.58)

mn cN1 dx dy =

Nmn Q0 e−αt dx dy =

4Q0 L2 (−1)(m+3)/2 (−1)(n+3)/2 e−αt mnπ 2

˜ This leads to an ordinary differential equation with parameters φmn : ˜ dφmn ˜ Kmn φmn + Cmn + fmn = 0 dt (3.59)

˜ with φmn = 0 when t = 0. The exact solution of this is easy to obtain, as is shown in Fig. 3.9 for speciﬁc values of the parameters M, N, α and k/L2 c. The remarkable accuracy of the approximation with M = N = 3 in this example should be noted. In this example we have used trigonometric functions in place of the more standard polynomials used in the ﬁnite element method. In Chapter 7 we recalculate the solution using a standard ﬁnite element method in which the solution to the time problem is computed using a ﬁnite difference method.

74

Generalization of the finite element concepts
0.35 0.3 (p2 c/16Q0) f(0,0,t) 0.25 0.2 0.15 0.1 0.05 f=0 0
M,N=1 M,N=3

y

x

0

0.5

1

1.5

2 t-time

2.5

3

3.5

4

(a) Boundary condition

(b) Solution at centre

Fig. 3.9 Two-dimensional transient heat development in a square prism – plot of temperature at centre.

3.6 Convergence
In the previous sections we have discussed how approximate solutions can be obtained by use of an expansion of the unknown function in terms of trial or shape functions. Further, we have stated the necessary conditions that such functions have to fulﬁl in order that the various integrals can be evaluated over the domain. Thus if various integrals contain only the values of N and its ﬁrst derivatives then N has to be C0 continuous. If second derivatives are involved, C1 continuity is needed, etc. The problem which we have not yet addressed ourselves consists of the questions of just how good the approximation is and how it can be systematically improved to approach the exact answer. The ﬁrst question is more difﬁcult to answer and presumes knowledge of the exact solution (see Chapter 13). The second is more rational and can be answered if we consider some systematic way in which the ˜ number of parameters u in the standard expansion of Eq. (3.3),
n

ˆ u=
a=1

˜ N a ua

is presumed to increase. In some examples we have assumed, in effect, a trigonometric Fourier-type series limited to a ﬁnite number of terms with a single form of trial function assumed over the whole domain. Here addition of new terms would be simply an extension of the number of terms in the series included in the analysis, and as the Fourier series is known to be able to represent any function within any accuracy desired as the number of terms increases, we can talk about convergence of the approximation to the true solution as the number of terms increases. In other examples of this chapter we have used locally based polynomial functions which are fundamental in the ﬁnite element analysis. Here we have tacitly assumed that

Convergence

75

˜ convergence occurs as the size of elements decreases and, hence, the number of u parameters speciﬁed at nodes increases. It is with such convergence that we need to be concerned and we have already discussed this in the context of the analysis of elastic solids in Chapter 2 (Sec. 2.6). We have now to determine (a) that, as the number of elements increases, the unknown functions can be approximated as closely as required, and (b) how the error decreases with the size, h, of the element subdivisions (h is here some typical dimension of an element). The ﬁrst problem is that of completeness of the expansion and we shall here assume that all trial functions are polynomials (or at least include certain terms of a polynomial expansion). Clearly, as the approximation discussed here is to the weak, integral form typiﬁed by Eq. (3.11) or (3.14) it is necessary that every term occurring under the integral be in the limit capable of being approximated as nearly as possible and, in particular, giving a constant value over any arbitrary inﬁnitesimal part of the domain . If a derivative of order m exists in any such term, then it is obviously necessary for the local polynomial to be at least of the order m so that, in the limit, such a constant value can be obtained. We will thus state that a necessary condition for the expansion to be covergent is the criterion of completeness: that, if mth derivatives occur in the integral form, a constant value of all derivatives up to order m be attainable in the element domain when the size of any element tends to zero. This criterion is automatically ensured if the polynomials used in the shape function N are complete to mth order. This criterion is also equivalent to the one of constant strain postulated in Chapter 2 (Sec. 2.5). This, however, has to be satisﬁed only in the limit h → 0. If the actual order of a complete polynomial used in the ﬁnite element expansion is p ≥ m, then the order of convergence can be ascertained by seeing how closely such a polynomial can follow the local Taylor expansion of the unknown u. Clearly the order of error will be simply O(hp+1 ) since only terms of order p can be rendered correctly. Knowledge of the order of convergence helps in ascertaining how good the approximation is if studies on several decreasing mesh sizes are conducted. Though, in Chapter 14, we shall see the asymptotic convergence rate is seldom reached if singularities occur in the problem. Once again we have re-established some of the conditions discussed in Chapter 2. We shall not discuss, at this stage, approximations which do not satisfy the postulated continuity requirements except to remark that once again, in many cases, convergence and indeed improved results can be obtained (see Chapter 9). In the above we have referred to the convergence of a given element type as its size is reduced. This is sometimes referred to as h convergence. On the other hand, it is possible to consider a subdivision into elements of a given size and to obtain convergence to the exact solution by increasing the polynomial order p of each element. This is referred to as p convergence, which is obviously assured. In general p convergence is more rapid per degree of freedom introduced. We shall discuss both types further in Chapter 14; although we have already noted in some examples how improved accuracy occurs with higher term polynomials being added at each element level.

76

Generalization of the finite element concepts

Variational principles
3.7 What are ‘variational principles’?
What are variational principles and how can they be useful in the approximation to continuum problems? It is to these questions that the following sections are addressed. First a deﬁnition: a ‘variational principle’ speciﬁes a scalar quantity (functional) , which is deﬁned by an integral form = F u, ∂u ,··· ∂x d + E u, ∂u ,··· ∂x d (3.60)

in which u is the unknown function and F and E are speciﬁed differential operators. The solution to the continuum problem is a function u which makes stationary with respect to arbitrary changes δu. Thus, for a solution to the continuum problem, the ‘variation’ is δ =0 (3.61)

for any δu, which deﬁnes the condition of stationarity.15 If a ‘variational principle’ can be found, then means are immediately established for obtaining approximate solutions in the standard, integral form suitable for ﬁnite element analysis. Assuming a trial function expansion in the usual form [Eq. (3.3)]
n

ˆ u≈u=
a=1

˜ N a ua

we can insert this into Eq. (3.60) and write δ = ∂ ∂ ∂ ˜ ˜ ˜ δ un = 0 δ u1 + δ u2 + · · · + ˜ ˜ ˜ ∂ un ∂ u1 ∂ u2 (3.62)

˜ This being true for any variations δ u yields a set of equations ⎫ ⎧ ⎪∂ ⎪ ⎪ ⎪ ∂u ⎪ ⎪ ⎪ ˜1 ⎪ ⎪ ⎬ ⎨ . ⎪ ∂ . =0 = . ⎪ ⎪ ˜ ∂u ⎪ ⎪ ⎪∂ ⎪ ⎪ ⎪ ⎪ ⎪ ⎭ ⎩ ˜ ∂ un

(3.63)

˜ from which parameters ua are found. The equations are of an integral form necessary for the ﬁnite element approximation as the original speciﬁcation of was given in terms of domain and boundary integrals. ˜ The process of ﬁnding stationarity with respect to trial function parameters u is an old one and is associated with the names of Rayleigh16 and Ritz.17 It has become extremely important in ﬁnite element analysis which, to many investigators, is typiﬁed as a ‘variational process’.

What are ‘variational principles’?

77

If the functional is ‘quadratic’, i.e., if the function u and its derivatives occur in powers not exceeding 2, then Eq. (3.63) reduces to a standard linear form similar to Eq. (3.7), i.e., ∂ ˜ ≡ Ku + f = 0 ˜ ∂u (3.64)

It is easy to show that the matrix K will now always be symmetric. To do this let us ˜ consider a linearization of the vector ∂ /∂ u. This we can write as ⎫ ⎧ ∂ ∂ ∂ ⎪ ∂ ⎬ ⎨ ˜1 + ˜ 2 + · · ·⎪ u u ∂ ˜ ˜ ˜ ˜ ∂ u2 ∂ u 1 ˜ ≡ KT u (3.65) = ∂ u1 ∂ u1 ⎪ ⎪ ˜ ∂u . ⎭ ⎩ . . in which KT is generally known as the tangent matrix, of signiﬁcance in non-linear analysis, ˜ ˜ and u are small incremental changes to u. Now it is easy to see that KTab = ∂2 T = KTba ˜ ˜ ∂ ua ∂ u b (3.66)

Hence KT is symmetric. For a quadratic functional we have, from Eq. (3.64), ∂ ˜ ∂u ˜ =K u with K = KT (3.67)

and hence symmetry must exist. The fact that symmetric matrices will arise whenever a variational principle exists is one of the most important merits of variational approaches for discretization. However, symmetric forms will frequently arise directly from the Galerkin process. In such cases we simply conclude that the variational principle exists but we shall not need to use it directly. Further, the discovery of symmetry from a weighted residual process leads directly to known (or previously unknown) variational principles.18 How then do ‘variational principles’ arise and is it always possible to construct these for continuous problems? To answer the ﬁrst part of the question we note that frequently the physical aspects of the problem can be stated directly in a variational principle form. Theorems such as minimization of total potential energy to achieve equilibrium in mechanical systems, least energy dissipation principles in viscous ﬂow, etc., may be known to the reader and are considered by many as the basis of the formulation. We have already referred to the ﬁrst of these in Sec. 2.4 of Chapter 2. Variational principles of this kind are ‘natural’ ones but unfortunately they do not exist for all continuum problems for which well-deﬁned differential equations may be formulated. However, there is another category of variational principles which we may call ‘contrived’. Such contrived principles can always be constructed for any differentially speciﬁed problem, either by extending the number of unknown functions u by additional variables known as Lagrange multipliers, or by procedures imposing a higher degree of continuity requirements such as in least squares problems. In subsequent sections we shall discuss, respectively, such ‘natural’ and ‘contrived’ variational principles. Before proceeding further it is worth noting that, in addition to symmetry occurring in equations derived by variational means, sometimes further motivation arises. When

78

Generalization of the finite element concepts

‘natural’ variational principles exist the quantity may be of speciﬁc interest itself. If this arises a variational approach possesses the merit of easy evaluation of this functional. The reader will observe that if the functional is ‘quadratic’ and yields Eq. (3.64), then we can write the approximate ‘functional’ simply as
1 ˜ ˜ ˜ = 2 uT K u + u T f

(3.68)

By simple differentiation δ As K is symmetric, ˜ ˜ ˜ ˜ δ uT K u ≡ uT Kδ u Hence δ ˜ which is true for all δ u and hence when inserted into (3.68) we obtain = 1 1 T ˜ ˜ ˜ u f = − uT K u 2 2 ˜ ˜ = δ uT (K u + f ) = 0 ˜ Ku + f = 0
1 ˜ ˜ ˜ 1˜ u = 2 δ(˜ T )K u + 2 uT K δ u + δ uT f = 0

3.8 ‘Natural’ variational principles and their relation to governing differential equations
3.8.1 Euler equations
If we consider the deﬁnitions of Eqs (3.60) and (3.61) we observe that for stationarity we can write, after performing some differentiations and integrations by parts, δ = δuT A(u)d + δuT B(u)d = 0 (3.69)

As the above has to be true for any variations δu, we must have A(u) = 0 in and B(u) = 0 on (3.70)

If A corresponds precisely to the differential equations governing the problem of interest and B to its boundary conditions, then the variational principle is a natural one. Equations (3.70) are known as the Euler differential equations corresponding to the variational principle requiring the stationarity of . It is easy to show that for any variational principle a corresponding set of Euler equations can be established. The reverse is unfortunately not true, i.e., only certain forms of differential equations are Euler equations of a variational functional. In the next section we shall consider the conditions necessary for the existence of variational principles and give a prescription for the establishing from a set of suitable linear differential equations. In this section we shall continue to assume that the form of the variational principle is known.

‘Natural’ variational principles and their relation to governing differential equations

79

To illustrate the process let us now consider a speciﬁc example. Suppose we specify a problem by requiring the stationarity of a functional =
1 k 2

∂φ ∂x

2 1 + 2k

∂φ ∂y

2

+ Qφ d

+
q

¯ qφ d

(3.71)

¯ in which k and Q depend only on position and we assume φ = φ is satisﬁed on φ . 15 We now perform the variation. This can be written following the rules of differentiation as δ As δ = k ∂φ ∂φ δ ∂x ∂x +k ∂φ ∂φ δ ∂y ∂y ∂φ ∂x + Qδφ d ∂ (δφ) ∂x
φ,

+
q

¯ (q δφ) d = 0

(3.72)

=

(3.73) obtain

we can integrate by parts (as in Sec. 3.3) and, since δφ = 0 on δ = +
q

δφ −

∂φ ∂ ∂φ ∂ k − k ∂x ∂x ∂y ∂y ∂φ ¯ δφ k +q d =0 ∂n

+Q d (3.74a)

This is of the form of Eq. (3.69) and we immediately observe that the Euler equations are ∂ ∂φ ∂ ∂φ A(φ) = − k − k +Q=0 in ∂x ∂y ∂y ∂y (3.74b) ∂φ ¯ B(φ) = k +q =0 on q ∂n ¯ If φ is prescribed so that φ = φ on φ and δφ = 0 on that boundary, then the problem is precisely the one we have already discussed in Sec. 3.2 and the functional (3.71) speciﬁes the two-dimensional heat conduction problem in an alternative way. In this case we have ‘guessed’ the functional but the reader will observe that the variation operation could have been carried out for any functional speciﬁed and corresponding Euler equations could have been established. Let us continue the process to obtain an approximate solution of the linear heat conduction problem. Taking, as usual, ˜ ˆ ˜ φ≈φ= Na φa = N φ (3.75)
a

we substitute this approximation into the expression for the functional obtain = + 1 k 2 Q
a

[Eq. (3.71)] and
2

a

∂Na ˜ φa ∂x ˜ Na φa d

2

d +

+ ¯ q
q

1 k 2
a

a

∂Na ˜ φa ∂y

d (3.76)

˜ N a φa d

80

Generalization of the finite element concepts

˜ On differentiation with respect to a typical parameter φb we have ∂ = ˜ ∂ φb + k
a

∂Na ˜ ∂Nb φa d ∂x ∂x +
q

+

k
a

∂Na ˜ ∂Nb φa d ∂y ∂y

(3.77)

QNb d

¯ qNb d = 0

and a system of equations for the solution of the problem is ˜ Kφ + f = 0 with Kab = Kba = fb = Nb Q d k ∂Na ∂Nb d ∂x ∂x +
q

(3.78) ∂Na ∂Nb d ∂y ∂y

+

k

(3.79)

¯ Nb q d

The reader will observe that the approximation equations are here identical with those obtained in Sec. 3.5 for the same problem using the Galerkin process. No special advantage accrues to the variational formulation here, and indeed we can predict now that Galerkin and variational procedures must give the same answer for cases where natural variational principles exist.

3.8.2 Relation of the Galerkin method to approximation via variational principles
In the preceding example we have observed that the approximation obtained by the use of a natural variational principle and by the use of the Galerkin weighting process proved identical. That this is the case follows directly from Eq. (3.69), in which the variation was derived in terms of the original differential equations and the associated boundary conditions. If we consider the usual trial function expansion [Eq. (3.3)] ˆ ˜ u ≈ u = Nu we can write the variation of this approximation as ˆ ˜ δu = N δu and inserting the above into (3.69) yields δ ˜ = δ uT ˜ NT A(Nu) d ˜ + δ uT ˜ NT B(Nu) d = 0 (3.81) (3.80)

˜ The above form, being true for all δ u, requires that the expression under the integrals should be zero. The reader will immediately recognize this as simply the Galerkin form of the weighted residual statement discussed earlier [Eq. (3.22)], and identity is hereby proved. We need to underline, however, that this is only true if the Euler equations of the variational principle coincide with the governing equations of the original problem. The Galerkin process thus retains its greater range of applicability.

Establishment of natural variational principles for linear, self-adjoint, differential equations

81

3.9 Establishment of natural variational principles for linear, self-adjoint, differential equations
General rules for deriving natural variational principles from non-linear differential equations are complicated and even the tests necessary to establish the existence of such variational principles are not simple. Much mathematical work has been done in this context by Vainberg,19 Tonti,18 Oden,20, 21 and others. For linear differential equations the situation is much simpler and a thorough study is available in the works of Mikhlin,22, 23 and in this section a brief presentation of such rules is given. We shall consider here only the establishment of variational principles for a linear system of equations with forced boundary conditions, implying only variation of functions which yield δu = 0 on their boundaries. The extension to include natural boundary conditions is simple and will be omitted. Writing a linear system of differential equations as A(u) ≡ Lu + b = 0 (3.82)

in which L is a linear differential operator it can be shown that natural variational principles require that the operator L be such that ψ T (Lγ) d = γ T (Lψ) d + b.t. (3.83)

for any two function sets ψ and γ. In the above, ‘b.t.’ stands for boundary terms which we disregard in the present context. The property required in the above operator is called that of self-adjointness or symmetry. If the operator L is self-adjoint, the variational principle can be written immediately as =
1 T u 2

(Lu) + uT b d

+ b.t.

(3.84)

To prove the veracity of the last statement a variation needs to be considered. We thus write (omitting boundary terms) δ =
1 1 [ 2 δuT Lu + 2 uT δ(Lu) + δuT b] d

=0

(3.85)

Noting that for any linear operator δ(Lu) ≡ L δu (3.86)

and that u and δu can be treated as any two independent functions, by identity (3.83) we can write Eq. (3.85) as δ = δuT [Lu + b] d =0 (3.87)

We observe immediately that the term in the brackets, i.e., the Euler equation of the functional, is identical with the original equation postulated, and therefore the variational principle is veriﬁed.

82

Generalization of the finite element concepts

The above gives a very simple test and a prescription for the establishment of natural variational principles for differential equations of the problem. Example 3.9: Helmholz problem in two dimensions. A Helmholz problem is governed by a differential equation similar to the heat conduction equation, e.g., ∇ 2φ + c φ + Q = 0 with c and Q being dependent on position only. The above can be written in the general form of Eq. (3.82), with L= ∂2 ∂2 + 2 +c ; ∂x 2 ∂y b=Q and u=φ (3.89) (3.88)

Verifying that self-adjointness applies (which we leave to the reader as an exercise), we immediately have a variational principle = 1 φ 2 ∂ 2φ ∂ 2φ + 2 + cφ ∂x 2 ∂y + φQ dx dy
φ.

(3.90)

¯ with φ satisfying the forced boundary condition, i.e., φ = φ on the ﬁrst two terms results in =− 1 2 ∂φ ∂x
2

Integrating by parts of

+

1 2

∂φ ∂y

2

−

1 c φ 2 − φQ dx dy 2

(3.91)

on noting that boundary terms with prescribed φ do not alter the principle. Example 3.10: First-order form of heat equation. This problem concerns the onedimensional heat conduction equation (Example 3.5, Sec. 3.3) written in ﬁrst order form as ⎧ ⎫ ⎪ ⎪−q − dφ ⎪ ⎪ ⎨ ⎬ dx A(u) = =0 ⎪ dq ⎪ ⎪ ⎩ ⎭ +Q⎪ dx or, using Eq. (3.82), as ⎡ ⎤ d −1, − ⎥ 0 q ⎢ dx ⎥ L≡⎢ ; b= and u = ⎣d ⎦ Q φ , 0 dx Again self-adjointness of the operator can be tested and found to be satisﬁed. We now write the functional as ⎡ ⎛⎡ ⎤ ⎤ ⎞ d −1, − ⎥ T ⎢ 1 q T ⎜⎢ 0 ⎥ q dx ⎥ q ⎟ ⎢ ⎜⎢ ⎥ dx ⎟ = ⎣ 2 φ ⎝⎣ d ⎦ φ ⎠+ φ Q ⎦ , 0 (3.92) dx = 1 2 −q 2 − q dq dφ +φ dx dx + φQ dx

Maximum, minimum, or a saddle point?
Π d2Π da2 A d2Π da2 d2Π <0 da2 A a =0
A

83

>0
A

Fig. 3.10 Maximum, minimum and a ‘saddle’ point for a functional

of one variable.

The veriﬁcation of the correctness of the above, by executing a variation, is left to the reader. These two examples illustrate the simplicity of application of the general expressions. The reader will observe that self-adjointness of the operator will generally exist if even orders of differentiation are present. For odd orders self-adjointness is only possible if the operator is a ‘skew’-symmetric matrix such as occurs in the second example.

3.10 Maximum, minimum, or a saddle point?
In discussing variational principles so far we have assumed simply that at the solution point δ = 0, that is the functional is stationary. It is often desirable to know whether is at a maximum, minimum, or simply at a ‘saddle point’. If a maximum or a minimum is involved, then the approximation to will always be ‘bounded’, i.e., will provide approximate values of which are either smaller or larger than the correct ones.† The bound in itself may be of practical signiﬁcance in some problems. When, in elementary calculus, we consider a stationary point of a function of one variable u, we investigate the rate of change of d with du and write d(d ) = d ∂ du ∂u = ∂2 (du)2 ∂u2 (3.93)

The sign of the second derivative determines whether is a minimum, maximum, or simply stationary (saddle point), as shown in Fig. 3.10. By analogy in the calculus of variations we shall consider changes of δ . Noting the general form of this quantity given by Eq. (3.62) and the notion of the second derivative of Eq. (3.65) we can write, in terms of discrete parameters, δ(δ ) ≡ δ ∂ ˜ ∂u
T

˜ ˜ δ u = δ uT δ

∂ ˜ ∂u

˜ = δ uT

∂2 ˜ δu ˜ ˜ ∂u ∂u

˜ ˜ = δ uT KT δ u

(3.94)

If, in the above, δ(δ ) is always negative then is obviously reaching a maximum, if it is always positive then is a minimum, but if the sign is indeterminate this shows only the existence of a saddle point.
† Provided all integrals are exactly evaluated.

84

Generalization of the finite element concepts

˜ As δ u is an arbitrary vector this statement is equivalent to requiring the matrix KT to be negative deﬁnite for a maximum or positive deﬁnite for a minimum. The form of the matrix KT (or in linear problems of K which is identical to it) is thus of great importance in the solution of variational problems.

3.11 Constrained variational principles. Lagrange multipliers
3.11.1 Lagrange multipliers
Consider the problem of making a functional stationary, subject to the unknown u obeying some set of additional differential relationships C(u) = 0 in (3.95)

We can introduce this constraint by forming another functional ¯ (u, λ) = (u) + λT C(u) d (3.96) known

in which λ is some set of functions of the independent coordinates in the domain as Lagrange multipliers. The variation of the new functional is now δ¯ =δ + λT δC(u) d + δλT C(u) d =0

(3.97)

which immediately gives C(u) = 0 and, simultaneously, an added contribution to the original δ involving λ. In a similar way, constraints can be introduced at some points or over boundaries of the domain. For instance, if we require that u obey E(u) = 0 we would add to the original functional the term λT E(u) d (3.99) on (3.98)

with λ now being an unknown function deﬁned only on . Alternatively, if the constraint C is applicable only at one or more points of the system, then the simple addition of λT C(u) at these points to the general functional will introduce a discrete number of constraints. It appears, therefore, possible to always introduce additional functions λ and modify a functional to include any prescribed constraints. In the ‘discretization’ process we shall now have to use trial functions to describe both u and λ. Writing, for instance, ˆ u=
a

˜ ˜ N a ua = N u

ˆ λ=
b

¯˜ ¯ ˜ Nb λb = Nλ

(3.100)

Constrained variational principles. Lagrange multipliers

85

we shall obtain a set of equations ⎧ ⎫ ⎪∂ ⎪ ⎪ ⎨ ∂u ⎪ ˜⎬ ∂ = =0 ⎪∂ ⎪ ∂w ⎪ ⎪ ⎩ ⎭ ˜ ∂λ

where

w=

˜ u ˜ λ

(3.101)

˜ ˜ from which both the sets of parameters u and λ can be obtained. It is somewhat paradoxical that the ‘constrained’ problem has resulted in a larger number of unknown parameters than the original one and, indeed, has complicated the solution. We shall, nevertheless, ﬁnd practical use for Lagrange multipliers in formulating some physical variational principles, and will make use of these in a more general context in Chapters 10 and 11. Before proceeding further it is of interest to investigate the form of equations resulting from the modiﬁed functional of Eq. (3.96). If the original functional gave as its Euler equations a system A(u) = 0 (3.102) then we have (omitting the boundary terms) δ¯ = δuT A(u) d + δCT λ d + δλT C(u) d =0 (3.103)

Substituting the trial functions (3.100) we can write for a linear set of constraints C(u) = L1 u + C1 that ˜ δ ¯ = δ uT ˜ + δλ
T

ˆ NT A(u) d

+

ˆ (L1 N)T λ d (3.104) =0

¯ ˆ NT (L1 u + C1 ) d

˜ ˜ As this has to be true for all variations δ u and δ λ, we have a system of equations ˆ NT A(u) d + ˆ (L1 N)T λ d =0 (3.105) ¯ ˆ NT (L1 u + C1 ) d =0

For linear equations A, the ﬁrst term of the ﬁrst equation is precisely the ordinary, unconstrained, variational approximation ˜ Kuu u + fu (3.106)

and inserting again the trial functions (3.100) we can write the approximated Eq. (3.105) as a linear system: ˜ u fu Kuu , Kuλ Kw w = (3.107) T ˜ + fλ = 0 Kuλ , 0 λ with
T Kuλ =

¯ NT (L1 N) d ;

fλ =

¯ N T C1 d

(3.108)

86

Generalization of the finite element concepts

Clearly the system of equations is symmetric but now possesses zeros on the diagonal, and therefore the variational principle is merely stationary. Further, computational difﬁculties may be encountered unless the solution process allows for zero diagonal terms. Example 3.11: Constraint enforcement using Lagrange multiplier. The point about increasing the number of parameters to introduce a constraint may perhaps be best illustrated in a simple algebraic situation in which we require a stationary value of a quadratic function of two variables u1 and u2 : = 2u2 − 2u1 u2 + u2 + 18u1 + 6u2 1 2 subject to a constraint u1 − u2 = 0 (3.110) (3.109)

The obvious way to proceed would be to insert directly the equality ‘constraint’ and obtain = u2 + 24u1 1 and write, for stationarity, ∂ = 0 = 2u1 + 24 ∂u1 u1 = u2 = −12 (3.112) (3.111)

Introducing a Lagrange multiplier λ we can alternatively ﬁnd the stationarity of ¯ = 2u2 − 2u1 u2 + u2 + 18u1 + 6u2 + λ(u1 − u2 ) 1 2 and write three simultaneous equations ∂¯ = 4u1 − 2u2 + λ + 18 = 0 ∂u1 ∂¯ = −2u1 + 2u2 − λ + 6 = 0 ∂u2 ∂¯ = u1 − u2 = 0 ∂λ The solution of the above system again yields the correct answer u1 = u2 = −12 λ=6 (3.113)

(3.114)

but at considerably more effort. Unfortunately, in most continuum problems direct elimination of constraints cannot be so simply accomplished.†
† In the ﬁnite element context, Szabo and Kassos24 use such direct elimination; however, this involves considerable algebraic manipulation.

Constrained variational principles. Lagrange multipliers

87

3.11.2 Identification of Lagrange multipliers. Forced boundary conditions and modified variational principles
Although the Lagrange multipliers were introduced as a mathematical concept necessary for the enforcement of certain external constraints required to satisfy the original variational principle, we shall ﬁnd that in many situations they can be identiﬁed with certain physical quantities of importance to the original mathematical model. Such an identiﬁcation will follow immediately from the deﬁnition of the variational principle established in Eq. (3.96) and through the ﬁrst of the Euler equations in (3.105) corresponding to it. The variation δ ¯ , written in Eq. (3.97), supplies through its third term the constraint equation. The ﬁrst two terms can always be rewritten as δC(u)T λ d or δE(u)T λ d + δuT B(u) d = 0 (3.115b) This supplies the identiﬁcation of λ. In the literature of variational calculation such identiﬁcation arises frequently and the reader is referred to the excellent text by Washizu25 for numerous examples. Example 3.12: Identiﬁcation of Lagrange multiplier for boundary condition. Here we shall introduce this identiﬁcation by means of the example considered in Sec. 3.8.1. As we have noted, the variational principle of Eq. (3.71) established the governing equation and the natural boundary conditions of the heat conduction problem providing the forced boundary condition ¯ E(φ) = φ − φ = 0 (3.116) was satisﬁed on φ in the choice of the trial function for φ. The above forced boundary condition can, however, be considered as a constraint on the original problem. We can write the constrained variational principle as ¯ = where is given by Eq. (3.71). Performing the variation we have δ¯ =δ δ +
φ

+

δuT A(u) d

=0

(3.115a)

+
φ

¯ λ(φ − φ) d

(3.117)

δφλ d +
φ

¯ δλ(φ − φ) d = 0

(3.118)

is now given by the expression (3.74a) augmented by an integral δφ k
φ

∂φ d ∂n
φ ).

(3.119) In addition to

which was previously disregarded (as we had assumed that δφ = 0 on the conditions of Eq. (3.74b), we now require that ¯ δλ(φ − φ) d +
φ φ

δφ λ + k

∂φ d =0 ∂n

(3.120)

88

Generalization of the finite element concepts

which must be true for all variations δλ and δφ. The ﬁrst simply reiterates the constraint ¯ φ−φ =0 The second deﬁnes λ as on
φ

(3.121)

∂φ ∂n Noting that k(∂φ/∂n) is the negative to the ﬂux qn on the boundary identiﬁcation of the multiplier has been achieved – that is, λ ≡ qn . λ = −k

(3.122)
φ,

the physical

The identiﬁcation of the Lagrange variable leads to the possible establishment of a modiﬁed variational principle in which λ is replaced by the identiﬁcation. We could thus write a new principle for the above example: ¯ = −
φ

k

∂φ ¯ (φ − φ) d ∂n

(3.123)

in which once again is given by the expression (3.71) but φ is not constrained to satisfy any boundary conditions. Use of such modiﬁed variational principles can be made to restore interelement continuity and appears to have been ﬁrst introduced for that purpose by Kikuchi and Ando.26 In general these present interesting new procedures for establishing useful variational principles. A further extension of such principles has been made use of by Chen and Mei27 and Zienkiewicz et al.28 Washizu25 discusses many such applications in the context of structural mechanics. The reader can verify that the variational principle expressed in Eq. (3.123) leads to automatic satisfaction of all the necessary boundary conditions in the example considered. The use of modiﬁed variational principles restores the problem to the original number of unknown functions or parameters and is often computationally advantageous.

3.12 Constrained variational principles. Penalty function and perturbed lagrangian methods
In the previous section we have seen how the process of introducing Lagrange multipliers allows constrained variational principles to be obtained at the expense of increasing the total number of unknowns. Further, we have shown that even in linear problems the algebraic equations which have to be solved are now complicated by having zero diagonal terms. In this section we shall consider alternative procedures of introducing constraints which do not possess these drawbacks.

3.12.1 Penalty functions
Considering once again the problem of obtaining stationarity of equations C(u) = 0 in domain , we note that the product
2 2 CT C = C1 + C2 + · · ·

with a set of constraint

(3.124)

Constrained variational principles. Penalty function and perturbed lagrangian methods

89

where CT = [C1 , C2 , . . .] must always be a quantity which is positive or zero. Clearly, the latter value is found when the constraints are satisﬁed and also clearly the variation δ(CT C) = 0 as the product reaches that minimum. We can now write a new functional ¯ = + 1 α 2 CT (u)C(u) d (3.126) (3.125)

in which α is a ‘penalty number’ and then require the stationarity for the constrained solution. If is itself a minimum of the solution then α should be a positive number. The solution obtained by the stationarity of the functional ¯ will satisfy the constraints only approximately. The larger the value of α the better will be the constraints achieved. Further, it seems obvious that the process is best suited to cases where is a minimum (or maximum) principle, but success can be obtained even with purely saddle point problems. The process is equally applicable to constraints applied on boundaries or simple discrete constraints. In this latter case integration is dropped.

3.12.2 Perturbed lagrangian
We consider once again the problem of obtaining stationarity of with a set of constraint equations C(u) = 0 in domain . The Lagrange multiplier form to embed the constraint is given in Eq. (3.96). Here we modify the expression by appending a quadratic term of the form λT λ scaled by a parameter α. The form of the ﬁnal equation is given by ˘ (u, λ) = (u) + λT C(u) d − 1 2α λT λ d (3.127)

We note that as the parameter α tends toward inﬁnity the form approaches a Lagrange multiplier form. Accordingly, this form is called a perturbed lagrangian functional. Taking the variation we obtain the result δ˘ =δ + λT δC(u) d + δλT C(u) d − 1 α δλT λ d =0 (3.128)

If the constraints are a linear form given by C(u) = C0 u we can introduce the approximations (3.100) into (3.128) to obtain the set of equations Kuu Kλu Kuλ 1 − α Kλλ and and Kλλ = ¯ ¯ NT N d ˜ u ˜ λ = f 0 (3.129)

where Kuu is the coefﬁcient array from δ Kuλ = ¯ N T C0 d

