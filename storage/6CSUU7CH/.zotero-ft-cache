The Finite Element Method Fifth edition Volume 1: The Basis

Professor O.C. Zienkiewicz, CBE, FRS, FREng is Professor Emeritus and Director of the Institute for Numerical Methods in Engineering at the University of Wales, Swansea, UK. He holds the UNESCO Chair of Numerical Methods in Engineering at the Technical University of Catalunya, Barcelona, Spain. He was the head of the Civil Engineering Department at the University of Wales Swansea between 1961 and 1989. He established that department as one of the primary centres of ®nite element research. In 1968 he became the Founder Editor of the International Journal for Numerical Methods in Engineering which still remains today the major journal in this ®eld. The recipient of 24 honorary degrees and many medals, Professor Zienkiewicz is also a member of ®ve academies ± an honour he has received for his many contributions to the fundamental developments of the ®nite element method. In 1978, he became a Fellow of the Royal Society and the Royal Academy of Engineering. This was followed by his election as a foreign member to the U.S. Academy of Engineering (1981), the Polish Academy of Science (1985), the Chinese Academy of Sciences (1998), and the National Academy of Science, Italy (Academia dei Lincei) (1999). He published the ®rst edition of this book in 1967 and it remained the only book on the subject until 1971. Professor R.L. Taylor has more than 35 years' experience in the modelling and simulation of structures and solid continua including two years in industry. In 1991 he was elected to membership in the U.S. National Academy of Engineering in recognition of his educational and research contributions to the ®eld of computational mechanics. He was appointed as the T.Y. and Margaret Lin Professor of Engineering in 1992 and, in 1994, received the Berkeley Citation, the highest honour awarded by the University of California, Berkeley. In 1997, Professor Taylor was made a Fellow in the U.S. Association for Computational Mechanics and recently he was elected Fellow in the International Association of Computational Mechanics, and was awarded the USACM John von Neumann Medal. Professor Taylor has written several computer programs for ®nite element analysis of structural and non-structural systems, one of which, FEAP, is used world-wide in education and research environments. FEAP is now incorporated more fully into the book to address non-linear and ®nite deformation problems.

Front cover image: A Finite Element Model of the world land speed record (765.035 mph) car THRUST SSC. The analysis was done using the ®nite element method by K. Morgan, O. Hassan and N.P. Weatherill at the Institute for Numerical Methods in Engineering, University of Wales Swansea, UK. (see K. Morgan, O. Hassan and N.P. Weatherill, `Why didn't the supersonic car ¯y?', Mathematics Today, Bulletin of the Institute of Mathematics and Its Applications, Vol. 35, No. 4, 110±114, Aug. 1999).

The Finite Element Method
Fifth edition

Volume 1: The Basis
UNESCO Professor of Numerical Methods in Engineering International Centre for Numerical Methods in Engineering, Barcelona Emeritus Professor of Civil Engineering and Director of the Institute for Numerical Methods in Engineering, University of Wales, Swansea

O.C. Zienkiewicz, CBE, FRS, FREng

Professor in the Graduate School Department of Civil and Environmental Engineering University of California at Berkeley Berkeley, California

R.L. Taylor

OXFORD AUCKLAND BOSTON JOHANNESBURG MELBOURNE NEW DELHI

Butterworth-Heinemann Linacre House, Jordan Hill, Oxford OX2 8DP 225 Wildwood Avenue, Woburn, MA 01801-2041 A division of Reed Educational and Professional Publishing Ltd

First published in 1967 by McGraw-Hill Fifth edition published by Butterworth-Heinemann 2000 # O.C. Zienkiewicz and R.L. Taylor 2000
All rights reserved. No part of this publication may be reproduced in any material form (including photocopying or storing in any medium by electronic means and whether or not transiently or incidentally to some other use of this publication) without the written permission of the copyright holder except in accordance with the provisions of the Copyright, Designs and Patents Act 1988 or under the terms of a licence issued by the Copyright Licensing Agency Ltd, 90 Tottenham Court Road, London, England W1P 9HE. Applications for the copyright holder's written permission to reproduce any part of this publication should be addressed to the publishers

British Library Cataloguing in Publication Data A catalogue record for this book is available from the British Library Library of Congress Cataloguing in Publication Data A catalogue record for this book is available from the Library of Congress ISBN 0 7506 5049 4 Published with the cooperation of CIMNE, the International Centre for Numerical Methods in Engineering, Barcelona, Spain (www.cimne.upc.es)

Typeset by Academic & Technical Typesetting, Bristol Printed and bound by MPG Books Ltd

Dedication This book is dedicated to our wives Helen and Mary Lou and our families for their support and patience during the preparation of this book, and also to all of our students and colleagues who over the years have contributed to our knowledge of the ®nite element method. In particular we would like to mention Professor Eugenio Onate and his group at CIMNE for Ä their help, encouragement and support during the preparation process.

Contents

Preface 1. Some 1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 preliminaries: the standard discrete system Introduction The structural element and the structural system Assembly and analysis of a structure The boundary conditions Electrical and ¯uid networks The general pattern The standard discrete system Transformation of coordinates References

xv 1 1 4 8 9 10 12 14 15 16 18 18 19 26 29 31 32 33 34 35 35 37 37 39 39 42 46 53

2.

A direct approach to problems in elasticity 2.1 Introduction 2.2 Direct formulation of ®nite element characteristics 2.3 Generalization to the whole region 2.4 Displacement approach as a minimization of total potential energy 2.5 Convergence criteria 2.6 Discretization error and convergence rate 2.7 Displacement functions with discontinuity between elements 2.8 Bound on strain energy in a displacement formulation 2.9 Direct minimization 2.10 An example 2.11 Concluding remarks References Generalization of the ®nite element concepts. Galerkin-weighted residual and variational approaches 3.1 Introduction 3.2 Integral or `weak' statements equivalent to the dierential equations 3.3 Approximation to integral formulations 3.4 Virtual work as the `weak form' of equilibrium equations for analysis of solids or ¯uids

3.

viii Contents

3.5 3.6 3.7 3.8 3.9 3.10 3.11 3.12 3.13 4. Plane 4.1 4.2 4.3 4.4 4.5 4.6

Partial discretization Convergence What are `variational principles'? `Natural' variational principles and their relation to governing dierential equations Establishment of natural variational principles for linear, self-adjoint dierential equations Maximum, minimum, or a saddle point? Constrained variational principles. Lagrange multipliers and adjoint functions Constrained variational principles. Penalty functions and the least square method Concluding remarks References stress and plane strain Introduction Element characteristics Examples ± an assessment of performance Some practical applications Special treatment of plane strain with an incompressible material Concluding remark References

55 58 60 62 66 69 70 76 82 84 87 87 87 97 100 110 111 111 112 112 112 121 123 124 124 126 127 127 128 134 135 139 140 140 141 143 144 146 149

5.

Axisymmetric stress analysis 5.1 Introduction 5.2 Element characteristics 5.3 Some illustrative examples 5.4 Early practical applications 5.5 Non-symmetrical loading 5.6 Axisymmetry ± plane strain and plane stress References Three-dimensional stress analysis 6.1 Introduction 6.2 Tetrahedral element characteristics 6.3 Composite elements with eight nodes 6.4 Examples and concluding remarks References Steady-state ®eld problems ± heat conduction, electric and magnetic potential, ¯uid ¯ow, etc. 7.1 Introduction 7.2 The general quasi-harmonic equation 7.3 Finite element discretization 7.4 Some economic specializations 7.5 Examples ± an assessment of accuracy 7.6 Some practical applications

6.

7.

Contents ix

7.7 8.

Concluding remarks References

161 161 164 164 165 168 171 172 174 177 179 183 184 185 186 190 190 193 193 196 197 198 198 200 200 203 206 206 208 211 213 217 219 221 223 226 229 234

`Standard' and `hierarchical' element shape functions: some general families of C0 continuity 8.1 Introduction 8.2 Standard and hierarchical concepts 8.3 Rectangular elements ± some preliminary considerations 8.4 Completeness of polynomials 8.5 Rectangular elements ± Lagrange family 8.6 Rectangular elements ± `serendipity' family 8.7 Elimination of internal variables before assembly ± substructures 8.8 Triangular element family 8.9 Line elements 8.10 Rectangular prisms ± Lagrange family 8.11 Rectangular prisms ± `serendipity' family 8.12 Tetrahedral elements 8.13 Other simple three-dimensional elements 8.14 Hierarchic polynomials in one dimension 8.15 Two- and three-dimensional, hierarchic, elements of the `rectangle' or `brick' type 8.16 Triangle and tetrahedron family 8.17 Global and local ®nite element approximation 8.18 Improvement of conditioning with hierarchic forms 8.19 Concluding remarks References Mapped elements and numerical integration ± `in®nite' and `singularity' elements 9.1 Introduction 9.2 Use of `shape functions' in the establishment of coordinate transformations 9.3 Geometrical conformability of elements 9.4 Variation of the unknown function within distorted, curvilinear elements. Continuity requirements 9.5 Evaluation of element matrices (transformation in , ,  coordinates) 9.6 Element matrices. Area and volume coordinates 9.7 Convergence of elements in curvilinear coordinates 9.8 Numerical integration ± one-dimensional 9.9 Numerical integration ± rectangular (2D) or right prism (3D) regions 9.10 Numerical integration ± triangular or tetrahedral regions 9.11 Required order of numerical integration 9.12 Generation of ®nite element meshes by mapping. Blending functions 9.13 In®nite domains and in®nite elements 9.14 Singular elements by mapping for fracture mechanics, etc.

9.

x Contents

9.15 9.16 9.17 9.18

A computational advantage of numerically integrated ®nite elements Some practical examples of two-dimensional stress analysis Three-dimensional stress analysis Symmetry and repeatability References

236 237 238 244 246 250 250 251 253 255 257 257 258 264 268 270 271 273 274 276 276 278 280 284 291 298 301 304 304 307 307 307 308 314 318 323

10. The patch test, reduced integration, and non-conforming elements 10.1 Introduction 10.2 Convergence requirements 10.3 The simple patch test (tests A and B) ± a necessary condition for convergence 10.4 Generalized patch test (test C) and the single-element test 10.5 The generality of a numerical patch test 10.6 Higher order patch tests 10.7 Application of the patch test to plane elasticity elements with `standard' and `reduced' quadrature 10.8 Application of the patch test to an incompatible element 10.9 Generation of incompatible shape functions which satisfy the patch test 10.10 The weak patch test ± example 10.11 Higher order patch test ± assessment of robustness 10.12 Conclusion References 11. Mixed formulation and constraints± complete ®eld methods 11.1 Introduction 11.2 Discretization of mixed forms ± some general remarks 11.3 Stability of mixed approximation. The patch test 11.4 Two-®eld mixed formulation in elasticity 11.5 Three-®eld mixed formulations in elasticity 11.6 An iterative method solution of mixed approximations 11.7 Complementary forms with direct constraint 11.8 Concluding remarks ± mixed formulation or a test of element `robustness' References 12. Incompressible materials, mixed methods and other procedures of solution 12.1 Introduction 12.2 Deviatoric stress and strain, pressure and volume change 12.3 Two-®eld incompressible elasticity (u±p form) 12.4 Three-®eld nearly incompressible elasticity (u±p±"v form) 12.5 Reduced and selective integration and its equivalence to penalized mixed problems 12.6 A simple iterative solution process for mixed problems: Uzawa method

Contents xi

12.7 12.8

Stabilized methods for some mixed elements failing the incompressibility patch test Concluding remarks References

326 342 343 346 346 346 349 350 355 360 361 361 362 365 365 370 375 377 383 385 387 392 398 398 401 401 404 415 426 426 429 429 431 438 443 446

13. Mixed formulation and constraints ± incomplete (hybrid) ®eld methods, boundary/Tretz methods 13.1 General 13.2 Interface traction link of two (or more) irreducible form subdomains 13.3 Interface traction link of two or more mixed form subdomains 13.4 Interface displacement `frame' 13.5 Linking of boundary (or Tretz)-type solution by the `frame' of speci®ed displacements 13.6 Subdomains with `standard' elements and global functions 13.7 Lagrange variables or discontinuous Galerkin methods? 13.8 Concluding remarks References 14. Errors, recovery processes and error estimates 14.1 De®nition of errors 14.2 Superconvergence and optimal sampling points 14.3 Recovery of gradients and stresses 14.4 Superconvergent patch recovery ± SPR 14.5 Recovery by equilibration of patches ± REP 14.6 Error estimates by recovery 14.7 Other error estimators ± residual based methods 14.8 Asymptotic behaviour and robustness of error estimators ± the BabusÏ ka patch test 14.9 Which errors should concern us? References 15. Adaptive ®nite element re®nement 15.1 Introduction 15.2 Some examples of adaptive h-re®nement 15.3 p-re®nement and hp-re®nement 15.4 Concluding remarks References 16. Point-based approximations; element-free Galerkin ± and other meshless methods 16.1 Introduction 16.2 Function approximation 16.3 Moving least square approximations ± restoration of continuity of approximation 16.4 Hierarchical enhancement of moving least square expansions 16.5 Point collocation ± ®nite point methods

xii Contents

16.6 16.7 16.8

Galerkin weighting and ®nite volume methods Use of hierarchic and special functions based on standard ®nite elements satisfying the partition of unity requirement Closure References

451 457 464 464 468 468 468 476 477 484 484 485 486 490 491 493 493 495 508 522 530 536 538 538 542 542 545 558 565 567 572 576 576 578 588 590 597

17. The time dimension ± semi-discretization of ®eld and dynamic problems and analytical solution procedures 17.1 Introduction 17.2 Direct formulation of time-dependent problems with spatial ®nite element subdivision 17.3 General classi®cation 17.4 Free response ± eigenvalues for second-order problems and dynamic vibration 17.5 Free response ± eigenvalues for ®rst-order problems and heat conduction, etc. 17.6 Free response ± damped dynamic eigenvalues 17.7 Forced periodic response 17.8 Transient response by analytical procedures 17.9 Symmetry and repeatability References 18. The time dimension ± discrete approximation in time 18.1 Introduction 18.2 Simple time-step algorithms for the ®rst-order equation 18.3 General single-step algorithms for ®rst- and second-order equations 18.4 Multistep recurrence algorithms 18.5 Some remarks on general performance of numerical algorithms 18.6 Time discontinuous Galerkin approximation 18.7 Concluding remarks References 19. Coupled systems 19.1 Coupled problems ± de®nition and classi®cation 19.2 Fluid±structure interaction (Class I problem) 19.3 Soil±pore ¯uid interaction (Class II problems) 19.4 Partitioned single-phase systems ± implicit±explicit partitions (Class I problems) 19.5 Staggered solution processes References 20. Computer procedures for ®nite element analysis 20.1 Introduction 20.2 Data input module 20.3 Memory management for array storage 20.4 Solution module ± the command programming language 20.5 Computation of ®nite element solution modules

Contents

xiii

Solution of simultaneous linear algebraic equations Extension and modi®cation of computer program FEAPpv References Appendix A: Matrix algebra Appendix B: Tensor-indicial notation in the approximation of elasticity problems Appendix C: Basic equations of displacement analysis Appendix D: Some integration formulae for a triangle Appendix E: Some integration formulae for a tetrahedron Appendix F: Some vector algebra Appendix G: Integration by parts in two and three dimensions (Green's theorem) Appendix H: Solutions exact at nodes Appendix I: Matrix diagonalization or lumping Author index Subject index

20.6 20.7

609 618 618 620 626 635 636 637 638 643 645 648 655 663

Volume 2: Solid and structural mechanics
1. 2. 3. 4. 5. 6. 7. 8. 9. 10. 11. 12. 13. General problems in solid mechanics and non-linearity Solution of non-linear algebraic equations Inelastic materials Plate bending approximation: thin (Kirchho) plates and C1 continuity requirements `Thick' Reissner±Mindlin plates ± irreducible and mixed formulations Shells as an assembly of ¯at elements Axisymmetric shells Shells as a special case of three-dimensional analysis ± Reissner±Mindlin assumptions Semi-analytical ®nite element processes ± use of orthogonal functions and `®nite strip' methods Geometrically non-linear problems ± ®nite deformation Non-linear structural problems ± large displacement and instability Pseudo-rigid and rigid±¯exible bodies Computer procedures for ®nite element analysis Appendix A: Invariants of second-order tensors

Volume 3: Fluid dynamics
1. Introduction and the equations of ¯uid dynamics 2. Convection dominated problems ± ®nite element approximations 3. A general algorithm for compressible and incompressible ¯ows ± the characteristic based split (CBS) algorithm 4. Incompressible laminar ¯ow ± newtonian and non-newtonian ¯uids 5. Free surfaces, buoyancy and turbulent incompressible ¯ows 6. Compressible high speed gas ¯ow 7. Shallow-water problems 8. Waves 9. Computer implementation of the CBS algorithm Appendix A. Non-conservative form of Navier±Stokes equations Appendix B. Discontinuous Galerkin methods in the solution of the convection± diusion equation Appendix C. Edge-based ®nite element formulation Appendix D. Multi grid methods Appendix E. Boundary layer ± inviscid ¯ow coupling

Preface

It is just over thirty years since The Finite Element Method in Structural and Continuum Mechanics was ®rst published. This book, which was the ®rst dealing with the ®nite element method, provided the base from which many further developments occurred. The expanding research and ®eld of application of ®nite elements led to the second edition in 1971, the third in 1977 and the fourth in 1989 and 1991. The size of each of these volumes expanded geometrically (from 272 pages in 1967 to the fourth edition of 1455 pages in two volumes). This was necessary to do justice to a rapidly expanding ®eld of professional application and research. Even so, much ®ltering of the contents was necessary to keep these editions within reasonable bounds. It seems that a new edition is necessary every decade as the subject is expanding and many important developments are continuously occurring. The present ®fth edition is indeed motivated by several important developments which have occurred in the 90s. These include such subjects as adaptive error control, meshless and point based methods, new approaches to ¯uid dynamics, etc. However, we feel it is important not to increase further the overall size of the book and we therefore have eliminated some redundant material. Further, the reader will notice the present subdivision into three volumes, in which the ®rst volume provides the general basis applicable to linear problems in many ®elds whilst the second and third volumes are devoted to more advanced topics in solid and ¯uid mechanics, respectively. This arrangement will allow a general student to study Volume 1 whilst a specialist can approach their topics with the help of Volumes 2 and 3. Volumes 2 and 3 are much smaller in size and addressed to more specialized readers. It is hoped that Volume 1 will help to introduce postgraduate students, researchers and practitioners to the modern concepts of ®nite element methods. In Volume 1 we stress the relationship between the ®nite element method and the more classic ®nite dierence and boundary solution methods. We show that all methods of numerical approximation can be cast in the same format and that their individual advantages can thus be retained. Although Volume 1 is not written as a course text book, it is nevertheless directed at students of postgraduate level and we hope these will ®nd it to be of wide use. Mathematical concepts are stressed throughout and precision is maintained, although little use is made of modern mathematical symbols to ensure wider understanding amongst engineers and physical scientists.

xvi Preface

In Volumes 1, 2 and 3 the chapters on computational methods are much reduced by transferring the computer source programs to a web site.1 This has the very substantial advantage of not only eliminating errors in copying the programs but also in ensuring that the reader has the bene®t of the most recent set of programs available to him or her at all times as it is our intention from time to time to update and expand the available programs. The authors are particularly indebted to the International Center of Numerical Methods in Engineering (CIMNE) in Barcelona who have allowed their pre- and post-processing code (GiD) to be accessed from the publisher's web site. This allows such dicult tasks as mesh generation and graphic output to be dealt with eciently. The authors are also grateful to Dr J.Z. Zhu for his careful scrutiny and help in drafting Chapters 14 and 15. These deal with error estimation and adaptivity, a subject to which Dr Zhu has extensively contributed. Finally, we thank Peter and Jackie Bettess for writing the general subject index. OCZ and RLT

1 Complete source code for all programs in the three volumes may be obtained at no cost from the publisher's web page: http://www.bh.com/companions/fem

1 Some preliminaries: the standard discrete system
1.1 Introduction
The limitations of the human mind are such that it cannot grasp the behaviour of its complex surroundings and creations in one operation. Thus the process of subdividing all systems into their individual components or `elements', whose behaviour is readily understood, and then rebuilding the original system from such components to study its behaviour is a natural way in which the engineer, the scientist, or even the economist proceeds. In many situations an adequate model is obtained using a ®nite number of wellde®ned components. We shall term such problems discrete. In others the subdivision is continued inde®nitely and the problem can only be de®ned using the mathematical ®ction of an in®nitesimal. This leads to dierential equations or equivalent statements which imply an in®nite number of elements. We shall term such systems continuous. With the advent of digital computers, discrete problems can generally be solved readily even if the number of elements is very large. As the capacity of all computers is ®nite, continuous problems can only be solved exactly by mathematical manipulation. Here, the available mathematical techniques usually limit the possibilities to oversimpli®ed situations. To overcome the intractability of realistic types of continuum problems, various methods of discretization have from time to time been proposed both by engineers and mathematicians. All involve an approximation which, hopefully, approaches in the limit the true continuum solution as the number of discrete variables increases. The discretization of continuous problems has been approached dierently by mathematicians and engineers. Mathematicians have developed general techniques applicable directly to dierential equations governing the problem, such as ®nite difference approximations,1;2 various weighted residual procedures,3;4 or approximate techniques for determining the stationarity of properly de®ned `functionals'. The engineer, on the other hand, often approaches the problem more intuitively by creating an analogy between real discrete elements and ®nite portions of a continuum domain. For instance, in the ®eld of solid mechanics McHenry,5 Hreniko,6 Newmark7 , and indeed Southwell9 in the 1940s, showed that reasonably good solutions to an elastic continuum problem can be obtained by replacing small portions

2 Some preliminaries: the standard discrete system

of the continuum by an arrangement of simple elastic bars. Later, in the same context, Argyris8 and Turner et al.9 showed that a more direct, but no less intuitive, substitution of properties can be made much more eectively by considering that small portions or `elements' in a continuum behave in a simpli®ed manner. It is from the engineering `direct analogy' view that the term `®nite element' was born. Clough10 appears to be the ®rst to use this term, which implies in it a direct use of a standard methodology applicable to discrete systems. Both conceptually and from the computational viewpoint, this is of the utmost importance. The ®rst allows an improved understanding to be obtained; the second oers a uni®ed approach to the variety of problems and the development of standard computational procedures. Since the early 1960s much progress has been made, and today the purely mathematical and `analogy' approaches are fully reconciled. It is the object of this text to present a view of the ®nite element method as a general discretization procedure of continuum problems posed by mathematically de®ned statements. In the analysis of problems of a discrete nature, a standard methodology has been developed over the years. The civil engineer, dealing with structures, ®rst calculates force±displacement relationships for each element of the structure and then proceeds to assemble the whole by following a well-de®ned procedure of establishing local equilibrium at each `node' or connecting point of the structure. The resulting equations can be solved for the unknown displacements. Similarly, the electrical or hydraulic engineer, dealing with a network of electrical components (resistors, capacitances, etc.) or hydraulic conduits, ®rst establishes a relationship between currents (¯ows) and potentials for individual elements and then proceeds to assemble the system by ensuring continuity of ¯ows. All such analyses follow a standard pattern which is universally adaptable to discrete systems. It is thus possible to de®ne a standard discrete system, and this chapter will be primarily concerned with establishing the processes applicable to such systems. Much of what is presented here will be known to engineers, but some reiteration at this stage is advisable. As the treatment of elastic solid structures has been the most developed area of activity this will be introduced ®rst, followed by examples from other ®elds, before attempting a complete generalization. The existence of a uni®ed treatment of `standard discrete problems' leads us to the ®rst de®nition of the ®nite element process as a method of approximation to continuum problems such that (a) the continuum is divided into a ®nite number of parts (elements), the behaviour of which is speci®ed by a ®nite number of parameters, and (b) the solution of the complete system as an assembly of its elements follows precisely the same rules as those applicable to standard discrete problems. It will be found that most classical mathematical approximation procedures as well as the various direct approximations used in engineering fall into this category. It is thus dicult to determine the origins of the ®nite element method and the precise moment of its invention. Table 1.1 shows the process of evolution which led to the present-day concepts of ®nite element analysis. Chapter 3 will give, in more detail, the mathematical basis which emerged from these classical ideas.11ÿ20

Table 1.1 ENGINEERING Trial functions Variational methods Rayleigh 187011 Ritz 190912 Weighted residuals Gauss 179518 Galerkin 191519 Biezeno±Koch 192320 MATHEMATICS Finite differences Richardson 191015 Liebman 191816 Southwell 19461

Structural analogue substitution Hreniko 19416 McHenry 19435 Newmark 19497

Piecewise continuous trial functions Courant 194313 Prager±Synge 194714 Zienkiewicz 196421 Direct continuum elements Argyris 19558 Turner et al. 19569

ÿ ÿ

"

PRESENT-DAY FINITE ELEMENT METHOD

"

"

ÿ ÿ

ÿ ÿ

"

"

ÿ ÿ

ÿ ÿ

Variational finite differences Varga 196217

ÿ ÿ
"

ÿ ÿ
"

4 Some preliminaries: the standard discrete system

1.2 The structural element and the structural system
Y4 3 p y (1) 1 x V3 3 p y (1) 2 1 x A typical element (1) Nodes (3) 2 5 (2) 4 X4

(4) 6

U3

Fig. 1.1 A typical structure built up from interconnected elements.

To introduce the reader to the general concept of discrete systems we shall ®rst consider a structural engineering example of linear elasticity. Figure 1.1 represents a two-dimensional structure assembled from individual components and interconnected at the nodes numbered 1 to 6. The joints at the nodes, in this case, are pinned so that moments cannot be transmitted. As a starting point it will be assumed that by separate calculation, or for that matter from the results of an experiment, the characteristics of each element are precisely known. Thus, if a typical element labelled (1) and associated with nodes 1, 2, 3 is examined, the forces acting at the nodes are uniquely de®ned by the displacements of these nodes, the distributed loading acting on the element (p), and its initial strain. The last may be due to temperature, shrinkage, or simply an initial `lack of ®t'. The forces and the corresponding displacements are de®ned by appropriate components (U, V and u, v) in a common coordinate system. Listing the forces acting on all the nodes (three in the case illustrated) of the element (1) as a matrixy we have 8 19 > q1 >   < = U1 q1  q1 q1  ; etc: 1:1 1 > 2> V1 : 1; q3
y A limited knowledge of matrix algebra will be assumed throughout this book. This is necessary for reasonable conciseness and forms a convenient book-keeping form. For readers not familiar with the subject a brief appendix (Appendix A) is included in which sucient principles of matrix algebra are given to follow the development intelligently. Matrices (and vectors) will be distinguished by bold print throughout.

The structural element and the structural system

5

and for the corresponding nodal displacements 8 9 > a1 >   < = u1 1 a1  a  a2 ; > > v1 : ; a3

etc:

1:2

Assuming linear elastic behaviour of the element, the characteristic relationship will always be of the form q1  K1 a1  f 1  f 10 p " f1 p 1:3 in which represents the nodal forces required to balance any distributed loads acting on the element and f 10 the nodal forces required to balance any initial strains such as " may be caused by temperature change if the nodes are not subject to any displacement. The ®rst of the terms represents the forces induced by displacement of the nodes. Similarly, a preliminary analysis or experiment will permit a unique de®nition of stresses or internal reactions at any speci®ed point or points of the element in terms of the nodal displacements. De®ning such stresses by a matrix r1 a relationship of the form r1  Q1 a1  r10 " 1:4 is obtained in which the two term gives the stresses due to the initial strains when no nodal displacement occurs. The matrix K e is known as the element stiness matrix and the matrix Q e as the element stress matrix for an element (e). Relationships in Eqs (1.3) and (1.4) have been illustrated by an example of an element with three nodes and with the interconnection points capable of transmitting only two components of force. Clearly, the same arguments and de®nitions will apply generally. An element (2) of the hypothetical structure will possess only two points of interconnection; others may have quite a large number of such points. Similarly, if the joints were considered as rigid, three components of generalized force and of generalized displacement would have to be considered, the last of these corresponding to a moment and a rotation respectively. For a rigidly jointed, three-dimensional structure the number of individual nodal components would be six. Quite generally, therefore, 8 e9 8 9 > q1 > > a1 > > > > > > e> > > <q = <a = 2 2 e e and a  1:5 q  F > > F > > F > F > > F > > F > > > : e ; : ; am qm with each qe and ai possessing the same number of components or degrees of freedom. i These quantities are conjugate to each other. The stiness matrices of the element will clearly always be square and of the form 2 e 3 Kii Ke Á Á Á Ke ij im F 5 F F F F 1:6 Ke  4 F F F F e e Kmi Á Á Á Á Á Á Kmm

6 Some preliminaries: the standard discrete system

n

p y xi β i Ui (ui ) Vi (vi ) C

E1 A1

yi x

Fig. 1.2 A pin-ended bar.

in which Ke , etc., are submatrices which are again square and of the size l Â l, where l ii is the number of force components to be considered at each node. As an example, the reader can consider a pin-ended bar of uniform section A and modulus E in a two-dimensional problem shown in Fig. 1.2. The bar is subject to a uniform lateral load p and a uniform thermal expansion strain "0  T where  is the coecient of linear expansion and T is the temperature change. If the ends of the bar are de®ned by the coordinates xi , yi and xn , yn its length can be calculated as q L  xn ÿ xi 2  yn ÿ yi 2  and its inclination from the horizontal as   tanÿ1 yn ÿ yi xn ÿ xi

Only two components of force and displacement have to be considered at the nodes. The nodal forces due to the lateral load are clearly 9 9 8 8 > ÿsin  > > Ui > > > > > > > = = < cos  > pL <V > i ÿ fe  p > ÿsin  > 2 > Un > > > > > > > > > ; ; : : cos  Vn p and represent the appropriate components of simple reactions, pL=2. Similarly, to restrain the thermal expansion "0 an axial force ETA is needed, which gives the

L

The structural element and the structural system

7

components

f e0 "

9 9 8 8 > ÿcos  > > Ui > > > > > > > = = < ÿsin  > <V > i ETA  ÿ > cos  > > Un > > > > > > > > > ; ; : : sin  Vn "0 8 9 > ui > > > > = <v > i e a  > > > un > > > : ; vn

Finally, the element displacements

will cause an elongation un ÿ ui  cos   vn ÿ vi  sin . This, when multiplied by EA=L, gives the axial force whose components can again be found. Rearranging these in the standard form gives 9 8 > Ui > > > > > > > > = < Vi > e e Ka  > Un > > > > > > > > > ; : Vn  2 38 9 cos2  sin  cos  ÿcos2  ÿsin  cos  > ui > > > > > 6 sin  cos  7> v > sin2  ÿsin  cos  ÿsin2  6 7< i = EA 6 7  7 L 6 ÿcos2  > > 4 ÿsin  cos  cos2  sin  cos  5> un > > > > > : ; 2 2 vn ÿsin  cos  ÿsin  sin  cos  sin  The components of the general equation (1.3) have thus been established for the elementary case discussed. It is again quite simple to ®nd the stresses at any section of the element in the form of relation (1.4). For instance, if attention is focused on the mid-section C of the bar the average stress determined from the axial tension to the element can be shown to be re %   E ÿcos ; ÿsin ; cos ; sin  ae ÿ ET L

where all the bending eects of the lateral load p have been ignored. For more complex elements more sophisticated procedures of analysis are required but the results are of the same form. The engineer will readily recognize that the socalled `slope±de¯ection' relations used in analysis of rigid frames are only a special case of the general relations. It may perhaps be remarked, in passing, that the complete stiness matrix obtained for the simple element in tension turns out to be symmetric (as indeed was the case with some submatrices). This is by no means fortuitous but follows from the principle of energy conservation and from its corollary, the well-known Maxwell±Betti reciprocal theorem.

8 Some preliminaries: the standard discrete system

The element properties were assumed to follow a simple linear relationship. In principle, similar relationships could be established for non-linear materials, but discussion of such problems will be held over at this stage. The calculation of the stiness coecients of the bar which we have given here will be found in many textbooks. Perhaps it is worthwhile mentioning here that the ®rst use of bar assemblies for large structures was made as early as 1935 when Southwell proposed his classical relaxation method.22

1.3 Assembly and analysis of a structure
Consider again the hypothetical structure of Fig. 1.1. To obtain a complete solution the two conditions of (a) displacement compatibility and (b) equilibrium have to be satis®ed throughout. Any system of nodal displacements a:

8 9 > a1 > < = F F a > F > : ; an

1:7

listed now for the whole structure in which all the elements participate, automatically satis®es the ®rst condition. As the conditions of overall equilibrium have already been satis®ed within an element, all that is necessary is to establish equilibrium conditions at the nodes of the structure. The resulting equations will contain the displacements as unknowns, and once these have been solved the structural problem is determined. The internal forces in elements, or the stresses, can easily be found by using the characteristics established a priori for each element by Eq. (1.4). Consider the structure to be loaded by external forces r: 8 9 > r1 > < = F F 1:8 r > F > : ; rn applied at the nodes in addition to the distributed loads applied to the individual elements. Again, any one of the forces ri must have the same number of components as that of the element reactions considered. In the example in question   Xi ri  1:9 Yi as the joints were assumed pinned, but at this stage the general case of an arbitrary number of components will be assumed. If now the equilibrium conditions of a typical node, i, are to be established, each component of ri has, in turn, to be equated to the sum of the component forces contributed by the elements meeting at the node. Thus, considering all the force

The boundary conditions

9

components we have ri 
m X e1

qe  q1  q2  Á Á Á i i i

1:10

in which q1 is the force contributed to node i by element 1, q2 by element 2, etc. i i Clearly, only the elements which include point i will contribute non-zero forces, but for tidiness all the elements are included in the summation. Substituting the forces contributing to node i from the de®nition (1.3) and noting that nodal variables ai are common (thus omitting the superscript e), we have X X   m m m X ri  Ke1 a1  Ke2 a2  Á Á Á  fe 1:11 i i i
e1 e1 e1

where f e  f e  f e0 p " The summation again only concerns the elements which contribute to node i. If all such equations are assembled we have simply Ka  r ÿ f in which the submatrices are Kij  fi 
m X e1 m X e1

1:12

Ke ij 1:13 fe i

with summations including all elements. This simple rule for assembly is very convenient because as soon as a coecient for a particular element is found it can be put immediately into the appropriate `location' speci®ed in the computer. This general assembly process can be found to be the common and fundamental feature of all ®nite element calculations and should be well understood by the reader. If dierent types of structural elements are used and are to be coupled it must be remembered that the rules of matrix summation permit this to be done only if these are of identical size. The individual submatrices to be added have therefore to be built up of the same number of individual components of force or displacement. Thus, for example, if a member capable of transmitting moments to a node is to be coupled at that node to one which in fact is hinged, it is necessary to complete the stiness matrix of the latter by insertion of appropriate (zero) coecients in the rotation or moment positions.

1.4 The boundary conditions
The system of equations resulting from Eq. (1.12) can be solved once the prescribed support displacements have been substituted. In the example of Fig. 1.1, where both components of displacement of nodes 1 and 6 are zero, this will mean

10 Some preliminaries: the standard discrete system

the substitution of

  0 a1  a6  0

which is equivalent to reducing the number of equilibrium equations (in this instance 12) by deleting the ®rst and last pairs and thus reducing the total number of unknown displacement components to eight. It is, nevertheless, always convenient to assemble the equation according to relation (1.12) so as to include all the nodes. Clearly, without substitution of a minimum number of prescribed displacements to prevent rigid body movements of the structure, it is impossible to solve this system, because the displacements cannot be uniquely determined by the forces in such a situation. This physically obvious fact will be interpreted mathematically as the matrix K being singular, i.e., not possessing an inverse. The prescription of appropriate displacements after the assembly stage will permit a unique solution to be obtained by deleting appropriate rows and columns of the various matrices. If all the equations of a system are assembled, their form is K11 a1  K12 a2  Á Á Á  r1 ÿ f1 K21 a1  K22 a2  Á Á Á  r2 ÿ f2 etc: a and it will be noted that if any displacement, such as a1  "1 , is prescribed then the external `force' r1 cannot be simultaneously speci®ed and remains unknown. The ®rst equation could then be deleted and substitution of known values of a1 made in the remaining equations. This process is computationally cumbersome and the same objective is served by adding a large number, I, to the coecient K11 and replacing the right-hand side, r1 ÿ f1 , by "1 . If  is very much larger than other a stiness coecients this alteration eectively replaces the ®rst equation by the equation a a1  "1 1:15 that is, the required prescribed condition, but the whole system remains symmetric and minimal changes are necessary in the computation sequence. A similar procedure will apply to any other prescribed displacement. The above arti®ce was introduced by Payne and Irons.23 An alternative procedure avoiding the assembly of equations corresponding to nodes with prescribed boundary values will be presented in Chapter 20. When all the boundary conditions are inserted the equations of the system can be solved for the unknown displacements and stresses, and the internal forces in each element obtained. 1:14

1.5 Electrical and ¯uid networks
Identical principles of deriving element characteristics and of assembly will be found in many non-structural ®elds. Consider, for instance, the assembly of electrical resistances shown in Fig. 1.3.

Electrical and ¯uid networks

11

j

Pi

Jj ,Vj j

i re

Ji ,Vi i

Fig. 1.3 A network of electrical resistances.

If a typical resistance element, ij, is isolated from the system we can write, by Ohm's law, the relation between the currents entering the element at the ends and the end voltages as 1 J e  e Vi ÿ Vj  i r 1 J e  e Vj ÿ Vi  j r or in matrix form  e    Vi Ji 1 ÿ1 1  e e r ÿ1 Vj Jj 1 which in our standard form is simply Je  Ke Ve 1:16 This form clearly corresponds to the stiness relationship (1.3); indeed if an external current were supplied along the length of the element the element `force' terms could also be found. To assemble the whole network the continuity of the potential V at the nodes is assumed and a current balance imposed there. If Pi now stands for the external input of current at node i we must have, with complete analogy to Eq. (1.11), Pi 
n m X X j 1 e1

K e Vj ij

1:17

where the second summation is over all `elements', and once again for all the nodes P  KV in which Kij 
m X e1

1:18

Ke ij

12 Some preliminaries: the standard discrete system

Matrix notation in the above has been dropped since the quantities such as voltage and current, and hence also the coecients of the `stiness' matrix, are scalars. If the resistances were replaced by ¯uid-carrying pipes in which a laminar regime pertained, an identical formulation would once again result, with V standing for the hydraulic head and J for the ¯ow. For pipe networks that are usually encountered, however, the linear laws are in general not valid. Typically the ¯ow±head relationship is of a form Ji  cVi ÿ Vj  1:19 where the index  lies between 0.5 and 0.7. Even now it would still be possible to write relationships in the form (1.16) noting, however, that the matrices Ke are no longer arrays of constants but are known functions of V. The ®nal equations can once again be assembled but their form will be non-linear and in general iterative techniques of solution will be needed. Finally it is perhaps of interest to mention the more general form of an electrical network subject to an alternating current. It is customary to write the relationships between the current and voltage in complex form with the resistance being replaced by complex impedance. Once again the standard forms of (1.16)±(1.18) will be obtained but with each quantity divided into real and imaginary parts. Identical solution procedures can be used if the equality of the real and imaginary quantities is considered at each stage. Indeed with modern digital computers it is possible to use standard programming practice, making use of facilities available for dealing with complex numbers. Reference to some problems of this class will be made in the chapter dealing with vibration problems in Chapter 17.

1.6 The general pattern
An example will be considered to consolidate the concepts discussed in this chapter. This is shown in Fig. 1.4(a) where ®ve discrete elements are interconnected. These may be of structural, electrical, or any other linear type. In the solution: The ®rst step is the determination of element properties from the geometric material and loading data. For each element the `stiness matrix' as well as the corresponding `nodal loads' are found in the form of Eq. (1.3). Each element has its own identifying number and speci®ed nodal connection. For example: element 1 2 3 4 5 connection 1 1 2 3 4 3 4 5 6 7 4 2 7 8 4 5

Assuming that properties are found in global coordinates we can enter each `stiness' or `force' component in its position of the global matrix as shown in Fig. 1.4(b), Each shaded square represents a single coecient or a submatrix of type Kij if more than one quantity is being considered at the nodes. Here the separate contribution of each element is shown and the reader can verify the position of

The general pattern
1 2 1 3 4 (a) 6 1 7 2 4 5 8 3 4 5 2 3 5

13

+

+

+

+

a

=
(b)

+
[K]

+

+
{ f}

+

a

=
BAND

(c)

Fig. 1.4 The general pattern.

the coecients. Note that the various types of `elements' considered here present no diculty in speci®cation. (All `forces', including nodal ones, are here associated with elements for simplicity.) The second step is the assembly of the ®nal equations of the type given by Eq. (1.12). This is accomplished according to the rule of Eq. (1.13) by simple addition of all numbers in the appropriate space of the global matrix. The result is shown in Fig. 1.4(c) where the non-zero coecients are indicated by shading. As the matrices are symmetric only the half above the diagonal shown needs, in fact, to be found. All the non-zero coecients are con®ned within a band or pro®le which can be calculated a priori for the nodal connections. Thus in computer programs only the storage of the elements within the upper half of the pro®le is necessary, as shown in Fig. 1.4(c). The third step is the insertion of prescribed boundary conditions into the ®nal assembled matrix, as discussed in Sec. 1.3. This is followed by the ®nal step. The ®nal step solves the resulting equation system. Here many dierent methods can be employed, some of which will be discussed in Chapter 20. The general

14 Some preliminaries: the standard discrete system

subject of equation solving, though extremely important, is in general beyond the scope of this book. The ®nal step discussed above can be followed by substitution to obtain stresses, currents, or other desired output quantities. All operations involved in structural or other network analysis are thus of an extremely simple and repetitive kind. We can now de®ne the standard discrete system as one in which such conditions prevail.

1.7 The standard discrete system
In the standard discrete system, whether it is structural or of any other kind, we ®nd that: 1. A set of discrete parameters, say ai , can be identi®ed which describes simultaneously the behaviour of each element, e, and of the whole system. We shall call these the system parameters. 2. For each element a set of quantities qe can be computed in terms of the system i parameters ai . The general function relationship can be non-linear qe  qe a i i but in many cases a linear form exists giving qe  Ke1 a1  Ke2 a2  Á Á Á  f e i i i i 3. The system equations are obtained by a simple addition m X qe ri  i
e1

1:20 1:21

1:22

where ri are system quantities (often prescribed as zero). In the linear case this results in a system of equations Ka  f  r such that Kij 
m X e1 m X e1

1:23

Ke ij

fi 

fe i

1:24

from which the solution for the system variables a can be found after imposing necessary boundary conditions. The reader will observe that this de®nition includes the structural, hydraulic, and electrical examples already discussed. However, it is broader. In general neither linearity nor symmetry of matrices need exist ± although in many problems this will arise naturally. Further, the narrowness of interconnections existing in usual elements is not essential. While much further detail could be discussed (we refer the reader to speci®c books for more exhaustive studies in the structural context24ÿ26 ), we feel that the general Â expose given here should suce for further study of this book.

Transformation of coordinates

15

Only one further matter relating to the change of discrete parameters need be mentioned here. The process of so-called transformation of coordinates is vital in many contexts and must be fully understood.

1.8 Transformation of coordinates
It is often convenient to establish the characteristics of an individual element in a coordinate system which is dierent from that in which the external forces and displacements of the assembled structure or system will be measured. A dierent coordinate system may, in fact, be used for every element, to ease the computation. It is a simple matter to transform the coordinates of the displacement and force components of Eq. (1.3) to any other coordinate system. Clearly, it is necessary to do so before an assembly of the structure can be attempted. Let the local coordinate system in which the element properties have been evaluated be denoted by a prime sux and the common coordinate system necessary for assembly have no embellishment. The displacement components can be transformed by a suitable matrix of direction cosines L as aH  La 1:25 As the corresponding force components must perform the same amount of work in either systemy qT a  qH T aH On inserting (1.25) we have qT a  qH T La or q  L T qH 1:27 The set of transformations given by (1.25) and (1.27) is called contravariant. To transform `stinesses' which may be available in local coordinates to global ones note that if we write qH  K H aH then by (1.27), (1.28), and (1.25) q  LT KH La or in global coordinates K  LT KH L 1:29 The reader can verify the usefulness of the above transformations by reworking the sample example of the pin-ended bar, ®rst establishing its stiness in its length coordinates.
y With ( )T standing for the transpose of the matrix.

1:26

1:28

16 Some preliminaries: the standard discrete system

In many complex problems an external constraint of some kind may be imagined, enforcing the requirement (1.25) with the number of degrees of freedom of a and aH being quite dierent. Even in such instances the relations (1.26) and (1.27) continue to be valid. An alternative and more general argument can be applied to many other situations of discrete analysis. We wish to replace a set of parameters a in which the system equations have been written by another one related to it by a transformation matrix T as a  Tb In the linear case the system equations are of the form Ka  r ÿ f and on the substitution we have KTb  r ÿ f The new system can be premultiplied simply by T , yielding TT KTb  TT r ÿ TT f 1:33 which will preserve the symmetry of equations if the matrix K is symmetric. However, occasionally the matrix T is not square and expression (1.30) represents in fact an approximation in which a larger number of parameters a is constrained. Clearly the system of equations (1.32) gives more equations than are necessary for a solution of the reduced set of parameters b, and the ®nal expression (1.33) presents a reduced system which in some sense approximates the original one. We have thus introduced the basic idea of approximation, which will be the subject of subsequent chapters where in®nite sets of quantities are reduced to ®nite sets. A historical development of the subject of ®nite element methods has been presented by the author.27;28
T

1:30

1:31 1:32

References
1. 2. 3. 4. 5. 6. 7. 8. 9. R.V. Southwell. Relaxation Methods in Theoretical Physics. Clarendon Press, 1946. D.N. de G. Allen. Relaxation Methods. McGraw-Hill, 1955. S.H. Crandall. Engineering Analysis. McGraw-Hill, 1956. B.A. Finlayson. The Method of Weighted Residuals and Variational Principles. Academic Press, 1972. D. McHenry. A lattice analogy for the solution of plane stress problems. J. Inst. Civ. Eng., 21, 59±82, 1943. A. Hreniko. Solution of problems in elasticity by the framework method. J. Appl. Mech., A8, 169±75, 1941. N.M. Newmark. Numerical methods of analysis in bars, plates and elastic bodies, in Numerical Methods in Analysis in Engineering (ed. L.E. Grinter), Macmillan, 1949. J.H. Argyris. Energy Theorems and Structural Analysis. Butterworth, 1960 (reprinted from Aircraft Eng., 1954±5). M.J. Turner, R.W. Clough, H.C. Martin, and L.J. Topp. Stiness and de¯ection analysis of complex structures. J. Aero. Sci., 23, 805±23, 1956.

17
10. R.W. Clough. The ®nite element in plane stress analysis. Proc. 2nd ASCE Conf. on Electronic Computation. Pittsburgh, Pa., Sept. 1960. 11. Lord Rayleigh (J.W. Strutt). On the theory of resonance. Trans. Roy. Soc. (London), A161, 77±118, 1870. È 12. W. Ritz. Uber eine neue Methode zur Losung gewissen Variations ± Probleme der mathÈ ematischen Physik. J. Reine Angew. Math., 135, 1±61, 1909. 13. R. Courant. Variational methods for the solution of problems of equilibrium and vibration. Bull. Am. Math. Soc., 49, 1±23, 1943. 14. W. Prager and J.L. Synge. Approximation in elasticity based on the concept of function space. Q. J. Appl. Math., 5, 241±69, 1947. 15. L.F. Richardson. The approximate arithmetical solution by ®nite dierences of physical problems. Trans. Roy. Soc. (London), A210, 307±57, 1910. 16. H. Liebman. Die angenaherte Ermittlung: harmonischen, functionen und konformer È Abbildung. Sitzber. Math. Physik Kl. Bayer Akad. Wiss. Mu Ènchen. 3, 65±75, 1918. 17. R.S. Varga. Matrix Iterative Analysis. Prentice-Hall, 1962. 18. C.F. Gauss, See Carl Friedrich Gauss Werks. Vol. VII, Gottingen, 1871. È 19. B.G. Galerkin. Series solution of some problems of elastic equilibrium of rods and plates' (Russian). Vestn. Inzh. Tech., 19, 897±908, 1915. 20. C.B. Biezeno and J.J. Koch. Over een Nieuwe Methode ter Berekening van Vlokke Platen. Ing. Grav., 38, 25±36, 1923. 21. O.C. Zienkiewicz and Y.K. Cheung. The ®nite element method for analysis of elastic isotropic and orthotropic slabs. Proc. Inst. Civ. Eng., 28, 471±488, 1964. 22. R.V. Southwell. Stress calculation in frame works by the method of systematic relaxation of constraints, Part I & II. Proc. Roy. Soc. London (A), 151, 56±95, 1935. 23. N.A. Payne and B.M. Irons, Private communication, 1963. 24. R.K. Livesley. Matrix Methods in Structural Analysis. 2nd ed., Pergamon Press, 1975. 25. J.S. Przemieniecki. Theory of Matrix Structural Analysis. McGraw-Hill, 1968. 26. H.C. Martin. Introduction to Matrix Methods of Structural Analysis. McGraw-Hill, 1966. 27. O.C. Zienkiewicz. Origins, milestones and directions of the ®nite element method. Arch. Comp. Methods Eng., 2, 1±48, 1995. 28. O.C. Zienkiewicz. Origins, milestones and directions of the ®nite element method ± A personal view. Handbook of Numerical Analysis, IV, 3±65. Editors P.C. Ciarlet and J.L. Lions, North-Holland, 1996.

2 A direct approach to problems in elasticity
2.1 Introduction
The process of approximating the behaviour of a continuum by `®nite elements' which behave in a manner similar to the real, `discrete', elements described in the previous chapter can be introduced through the medium of particular physical applications or as a general mathematical concept. We have chosen here to follow the ®rst path, narrowing our view to a set of problems associated with structural mechanics which historically were the ®rst to which the ®nite element method was applied. In Chapter 3 we shall generalize the concepts and show that the basic ideas are widely applicable. In many phases of engineering the solution of stress and strain distributions in elastic continua is required. Special cases of such problems may range from twodimensional plane stress or strain distributions, axisymmetric solids, plate bending, and shells, to fully three-dimensional solids. In all cases the number of interconnections between any `®nite element' isolated by some imaginary boundaries and the neighbouring elements is in®nite. It is therefore dicult to see at ®rst glance how such problems may be discretized in the same manner as was described in the preceding chapter for simpler structures. The diculty can be overcome (and the approximation made) in the following manner: 1. The continuum is separated by imaginary lines or surfaces into a number of `®nite elements'. 2. The elements are assumed to be interconnected at a discrete number of nodal points situated on their boundaries and occasionally in their interior. In Chapter 6 we shall show that this limitation is not necessary. The displacements of these nodal points will be the basic unknown parameters of the problem, just as in simple, discrete, structural analysis. 3. A set of functions is chosen to de®ne uniquely the state of displacement within each `®nite element' and on its boundaries in terms of its nodal displacements. 4. The displacement functions now de®ne uniquely the state of strain within an element in terms of the nodal displacements. These strains, together with any initial strains and the constitutive properties of the material, will de®ne the state of stress throughout the element and, hence, also on its boundaries.

Direct formulation of ®nite element characteristics

19

5. A system of `forces' concentrated at the nodes and equilibrating the boundary stresses and any distributed loads is determined, resulting in a stiness relationship of the form of Eq. (1.3). Once this stage has been reached the solution procedure can follow the standard discrete system pattern described earlier. Clearly a series of approximations has been introduced. Firstly, it is not always easy to ensure that the chosen displacement functions will satisfy the requirement of displacement continuity between adjacent elements. Thus, the compatibility condition on such lines may be violated (though within each element it is obviously satis®ed due to the uniqueness of displacements implied in their continuous representation). Secondly, by concentrating the equivalent forces at the nodes, equilibrium conditions are satis®ed in the overall sense only. Local violation of equilibrium conditions within each element and on its boundaries will usually arise. The choice of element shape and of the form of the displacement function for speci®c cases leaves many opportunities for the ingenuity and skill of the engineer to be employed, and obviously the degree of approximation which can be achieved will strongly depend on these factors. The approach outlined here is known as the displacement formulation.1;2 So far, the process described is justi®ed only intuitively, but what in fact has been suggested is equivalent to the minimization of the total potential energy of the system in terms of a prescribed displacement ®eld. If this displacement ®eld is de®ned in a suitable way, then convergence to the correct result must occur. The process is then equivalent to the well-known Rayleigh±Ritz procedure. This equivalence will be proved in a later section of this chapter where also a discussion of the necessary convergence criteria will be presented. The recognition of the equivalence of the ®nite element method to a minimization process was late.2;3 However, Courant in 19434 y and Prager and Synge5 in 1947 proposed methods that are in essence identical. This broader basis of the ®nite element method allows it to be extended to other continuum problems where a variational formulation is possible. Indeed, general procedures are now available for a ®nite element discretization of any problem de®ned by a properly constituted set of dierential equations. Such generalizations will be discussed in Chapter 3, and throughout the book application to non-structural problems will be made. It will be found that the processes described in this chapter are essentially an application of trialfunction and Galerkin-type approximations to a particular case of solid mechanics.

2.2 Direct formulation of ®nite element characteristics
The `prescriptions' for deriving the characteristics of a `®nite element' of a continuum, which were outlined in general terms, will now be presented in more detailed mathematical form.
y It appears that Courant had anticipated the essence of the ®nite element method in general, and of a triangular element in particular, as early as 1923 in a paper entitled `On a convergence principle in the calculus of variations.' Kon. Gesellschaft der Wissenschaften zu Gottingen, Nachrichten, Berlin, 1923. He states: `We imagine a È È mesh of triangles covering the domain . . . the convergence principles remain valid for each triangular domain.'

20 A direct approach to problems in elasticity

y

ui (Vi )

i t=
tx ty

ui (Ui ) e m j

x

Fig. 2.1 A plane stress region divided into ®nite elements.

It is desirable to obtain results in a general form applicable to any situation, but to avoid introducing conceptual diculties the general relations will be illustrated with a very simple example of plane stress analysis of a thin slice. In this a division of the region into triangular-shaped elements is used as shown in Fig. 2.1. Relationships of general validity will be placed in a box. Again, matrix notation will be implied.

2.2.1 Displacement function
A typical ®nite element, e, is de®ned by nodes, i, j, m, etc., and straight line boundaries. Let the displacements u at any point within the element be approximated as a column Ã vector, u: 8 9e > ai > > > < = X u% u Nk ae  Ni ; Nj ; F F F aj  Nae k > > > F > k : F ; F

2:1

in which the components of N are prescribed functions of position and ae represents a listing of nodal displacements for a particular element.

Direct formulation of ®nite element characteristics
y i Ni j m x 1

21

Fig. 2.2 Shape function Ni for one element.

In the case of plane stress, for instance,   ux; y u vx; y represents horizontal and vertical movements of a typical point within the element and   ui ai  vi the corresponding displacements of a node i. The functions Ni , Nj , Nm have to be chosen so as to give appropriate nodal displacements when the coordinates of the corresponding nodes are inserted in Eq. (2.1). Clearly, in general, Ni xi ; yi   I (identity matrix) while Ni xj ; yj   Ni xm ; ym   0; etc: which is simply satis®ed by suitable linear functions of x and y. If both the components of displacement are speci®ed in an identical manner then we can write Ni  Ni I and obtain Ni from Eq. (2.1) by noting that Ni  1 at xi , yi but zero at other vertices. The most obvious linear function in the case of a triangle will yield the shape of Ni of the form shown in Fig. 2.2. Detailed expressions for such a linear interpolation are given in Chapter 4, but at this stage can be readily derived by the reader. The functions N will be called shape functions and will be seen later to play a paramount role in ®nite element analysis.

2.2.2 Strains
With displacements known at all points within the element the `strains' at any point can be determined. These will always result in a relationship that can be written in

22 A direct approach to problems in elasticity

matrix notation asy e %   Su e 2:2

where S is a suitable linear operator. Using Eq. (2.1), the above equation can be approximated as e %   Ba e with B  SN 2:4 2:3

For the plane stress case the relevant strains of interest are those occurring in the plane and are de®ned in terms of the displacements by well-known relations6 which de®ne the operator S: 9 2 8 3 @ > @u > > > ; 0 9 > @x > 6 @x 8 > > 7 > 6 > > 7  > "x > > = < = > @v > 6 < @ 7 u 7 6 0; " 6  e 7 @y 7 v > y > > @y > 6 > 6 ; > : > > 7 xy > 4 > > @u @v > > > @ @ 5 > >  ; : ; @y @x @y @x With the shape functions Ni , Nj , and Nm already determined, the matrix B can easily be obtained. If the linear form of these functions is adopted then, in fact, the strains will be constant throughout the element.

2.2.3 Stresses
In general, the material within the element boundaries may be subjected to initial strains such as may be due to temperature changes, shrinkage, crystal growth, and so on. If such strains are denoted by e0 then the stresses will be caused by the dierence between the actual and initial strains. In addition it is convenient to assume that at the outset of the analysis the body is stressed by some known system of initial residual stresses r0 which, for instance, could be measured, but the prediction of which is impossible without the full knowledge of the material's history. These stresses can simply be added on to the general de®nition. Thus, assuming general linear elastic behaviour, the relationship between stresses and strains will be linear and of the form r  De ÿ e0   r0 where D is an elasticity matrix containing the appropriate material properties.
y It is known that strain is a second-rank tensor by its transformation properties; however, in this book we will normally represent quantities using matrix (Voigt) notation. The interested reader is encouraged to consult Appendix B for the relations between tensor forms and matrix quantities.

2:5

Direct formulation of ®nite element characteristics

23

Again, for the particular case of plane stress three components of stress corresponding to the strains already de®ned have to be considered. These are, in familiar notation 9 8 > x > = < r  y > > ; : xy and the D matrix may be simply obtained from the usual isotropic stress±strain relationship6 1  "x ÿ "x 0  x ÿ y E E  1 "y ÿ "y 0  ÿ x  y E E 21   xy xy ÿ xy 0  E i.e., on solving, 2 3 1  0 E 6 7 D  1 0 5 2 4 1ÿ 0 0 1 ÿ =2

2.2.4 Equivalent nodal forces
Let 8 e9 > qi > < e= e q  qj > F > : F ; F

de®ne the nodal forces which are statically equivalent to the boundary stresses and distributed body forces on the element. Each of the forces qe must contain the i same number of components as the corresponding nodal displacement ai and be ordered in the appropriate, corresponding directions. The distributed body forces b are de®ned as those acting on a unit volume of material within the element with directions corresponding to those of the displacements u at that point. In the particular case of plane stress the nodal forces are, for instance,  e Ui qe  i Vi with components U and V corresponding to the directions of u and v displacements, and the distributed body forces are   bx b by in which bx and by are the `body force' components.

24 A direct approach to problems in elasticity

To make the nodal forces statically equivalent to the actual boundary stresses and distributed body forces, the simplest procedure is to impose an arbitrary (virtual) nodal displacement and to equate the external and internal work done by the various forces and stresses during that displacement. Let such a virtual displacement be ae at the nodes. This results, by Eqs (2.1) and (2.2), in displacements and strains within the element equal to u  N ae and e  B ae 2:6 respectively. The work done by the nodal forces is equal to the sum of the products of the individual force components and corresponding displacements, i.e., in matrix language aeT qe 2:7 Similarly, the internal work per unit volume done by the stresses and distributed body forces is eT r ÿ uT b ory aT BT r ÿ NT b 2:9 Equating the external work with the total internal work obtained by integrating over the volume of the element, V e , we have    eT e eT T T a q  a B r dvol ÿ N b dvol 2:10
Ve Ve

2:8

As this relation is valid for any value of the virtual displacement, the multipliers must be equal. Thus   qe  BT r dvol ÿ NT b dvol Ve Ve 2:11 This statement is valid quite generally for any stress±strain relation. With the linear law of Eq. (2.5) we can write Eq. (2.11) as qe  K e ae  f e where K  and fe  ÿ
e

2:12


V
e

BT DB dvol

2:13a


Ve

NT b dvol ÿ


Ve

BT De0 dvol 


Ve

BT r0 dvol

2:13b

y Note that by the rules of matrix algebra for the transpose of products ABT  BT AT

Direct formulation of ®nite element characteristics

25

In the last equation the three terms represent forces due to body forces, initial strain, and initial stress respectively. The relations have the characteristics of the discrete structural elements described in Chapter 1. If the initial stress system is self-equilibrating, as must be the case with normal residual stresses, then the forces given by the initial stress term of Eq. (2.13b) are identically zero after assembly. Thus frequent evaluation of this force component is omitted. However, if for instance a machine part is manufactured out of a block in which residual stresses are present or if an excavation is made in rock where known tectonic stresses exist a removal of material will cause a force imbalance which results from the above term. For the particular example of the plane stress triangular element these characteristics will be obtained by appropriate substitution. It has already been noted that the B matrix in that example was not dependent on the coordinates; hence the integration will become particularly simple. The interconnection and solution of the whole assembly of elements follows the simple structural procedures outlined in Chapter 1. In general, external concentrated forces may exist at the nodes and the matrix 8 9 > r1 > > > > > <r = 2 2:14 r > F > > F > > F > : ; rn will be added to the consideration of equilibrium at the nodes. A note should be added here concerning elements near the boundary. If, at the boundary, displacements are speci®ed, no special problem arises as these can be satis®ed by specifying some of the nodal parameters a. Consider, however, the boundary as subject to a distributed external loading, say " per unit area. A loading term on the t nodes of the element which has a boundary face Ae will now have to be added. By the virtual work consideration, this will simply result in  fe  ÿ NT " darea t Ae 2:15 with the integration taken over the boundary area of the element. It will be noted that " must have the same number of components as u for the above expression to t be valid. Such a boundary element is shown again for the special case of plane stress in Fig. 2.1. An integration of this type is sometimes not carried out explicitly. Often by `physical intuition' the analyst will consider the boundary loading to be represented simply by concentrated loads acting on the boundary nodes and calculate these by direct static procedures. In the particular case discussed the results will be identical. Once the nodal displacements have been determined by solution of the overall `structural' type equations, the stresses at any point of the element can be found from the relations in Eqs (2.3) and (2.5), giving r  DBae ÿ De0  r0 2:16

26 A direct approach to problems in elasticity

in which the typical terms of the relationship of Eq. (1.4) will be immediately recognized, the element stress matrix being Qe  DB To this the stresses r"0  ÿDe0 have to be added. and r0 2:18 2:17

2.2.5 Generalized nature of displacements, strains, and stresses
The meaning of displacements, strains, and stresses in the illustrative case of plane stress was obvious. In many other applications, shown later in this book, this terminology may be applied to other, less obvious, quantities. For example, in considering plate elements the `displacement' may be characterized by the lateral de¯ection and the slopes of the plate at a particular point. The `strains' will then be de®ned as the curvatures of the middle surface and the `stresses' as the corresponding internal bending moments (see Volume 2). All the expressions derived here are generally valid provided the sum product of displacement and corresponding load components truly represents the external work done, while that of the `strain' and corresponding `stress' components results in the total internal work.

2.3 Generalization to the whole region ± internal nodal force concept abandoned
In the preceding section the virtual work principle was applied to a single element and the concept of equivalent nodal force was retained. The assembly principle thus followed the conventional, direct equilibrium, approach. The idea of nodal forces contributed by elements replacing the continuous interaction of stresses between elements presents a conceptual diculty. However, it has a considerable appeal to `practical' engineers and does at times allow an interpretation which otherwise would not be obvious to the more rigorous mathematician. There is, however, no need to consider each element individually and the reasoning of the previous section may be applied directly to the whole continuum. Equation (2.1) can be interpreted as applying to the whole structure, that is, ~ u  Na in which a lists all the nodal points and ~ Ni  Ne i 2:20 when the point concerned is within a particular element e and i is a point associated with that element. If point i does not occur within the element (see Fig. 2.3) ~ Ni  0 2:21 2:19

Generalization to the whole region ± internal nodal force concept abandoned
~ Ni y

27

i

x

" Fig. 2.3. A `global' shape function ± Ni

" Matrix B can be similarly de®ned and we shall drop the bar superscript, considering simply that the shape functions, etc., are always de®ned over the whole region V. For any virtual displacement a we can now write the sum of internal and external work for the whole region as    ÿaT r  uT b dV  uT" dA ÿ eT r dV 2:22 t
V A V

In the above equation a, u, and e can be completely arbitrary, providing they stem from a continuous displacement assumption. If for convenience we assume they are simply variations linked by the relations (2.19) and (2.3) we obtain, on substitution of the constitutive relation (2.5), a system of algebraic equations Ka  f  r where K and fÿ 
V

2:23


V

BT DB dV 
V

2:24a 
V

NT b dV ÿ


A

NT" dA ÿ t

BT De0 dV 

BT r0 dV

2:24b

The integrals are taken over the whole volume V and over the whole surface area A on which the tractions are given. It is immediately obvious from the above that X e X e Kij  Kij fi  fi 2:25 by virtue of the property of de®nite integrals requiring that the total be the sum of the parts:  X   dV    dV 2:26
V Ve

28 A direct approach to problems in elasticity

The same is obviously true for the surface integrals in Eq. (2.25). We thus see that the `secret' of the approximation possessing the required behaviour of a `standard discrete system of Chapter 1' lies simply in the requirement of writing the relationships in integral form. The assembly rule as well as the whole derivation has been achieved without involving the concept of `interelement forces' (i.e., qe ). In the remainder of this book the element superscript will be dropped unless speci®cally needed. Also no dierentiation between element and system shape functions will be made. However, an important point arises immediately. In considering the virtual work for the whole system [Eq. (2.22)] and equating this to the sum of the element contributions it is implicitly assumed that no discontinuity in displacement between adjacent elements develops. If such a discontinuity developed, a contribution equal to the work done by the stresses in the separations would have to be added.

∆ ‘Smoothing’ zone

u

du dx

d2u dx 2

–∞

Fig. 2.4 Differentiation of a function with slope discontinuity (C0 continuous).

Displacement approach as a minimization of total potential energy

29

Put in other words, we require that the terms integrated in Eq. (2.26) be ®nite. These terms arise from the shape functions Ni used in de®ning the displacement u [by Eq. (2.19)] and its derivatives associated with the de®nition of strain [viz. Eq. (2.3)]. If, for instance, the `strains' are de®ned by ®rst derivatives of the functions N, the displacements must be continuous. In Fig. 2.4 we see how ®rst derivatives of continuous functions may involve a `jump' but are still ®nite, while second derivatives may become in®nite. Such functions we call C0 continuous. In some problems the `strain' in a generalized sense may be de®ned by second derivatives. In such cases we shall obviously require that both the function N and its slope (®rst derivative) be continuous. Such functions are more dicult to derive but we shall make use of them in plate and shell problems (see Volume 2). The continuity involved now is called C1 continuity.

2.4 Displacement approach as a minimization of total potential energy
The principle of virtual displacements used in the previous sections ensured satisfaction of equilibrium conditions within the limits prescribed by the assumed displacement pattern. Only if the virtual work equality for all, arbitrary, variations of displacement was ensured would the equilibrium be complete. As the number of parameters of a which prescribes the displacement increases without limit then ever closer approximation of all equilibrium conditions can be ensured. The virtual work principle as written in Eq. (2.22) can be restated in a dierent form if the virtual quantities a, u, and e are considered as variations of the real quantities. Thus, for instance, we can write      aT r  uT b dV  uT" dA  ÿW t 2:27
V A

for the ®rst three terms of Eq. (2.22), where W is the potential energy of the external loads. The above is certainly true if r, b, and " are conservative (or independent of t displacement). The last term of Eq. (2.22) can, for elastic materials, be written as  U  eT r dV 2:28
V

where U is the `strain energy' of the system. For the elastic, linear material described by Eq. (2.5) the reader can verify that    1 T T U e De dV ÿ e De0 dV  eT r0 dV 2:29 2 V V V will, after dierentiation, yield the correct expression providing D is a symmetric matrix. (This is indeed a necessary condition for a single-valued U to exist.) Thus instead of Eq. (2.22) we can write simply U  W  Å  0 in which the quantity Å is called the total potential energy. 2:30

30 A direct approach to problems in elasticity

The above statement means that for equilibrium to be ensured the total potential energy must be stationary for variations of admissible displacements. The ®nite element equations derived in the previous section [Eqs (2.23)±(2.25)] are simply the statements of this variation with respect to displacements constrained to a ®nite number of parameters a and could be written as 9 8 > @Å > > > > > > @a1 > > > = < @Å @Å  0 2:31  @a > @a > > 2> > > > > > F > : F ; F It can be shown that in stable elastic situations the total potential energy is not only stationary but is a minimum.7 Thus the ®nite element process seeks such a minimum within the constraint of an assumed displacement pattern. The greater the degrees of freedom, the more closely will the solution approximate the true one, ensuring complete equilibrium, providing the true displacement can, in the limit, be represented. The necessary convergence conditions for the ®nite element process could thus be derived. Discussion of these will, however, be deferred to subsequent sections. It is of interest to note that if true equilibrium requires an absolute minimum of the total potential energy, Å, a ®nite element solution by the displacement approach will always provide an approximate Å greater than the correct one. Thus a bound on the value of the total potential energy is always achieved. If the functional Å could be speci®ed, a priori, then the ®nite element equations could be derived directly by the dierentiation speci®ed by Eq. (2.31). The well-known Rayleigh8 ±Ritz9 process of approximation frequently used in elastic analysis uses precisely this approach. The total potential energy expression is formulated and the displacement pattern is assumed to vary with a ®nite set of undetermined parameters. A set of simultaneous equations minimizing the total potential energy with respect to these parameters is set up. Thus the ®nite element process as described so far can be considered to be the Rayleigh±Ritz procedure. The dierence is only in the manner in which the assumed displacements are prescribed. In the Ritz process traditionally used these are usually given by expressions valid throughout the whole region, thus leading to simultaneous equations in which no banding occurs and the coecient matrix is full. In the ®nite element process this speci®cation is usually piecewise, each nodal parameter in¯uencing only adjacent elements, and thus a sparse and usually banded matrix of coecients is found. By its nature the conventional Ritz process is limited to relatively simple geometrical shapes of the total region while this limitation only occurs in ®nite element analysis in the element itself. Thus complex, realistic, con®gurations can be assembled from relatively simple element shapes. A further dierence in kind is in the usual association of the undetermined parameter with a particular nodal displacement. This allows a simple physical interpretation invaluable to an engineer. Doubtless much of the popularity of the ®nite element process is due to this fact.

Convergence criteria

31

2.5 Convergence criteria
The assumed shape functions limit the in®nite degrees of freedom of the system, and the true minimum of the energy may never be reached, irrespective of the ®neness of subdivision. To ensure convergence to the correct result certain simple requirements must be satis®ed. Obviously, for instance, the displacement function should be able to represent the true displacement distribution as closely as desired. It will be found that this is not so if the chosen functions are such that straining is possible when the element is subjected to rigid body displacements. Thus, the ®rst criterion that the displacement function must obey is as follows: Criterion 1. The displacement function chosen should be such that it does not permit straining of an element to occur when the nodal displacements are caused by a rigid body motion. This self-evident condition can be violated easily if certain types of function are used; care must therefore be taken in the choice of displacement functions. A second criterion stems from similar requirements. Clearly, as elements get smaller nearly constant strain conditions will prevail in them. If, in fact, constant strain conditions exist, it is most desirable for good accuracy that a ®nite size element is able to reproduce these exactly. It is possible to formulate functions that satisfy the ®rst criterion but at the same time require a strain variation throughout the element when the nodal displacements are compatible with a constant strain solution. Such functions will, in general, not show good convergence to an accurate solution and cannot, even in the limit, represent the true strain distribution. The second criterion can therefore be formulated as follows: Criterion 2. The displacement function has to be of such a form that if nodal displacements are compatible with a constant strain condition such constant strain will in fact be obtained. (In this context again a generalized `strain' de®nition is implied.) It will be observed that Criterion 2 in fact incorporates the requirement of Criterion 1, as rigid body displacements are a particular case of constant strain ± with a value of zero. This criterion was ®rst stated by Bazeley et al.10 in 1965. Strictly, both criteria need only be satis®ed in the limit as the size of the element tends to zero. However, the imposition of these criteria on elements of ®nite size leads to improved accuracy, although in certain situations (such as illustrated by the axisymmetric analysis of Chapter 5) the imposition of the second one is not possible or essential. Lastly, as already mentioned in Sec. 2.3, it is implicitly assumed in this derivation that no contribution to the virtual work arises at element interfaces. It therefore appears necessary that the following criterion be included: Criterion 3. The displacement functions should be chosen such that the strains at the interface between elements are ®nite (even though they may be discontinuous). This criterion implies a certain continuity of displacements between elements. In the case of strains being de®ned by ®rst derivatives, as in the plane stress example quoted here, the displacements only have to be continuous. If, however, as in the

32 A direct approach to problems in elasticity

plate and shell problems, the `strains' are de®ned by second derivatives of de¯ections, ®rst derivatives of these have also to be continuous.2 The above criteria are included mathematically in a statement of `functional completeness' and the reader is referred elsewhere for full mathematical discussion.11ÿ16 The `heuristic' proof of the convergence requirements given here is sucient for practical purposes in all but the most pathological cases and we shall generalize all of the above criteria in Section 3.6 and more fully in Chapter 10, where we shall present a universal test which justi®es convergence even if some of the above criteria are violated.

2.6 Discretization error and convergence rate
In the foregoing sections we have assumed that the approximation to the displacement as represented by Eq. (2.1) will yield the exact solution in the limit as the size h of elements decreases. The arguments for this are simple: if the expansion is capable, in the limit, of exactly reproducing any displacement form conceivable in the continuum, then as the solution of each approximation is unique it must approach, in the limit of h 3 0, the unique exact solution. In some cases the exact solution is indeed obtained with a ®nite number of subdivisions (or even with one element only) if the polynomial expansion is used in that element and if this can ®t exactly the correct solution. Thus, for instance, if the exact solution is of the form of a quadratic polynomial and the shape functions include all the polynomials of that order, the approximation will yield the exact answer. The last argument helps in determining the order of convergence of the ®nite element procedure as the exact solution can always be expanded in the vicinity of any point (or node) i as a polynomial:     @u @u u  ui  x ÿ xi   y ÿ yi   Á Á Á 2:32 @x i @y i If within an element of `size' h a polynomial expansion of degree p is employed, this can ®t locally the Taylor expansion up to that degree and, as x ÿ xi and y ÿ yi are of the order of magnitude h, the error in u will be of the order Oh p  1 . Thus, for instance, in the case of the plane elasticity problem discussed, we used a linear expansion and p  1. We should therefore expect a convergence rate of order Oh2 , i.e., the error in displacement being reduced to 1 for a halving of the mesh spacing. 4 By a similar argument the strains (or stresses) which are given by the mth derivatives of displacement should converge with an error of Oh p  1 ÿ m , i.e., as Oh in the example quoted, where m  1. The strain energy, being given by the square of the stresses, will show an error of Oh2p  1 ÿ m  or Oh2  in the plane stress example. The arguments given here are perhaps a tri¯e `heuristic' from a mathematical viewpoint ± they are, however, true15;16 and correctly give the orders of convergence, which can be expected to be achieved asymptotically as the element size tends to zero and if the exact solution does not contain singularities. Such singularities may result in in®nite values of the coecients in terms omitted in the Taylor expansion of Eq. (2.32) and invalidate the arguments. However, in many well-behaved problems the mere determination of the order of convergence often suces to extrapolate the

Displacement functions with discontinuity between elements

33

solution to the correct result. Thus, for instance, if the displacement converges at Oh2  and we have two approximate solutions u1 and u2 obtained with meshes of size h and h=2, we can write, with u being the exact solution, u1 ÿ u Oh2  4  u2 ÿ u Oh=22 2:33

From the above an (almost) exact solution u can be predicted. This type of extrapolation was ®rst introduced by Richardson17 and is of use if convergence is monotonic and nearly asymptotic. We shall return to the important question of estimating errors due to the discretization process in Chapter 14 and will show that much more precise methods than those arising from convergence rate considerations are possible today. Indeed automatic mesh re®nement processes are being introduced so that the speci®ed accuracy can be achieved (viz. Chapter 15). Discretization error is not the only error possible in a ®nite element computation. In addition to obvious mistakes which can occur when using computers, errors due to round-o are always possible. With the computer operating on numbers rounded o to a ®nite number of digits, a reduction of accuracy occurs every time dierences between `like' numbers are being formed. In the process of equation solving many subtractions are necessary and accuracy decreases. Problems of matrix conditioning, etc., enter here and the user of the ®nite element method must at all times be aware of accuracy limitations which simply do not allow the exact solution ever to be obtained. Fortunately in many computations, by using modern machines which carry a large number of signi®cant digits, these errors are often small. The question of errors arising from the algebraic processes will be stressed in Chapter 20 dealing with computation procedures.

2.7 Displacement functions with discontinuity between elements ± non-conforming elements and the patch test
In some cases considerable diculty is experienced in ®nding displacement functions for an element which will automatically be continuous along the whole interface between adjacent elements. As already pointed out, the discontinuity of displacement will cause in®nite strains at the interfaces, a factor ignored in this formulation because the energy contribution is limited to the elements themselves. However, if, in the limit, as the size of the subdivision decreases continuity is restored, then the formulation already obtained will still tend to the correct answer. This condition is always reached if (a) a constant strain condition automatically ensures displacement continuity and (b) the constant strain criterion of the previous section is satis®ed. To test that such continuity is achieved for any mesh con®guration when using such non-conforming elements it is necessary to impose, on an arbitrary patch of elements, nodal displacements corresponding to any state of constant strain. If

34 A direct approach to problems in elasticity

nodal equilibrium is simultaneously achieved without the imposition of external, nodal, forces and if a state of constant stress is obtained, then clearly no external work has been lost through interelement discontinuity. Elements which pass such a patch test will converge, and indeed at times nonconforming elements will show a superior performance to conforming elements. The patch test was ®rst introduced by Irons10 and has since been demonstrated to give a sucient condition for convergence.16;18ÿ22 The concept of the patch test can be generalized to give information on the rate of convergence which can be expected from a given element. We shall return to this problem in detail in Chapter 10 where the test will be fully discussed.

2.8 Bound on strain energy in a displacement formulation
While the approximation obtained by the ®nite element displacement approach always overestimates the true value of Å, the total potential energy (the absolute minimum corresponding to the exact solution), this is not directly useful in practice. It is, however, possible to obtain a more useful limit in special cases. Consider in particular the problem in which no `initial' strains or initial stresses exist. Now by the principle of energy conservation the strain energy will be equal to the work done by the external loads which increase uniformly from zero.23 This work done is equal to ÿ 1 W where W is the potential energy of the loads. 2 Thus U  1W  0 2:34 2 or Å  U  W  ÿU 2:35 whether an exact or approximate displacement ®eld is assumed. Thus in the above case the approximate solution always underestimates the value of U and a displacement solution is frequently referred to as the lower bound solution. If only one external concentrated load R is present the strain energy bound immediately informs us that the de¯ection under this load has been underestimated (as U  ÿ 1 W  1 rT a). In more complex loading cases the usefulness of this bound is 2 2 limited as neither local de¯ections nor stresses, i.e., the quantities of real engineering interest, can be bounded. It is important to remember that this bound on strain energy is only valid in the absence of any initial stresses or strains. The expression for U in this case can be obtained from Eq. (2.29) as  U  1 eT De dvol 2:36 2
V

which becomes by Eq. (2.2) simply   T 1 T U  2a B DB dvol a  1 aT Ka 2
V

2:37

a `quadratic' matrix form in which K is the `stiness' matrix previously discussed.

An example

35

The above energy expression is always positive from physical considerations. It follows therefore that the matrix K occurring in all the ®nite element assemblies is not only symmetric but is `positive de®nite' (a property de®ned in fact by the requirements that the quadratic form should always be greater than or equal to zero). This feature is of importance when the numerical solution of the simultaneous equations involved is considered, as simpli®cations arise in the case of `symmetric positive de®nite' equations.

2.9 Direct minimization
The fact that the ®nite element approximation reduces to the problem of minimizing the total potential energy Å de®ned in terms of a ®nite number of nodal parameters led us to the formulation of the simultaneous set of equations given symbolically by Eq. (2.31). This is the most usual and convenient approach, especially in linear solutions, but other search procedures, now well developed in the ®eld of optimization, could be used to estimate the lowest value of Å. In this text we shall continue with the simultaneous equation process but the interested reader could well bear the alternative possibilities in mind.24;25

2.10 An example
The concepts discussed and the general formulation cited are a little abstract and readers may at this stage seek to test their grasp of the nature of the approximations derived. While detailed computations of a two-dimensional element system are performed using the computer, we can perform a simple hand calculation on a onedimensional ®nite element of a beam. Indeed, this example will allow us to introduce the concept of generalized stresses and strains in a simple manner. Consider the beam shown in Fig. 2.5. The generalized `strain' here is the curvature. Thus we have eÿ d2 w dx2

where w is the de¯ection, which is the basic unknown. The generalized stress (in the absence of shear deformation) will be the bending moment M, which is related to the `strain' as r  M  ÿEI d2 w dx2

Thus immediately we have, using the general notation of previous sections, D  EI If the displacement w is discretized we can write w  Na for the whole system or, for an individual element, ij.

36 A direct approach to problems in elasticity
P

k

i x w L i di =
wi wxi

j

L

L j

≡

wi θi

di =

wj wxj

≡

wj θj

Shape functions For wi For θi

Fig. 2.5 A beam element and its shape functions.

In this example the strains are expressed as the second derivatives of displacement and it is necessary to ensure that both w and its slope dw  dx be continuous between elements. This is easily accomplished if the nodal parameters are taken as the values of w and the slope, . Thus,   wi ai  i wx  The shape functions will now be derived. If we accept that in an element two nodes (i.e., four variables) de®ne the de¯ected shape we can assume this to be given by a cubic x where s  : w  1  2 s  3 s2  4 s3 L This will de®ne the shape functions corresponding to wi and i by taking for each a cubic giving unity for the appropriate points x  0, L or s  0; 1 and zero for other quantities, as shown in Fig. 2.5. The expressions for the shape functions can be written for the element shown as Ni  1 ÿ 3s2  2s3 ; Ls ÿ 2s2  s3  Nj  3s2 ÿ 2s3 ; Lÿs2  s3  Immediately we can write Bi  ÿ Bi  ÿ d2 Ni 1  2 6 ÿ 12s; L4 ÿ 6s dx2 L d2 Nj 1  2 ÿ6  12s; L2 ÿ 6s dx2 L

References

37

and the stiness matrices for the element can be 2 12 L 6 6L EI 6 Ke  BT EI Bj dx  3 6 ij i L 4 ÿ12 0 6L

written as 6L 4L2 ÿ6L 2L2 ÿ12 ÿ6L 12 ÿ6L 6L

3

2L2 7 7 7 ÿ6L 5 4L2

We shall leave the detailed calculation of this and the `forces' corresponding to a uniformly distributed load p (assumed constant on ij and zero elsewhere) to the reader. It will be observed that the ®nal assembled equations for a node i are of the form linking three nodal displacements i; j; k. Explicitly these equations are for elements of equal length L:       ÿ12=L3 ; ÿ6=L2 24=L3 ; 0 wi wk EI  EI 2 k i 0; 8=L 6=L ; 2=L      ÿ12=L3 ; 6=L2 pL=2 wj  EI  0 ÿpL2 =12 j ÿ6=L2 ; 2=L It is of interest to compare these with the exact form represented by the so-called `slope±de¯ection' equations which can be found in standard texts on structural analysis. Here it will be found that the ®nite element approximation has achieved the exact solution at nodes for a uniform load. We show in Chapter 3 and in Appendix H reasons for this unexpected result.

2.11 Concluding remarks
The `displacement' approach to the analysis of elastic solids is still undoubtedly the most popular and easily understood procedure. In many of the following chapters we shall use the general formulae developed here in the context of linear elastic analysis (Chapters 4, 5, and 6). These are also applicable in the context of nonlinear analysis, the main variants being the de®nitions of the stresses, generalized strains, and other associated quantities. It is thus convenient to summarize the essential formulae, and this is done in Appendix C. In Chapter 3 we shall show that the procedures developed here are but a particular case of ®nite element discretization applied to the governing equilibrium equations written in terms of displacements.26 Clearly, alternative starting points are possible. Some of these will be mentioned in Chapters 11 and 12.

References
1. R.W. Clough. The ®nite element in plane stress analysis. Proc. 2nd ASCE Conf. on Electronic Computation. Pittsburgh, Pa., Sept. 1960. 2. R.W. Clough. The ®nite element method in structural mechanics. Chapter 7 of Stress Analysis (eds O.C. Zienkiewicz and G.S. Holister), Wiley, 1965.

38 A direct approach to problems in elasticity
3. J. Szmelter. The energy method of networks of arbitrary shape in problems of the theory of elasticity. Proc. IUTAM Symposium on Non-Homogeneity in Elasticity and Plasticity (ed. W. Olszak), Pergamon Press, 1959. 4. R. Courant. Variational methods for the solution of problems of equilibrium and vibration. Bull. Am. Math. Soc., 49, 1±23, 1943. 5. W. Prager and J.L. Synge. Approximation in elasticity based on the concept of function space. Quart. Appl. Math., 5, 241±69, 1947. 6. S. Timoshenko and J.N. Goodier. Theory of Elasticity. 2nd ed., McGraw-Hill, 1951. 7. K. Washizu. Variational Methods in Elasticity and Plasticity. 2nd ed., Pergamon Press, 1975. 8. J.W. Strutt (Lord Rayleigh). On the theory of resonance. Trans. Roy. Soc. (London), A161, 77±118, 1870. È 9. W. Ritz. Uber eine neue Methode zur Losung gewissen Variations ± Probleme der È mathematischen Physik. J. Reine angew. Math., 135, 1±61, 1909. 10. G.P. Bazeley, Y.K. Cheung, B.M. Irons, and O.C. Zienkiewicz. Triangular elements in bending ± conforming and non-conforming solutions. Proc. Conf. Matrix Methods in Structural Mechanics. Air Force Inst. Tech., Wright-Patterson AF Base, Ohio, 1965. 11. S.C. Mikhlin. The Problem of the Minimum of a Quadratic Functional. Holden-Day, 1966. 12. M.W. Johnson and R.W. McLay. Convergence of the ®nite element method in the theory of elasticity. J. Appl. Mech.. Trans. Am. Soc. Mech. Eng., 274±8, 1968. 13. P.G. Ciarlet. The Finite Element Method for Elliptic Problems. North-Holland, Amsterdam, 1978. 14. T.H.H. Pian and Ping Tong. The convergence of ®nite element method in solving linear elastic problems. Int. J. Solids Struct., 3, 865±80, 1967. 15. E.R. de Arrantes Oliveira. Theoretical foundations of the ®nite element method. Int. J. Solids Struct., 4, 929±52, 1968. 16. G. Strang and G.J. Fix. An Analysis of the Finite Element Method. p. 106, Prentice-Hall, 1973. 17. L.F. Richardson. The approximate arithmetical solution by ®nite dierences of physical problems. Trans. Roy. Soc. (London), A210, 307±57, 1910. 18. B. N. Irons and A. Razzaque. Experience with the patch test, in Mathematical Foundations of the Finite Element Method (ed. A.R. Aziz), pp. 557±87, Academic Press, 1972. 19. B. Fraeijs de Veubeke. Variational principles and the patch test. Int. J. Num. Meth. Eng., 8, 783±801, 1974. 20. R.L. Taylor, O.C. Zienkiewicz, J.C. Simo, and A.H.C. Chan. The patch test ± a condition for assessing FEM convergence. Int. J. Numer. Methods Engrg., 22, 39±62, 1986. 21. O.C. Zienkiewicz, S. Qu, R.L. Taylor, and S. Nakazawa. The patch test for mixed formulations. Int. J. Numer. Methods Engrg., 23, 1873±83, 1986. 22. O.C. Zienkiewicz and R.L. Taylor. The ®nite element patch test revisited. A computer test for convergence, validation and error estimates. Comp. Meth. Appl. Mech. and Engrg., 149, 223±54, 1997. 23. B. Fraeijs de Veubeke. Displacement and equilibrium models in the ®nite element method. Chapter 9 of Stress Analysis (eds O.C. Zienkiewicz and G.S. Holister), Wiley, 1965. 24. R.L. Fox and E.L. Stanton. Developments in structural analysis by direct energy minimization. JAIAA. 6, 1036±44, 1968. 25. F.K. Bogner, R.H. Mallett, M.D. Minich, and L.A. Schmit. Development and evaluation of energy search methods in non-linear structural analysis. Proc. Conf. Matrix Methods in Structural Mechanics. Air Force Inst. Tech., Wright-Patterson AF Base, Ohio, 1965. 26. O.C. Zienkiewicz and K. Morgan. Finite Elements and Approximation. Wiley, 1983.

3 Generalization of the ®nite element concepts. Galerkin-weighted residual and variational approaches
3.1 Introduction
We have so far dealt with one possible approach to the approximate solution of the particular problem of linear elasticity. Many other continuum problems arise in engineering and physics and usually these problems are posed by appropriate dierential equations and boundary conditions to be imposed on the unknown function or functions. It is the object of this chapter to show that all such problems can be dealt with by the ®nite element method. Posing the problem to be solved in its most general terms we ®nd that we seek an unknown function u such that it satis®es a certain dierential equation set 9 8 > A1 u > = < 3:1 Au  A2 u  0 > F > : F ; F in a `domain' (volume, area, etc.)  (Fig. 3.1), together with certain boundary conditions 9 8 > B1 u > = < Bu  B2 u  0 3:2 > F > : F ; F on the boundaries ÿ of the domain (Fig. 3.1). The function sought may be a scalar quantity or may represent a vector of several variables. Similarly, the dierential equation may be a single one or a set of simultaneous equations and does not need to be linear. It is for this reason that we have resorted to matrix notation in the above. The ®nite element process, being one of approximation, will seek the solution in the approximate form n X u% u Ni ai  Na 3:3
i1

40 Generalization of the ®nite element concepts
Γe

y Ω A (u) = 0

B (u) = 0

Subdomain Ω e (element) Γ x

Fig. 3.1 Problem domain  and boundary ÿ.

where Ni are shape functions prescribed in terms of independent variables (such as the coordinates x, y, etc.) and all or most of the parameters ai are unknown. We have seen that precisely the same form of approximation was used in the displacement approach to elasticity problems in the previous chapter. We also noted there that (a) the shape functions were usually de®ned locally for elements or subdomains and (b) the properties of discrete systems were recovered if the approximating eqations were cast in an integral form [viz. Eqs (2.22)±(2.26)]. With this object in mind we shall seek to cast the equation from which the unknown parameters ai are to be obtained in the integral form   Gj  d  gj  dÿ  0 u u j  1 to n 3:4
 ÿ

in which Gj and gj prescribe known functions or operators. These integral forms will permit the approximation to be obtained element by element and an assembly to be achieved by the use of the procedures developed for standard discrete systems in Chapter 1, since, providing the functions Gj and gj are integrable, we have     m X Gj d  gj dÿ  Gj d  gj dÿ  0 3:5
 ÿ e1 e ÿe

where e is the domain of each element and ÿe its part of the boundary. Two distinct procedures are available for obtaining the approximation in such integral forms. The ®rst is the method of weighted residuals (known alternatively as the Galerkin procedure); the second is the determination of variational functionals for which stationarity is sought. We shall deal with both approaches in turn. If the dierential equations are linear, i.e., if we can write (3.1) and (3.2) as Au  Lu  p  0 Bu  Mu  t  0 in  on ÿ 3:6 3:7

Introduction

41

then the approximating equation system (3.4) will yield a set of linear equations of the form Ka  f  0 with Kij 
m X e1

3:8

Ke ij

fi 

m X e1

fe i

3:9

The reader not used to abstraction may well now be confused about the meaning of the various terms. We shall introduce here some typical sets of dierential equations for which we will seek solutions (and which will make the problems a little more de®nite). Example 1. Steady-state heat conduction equations in a two-dimensional domain:     @ @ @ @ A  k  k Q0 @x @x @y @y " B   ÿ   0 or B  k @ " q0 @n on ÿ on ÿq 3:10

" " where u   indicates temperature, k is the conductivity, Q is a heat source,  and q are the prescribed values of temperature and heat ¯ow on the boundaries and n is the direction normal to ÿ. In the above problem k and Q can be functions of position and, if the problem is non-linear, of  or its derivatives. Example 2. Steady-state heat conduction±convection equation in two dimensions:     @ @ @ @ @ @ A   uy Q0 3:11 k  k  ux @x @x @y @y @x @y with boundary conditions as in the ®rst example. Here ux and uy are known functions of position and represent velocities of an incompressible ¯uid in which heat transfer occurs. Example 3. A system of three ®rst order equations equivalent to Example 1: 9 8 > > @qx @qy > > >   Q> > > > > @x @y > > > > = < @ 0 Au  qx  k > @x > > > > > > > > > > > > qy  k @ > ; : @y

3:12

42 Generalization of the ®nite element concepts

in  and

" Bu   ÿ   0 "  qn ÿ q  0

on ÿ on ÿq

where qn is the ¯ux normal to the boundary. Here the unknown function vector u corresponds to the set 8 9 >> < = u  qx > > : ; qy This last example is typical of a so-called mixed formulation. In such problems the number of dependent unknowns can always be reduced in the governing equations by suitable algebraic operations, still leaving a solvable problem [e.g., obtaining Eq. (3.10) from (3.12) by eliminating qx and qy ]. If this cannot be done [viz. Eq. (3.10)] we have an irreducible formulation. Problems of mixed form present certain complexities in their solution which we shall discuss in Chapters 11±13. In Chapter 7 we shall return to detailed examples of the above ®eld problems, and other examples will be introduced throughout the book. The three sets of problems will, however, be useful in their full form or reduced to one dimension (by suppressing the y variable) to illustrate the various approaches used in this chapter.

Weighted residual methods 3.2 Integral or `weak' statements equivalent to the differential equations
As the set of dierential equations (3.1) has to be zero at each point of the domain , it follows that   vT Au d  v1 A1 u  v2 A2 u  Á Á Á d  0 3:13
 

where

8 9 > v1 > < = v  v2 > F > : F ; F

3:14

is a set of arbitrary functions equal in number to the number of equations (or components of u) involved. The statement is, however, more powerful. We can assert that if (3.13) is satis®ed for all v then the dierential equations (3.1) must be satis®ed at all points of the domain. The proof of the validity of this statement is obvious if we consider the possibility that Au T 0 at any point or part of the domain. Immediately, a function v can be found which makes the integral of (3.13) non-zero, and hence the point is proved.

Integral or `weak' statements equivalent to the differential equations

43

If the boundary conditions (3.12) are to be simultaneously satis®ed, then we require that   "T Bu dÿ  "1 B1 u  v2 B2 u  Á Á Á dÿ  0 " v 3:15 v
ÿ ÿ

for any set of functions ". v Indeed, the integral statement that   T v Au d  "T Bu dÿ  0 v
 ÿ

3:16

is satis®ed for all v and " is equivalent to the satisfaction of the dierential equations v (3.1) and their boundary conditions (3.2). In the above discussion it was implicitly assumed that integrals such as those in Eq. (3.16) are capable of being evaluated. This places certain restrictions on the possible families to which the functions v or u must belong. In general we shall seek to avoid functions which result in any term in the integrals becoming in®nite. Thus, in Eq. (3.16) we generally limit the choice of v and " to bounded functions v without restricting the validity of previous statements. What restrictions need to be placed on the functions? The answer obviously depends on the order of dierentiation implied in the equations Au [or Bu]. Consider, for instance, a function u which is continuous but has a discontinuous slope in the x-direction, as shown in Fig. 3.2 which is identical to Fig. 2.4 but is reproduced here for clarity. We imagine this discontinuity to be replaced by a continuous variation in a very small distance Á (a process known as `moli®cation') and study the behaviour of the derivatives. It is easy to see that although the ®rst derivative is not de®ned here, it has ®nite value and can be integrated easily but the second derivative tends to in®nity. This therefore presents diculties if integrals are to be evaluated numerically by simple means, even though the integral is ®nite. If such derivatives are multiplied by each other the integral does not exist and the function is known as non-square integrable. Such a function is said to be C0 continuous. In a similar way it is easy to see that if nth-order derivatives occur in any term of A or B then the function has to be such that its n ÿ 1 derivatives are continuous (Cn ÿ 1 continuity). On many occasions it is possible to perform an integration by parts on Eq. (3.16) and replace it by an alternative statement of the form   T Cv Du d  E"T Fu dÿ  0 v 3:17
 ÿ

In this the operators C to F usually contain lower order derivatives than those occurring in operators A or B. Now a lower order of continuity is required in the choice of the u function at a price of higher continuity for v and ". v The statement (3.17) is now more `permissive' than the original problem posed by Eqs (3.1), (3.2), or (3.16) and is called a weak form of these equations. It is a somewhat surprising fact that often this weak form is more realistic physically than the original dierential equation which implied an excessive `smoothness' of the true solution. Integral statements of the form of (3.16) and (3.17) will form the basis of ®nite element approximations, and we shall discuss them later in fuller detail. Before doing so we shall apply the new formulation to an example.

44 Generalization of the ®nite element concepts
∆ ‘Smoothing’ zone

u

du dx

d2u dx 2

–∞

Fig. 3.2 Differentiation of function with slope discontinuity (C0 continuous).

Example. Weak form of the heat conduction equation ± forced and natural boundary conditions. Consider now the integral form of Eq. (3.10). We can write the statement (3.16) as           @ @ @ @ @ " "  q dÿ  0 3:18 v v k k  k  Q dx dy  @x @x @y @y @n  ÿq " noting that v and v are scalar functions and presuming that one of the boundary conditions, i.e., " ÿ0 is automatically satis®ed by the choice of the functions  on ÿ . Equation (3.18) can now be integrated by parts to obtain a weak form similar to Eq. (3.17). We shall make use here of general formulae for such integration (Green's formulae) which we derive in Appendix G and which on many occasions will be

Integral or `weak' statements equivalent to the differential equations

45

useful, i.e.          @ @ @v @ @ v k dx dy  ÿ k dx dy  v k n dÿ @x @x @x x  @x  @x ÿ          @ @ @v @ @ v k dx dy  ÿ k dx dy  v k n dÿ @y @y @y y  @y  @y ÿ We have thus in place of Eq. (3.18)       @v @ @v @ @ @ k  k ÿ vQ dx dy  vk n  n dÿ ÿ @x @x @y @y @x x @y y  ÿ    @ " "  q dÿ  0 v k  @n ÿq Noting that the derivative along the normal is given as @ @ @  n  n @n @x x @y y and, further, making " v  ÿv on ÿ

3:19

3:20

3:21

3:22

without loss of generality (as both functions are arbitrary), we can write Eq. (3.20) as     @ T " dÿ  0 3:23 r v kr d ÿ v Q d ÿ v q dÿ ÿ vk @n   ÿq ÿ where the operator r is simply 8 9 > @ > > > < = @x r > @ > > > : ; @y

We note that (a) the variable  has disappeared from the integrals taken along the boundary ÿq and that the boundary condition B  k @ " q0 @n

on that boundary is automatically satis®ed ± such a condition is known as a natural boundary condition ± and (b) if the choice of  is restricted so as to satisfy the forced boundary conditions "  ÿ   0, we can omit the last term of Eq. (3.23) by restricting the choice of v to functions which give v  0 on ÿ . The form of Eq. (3.23) is the weak form of the heat conduction statement equivalent to Eq. (3.17). It admits discontinuous conductivity coecients k and temperature  which show discontinuous ®rst derivatives, a real possibility not admitted in the dierential form.

46 Generalization of the ®nite element concepts

3.3 Approximation to integral formulations: the weighted residual Galerkin method
If the unknown function u is approximated by the expansion (3.3), i.e., n X Ni ai  Na u% u
i1

then it is clearly impossible to satisfy both the dierential equation and the boundary conditions in the general case. The integral statements (3.16) or (3.17) allow an approximation to be made if, in place of any function v, we put a ®nite set of approximate functions n n X X " " v wj aj 3:24 v wj aj
j1 j 1

in which aj are arbitrary parameters and n is the number of unknowns entering the problem. Inserting the above approximations into Eq. (3.16) we have    "j wT ANa d  wT BNa dÿ  0 aT j j
 ÿ

and since aj is arbitrary we have a set of equations which is sucient to determine the parameters aj as   "j wT ANa d  wT BNa dÿ  0 j  1 to n 3:25 j
 ÿ

or, from Eq. (3.17),   Cwj T DNa d  E" j T FNa dÿ  0 w
 ÿ

j  1 to n

3:26

If we note that ANa represents the residual or error obtained by substitution of the approximation into the dierential equation [and BNa, the residual of the boundary conditions], then Eq. (3.25) is a weighted integral of such residuals. The approximation may thus be called the method of weighted residuals. In its classical sense it was ®rst described by Crandall,1 who points out the various Â forms used since the end of the last century. More recently a very full expose of the method has been given by Finlayson.2 Clearly, almost any set of independent functions wj could be used for the purpose of weighting and, according to the choice of function, a dierent name can be attached to each process. Thus the various common choices are: 1. Point collocation.3 wj  dj , where dj is such that for x T xj ; y T yj , wj  0 but   wj d  I (unit matrix). This procedure is equivalent to simply making the residual zero at n points within the domain and integration is `nominal' (incidentally although wj de®ned here does not satisfy all the criteria of Sec. 3.2, it is nevertheless admissible in view of its properties). 2. Subdomain collocation.4 wj  I in j and zero elsewhere. This essentially makes the integral of the error zero over the speci®ed subdomains.

Approximation to integral formulations: the weighted residual Galerkin method

47

3. The Galerkin method (Bubnov±Galerkin).5;6 wj  Nj . Here simply the original shape (or basis) functions are used as weighting. This method, as we shall see, frequently (but by no means always) leads to symmetric matrices and for this and other reasons will be adopted in our ®nite element work almost exclusively. The name of `weighted residuals' is clearly much older than that of the `®nite element method'. The latter uses mainly locally based (element) functions in the expansion of Eq. (3.3) but the general procedures are identical. As the process always leads to equations which, being of integral form, can be obtained by summation of contributions from various subdomains, we choose to embrace all weighted residual approximations under the name of generalized ®nite element method. Frequently, simultaneous use of both local and `global' trial functions will be found to be useful. In the literature the names of Petrov and Galerkin5 are often associated with the use of weighting functions such that wj T Nj . It is important to remark that the well-known ®nite dierence method of approximation is a particular case of collocation with locally de®ned basis functions and is thus a case of a Petrov±Galerkin scheme. We shall return to such unorthodox de®nitions in more detail in Chapter 16. To illustrate the procedure of weighted residual approximation and its relation to the ®nite element process let us consider some speci®c examples. Example 1. One-dimensional equation of heat conduction (Fig. 3.3). The problem here will be a one-dimensional representation of the heat conduction equation [Eq. (3.10)] with unit conductivity. (This problem could equally well represent many other physical situations, e.g., deformation of a loaded string.) Here we have A  d2   Q  0 0 4 x 4 L dx2 3:27

with Q  Qx given by Q  1 0 4 x < L=2 and Q  0 L=2 4 x 4 L. The boundary conditions assumed will be simply   0 at x  0 and x  L. In the ®rst case we shall consider a one- or two-term approximation of the Fourier series form, i.e., X x x  % ai sin i Ni  sin i 3:28 L L with i  1 and i  1 and 2. These satisfy the boundary conditions exactly and are continuous throughout the domain. We can thus use either Eq. (3.16) or Eq. (3.17) for the approximation with equal validity. We shall use the former, which allows various weighting functions to be adopted. In Fig. 3.3 we present the problem and its solution using point collocation, subdomain collocation, and the Galerkin method.y As the chosen expansion satis®es a priori the boundary conditions there is no need to introduce them into the formulation, which is given simply by   L  2  X d Ni ai  Q dx  0 wj 3:29 dx2 0 The full working out of this problem is left as an exercise to the reader.
y In the case of point collocation using i  1 xi  L=2 a diculty arises about the value of Q (as this is either zero or one). The value of 1 was therefore used for the example. 2

48 Generalization of the ®nite element concepts
Q=1 L/2 N1 = W1 (Galerkin) 1 x ∞ W1 Point collocation x W1 Subdomain collocation x Q=0 L/2 N1 = sin
πx L

φ=0

φ=0

1

2.5 Subdomain collocation Exact 2.0 φ 10π L
2

Galerkin

1.5

1.0 Point collocation 0.5

0

0

x/L

1.0

Fig. 3.3 One-dimensional heat conduction. (a) One-term solution using different weighting procedures.

Approximation to integral formulations: the weighted residual Galerkin method
N1 = sin
πx L

49

1

N1 = W1 (Galerkin)

1

N2 = W2 (Galerkin)

N2 = sin 1

2πx L

W1

Point collocation

W2

1

W1

Subdomain collocation

W2

1

2.5

Subdomain collocation

Point collocation 2.0 φ 10π L
2

Galerkin

1.5

Exact 1.0

0.5

0 0 x/L 1.0

Fig. 3.3 (cont.) (b) Two-term solutions using different weighting procedures.

50 Generalization of the ®nite element concepts

Of more interest to the standard ®nite element ®eld is the use of piecewise de®ned (locally based) functions in place of the global functions of Eq. (3.28). Here, to avoid imposing slope continuity, we shall use the equivalent of Eq. (3.17) obtained by integrating Eq. (3.29) by parts. This yields    L  dwj X dNi a ÿ wj Q dx  0 3:30 dx dx i 0 i The boundary terms disappear identically if wj  0 at the two ends. The above equations can be written as Ka  f  0 where for each `element' of length L ,  Le dwj dNi e dx Kji  0 dx dx  Le fe  ÿ wj Q dx j
0 e

3:31

3:32

with the usual rules of addition pertaining, i.e., X e X e Kji  Kji fj  fj
e e

3:33

In the computation we shall use the Galerkin procedure, i.e. wj  Nj , and the reader will observe that the matrix K is then symmetric, i.e., Kij  Kji . As the shape functions need only be of C0 continuity, a piecewise linear approximation is conveniently used, as shown in Fig. 3.4. Considering a typical element ij shown, we can write (moving the origin of x to point i) Nj  giving, for a typical element, Kii  Kjj 
e j e

x Le

Ni 

Le ÿ x Le

3:34

1  ÿKji  ÿKij Le
e e i

3:35

f  ÿ Q L =2  f
e

where Q is the value for element e. Assembly of a typical equation at a node i is left to the reader, who is well advised to carry out the calculations leading to the results shown in Fig. 3.4 for a two- and fourelement subdivision. Some points of interest immediately arise if the results of Figs 3.3 and 3.4 are compared. With smooth global shape functions the Galerkin method gives better overall results than those achieved for the same number of unknown parameters a with locally based functions. This we shall ®nd to be the general case with higher order approximations, yielding better accuracy. Further, it will be observed that the linear approximation has given the exact answers at the interelement nodal points. This is a property of the particular equation being solved and unfortunately does not carry over to general problems.7 (See also Appendix H.) Lastly, the

Approximation to integral formulations: the weighted residual Galerkin method

51

Ni i Le j

Nj

1 x

2.5

2.0 φ 10π L2 1.5 Four elements Exact

1.0 Two elements 0.5

0

0

x/L

1.0

Fig. 3.4 Galerkin ®nite element solution of problem of Fig. 3.3 using linear locally based shaped functions.

reader will observe how easy it is to create equations with any degree of subdivision once the element properties [Eq. (3.35)] have been derived. This is not the case with global approximation where new integrations have to be carried out for each new parameter introduced. It is this repeatability feature that is one of the advantages of the ®nite element method. Example 2. Steady-state heat conduction±convection in two dimensions. The Galerkin formulation. We have already introduced the problem in Sec. 3.1 and de®ned it by Eq. (3.11) with appropriate boundary conditions. The equation diers only in the convective terms from that of simple heat conduction for which the weak form has already been obtained in Eq. (3.23). We can write the weighted residual equation immediately from this, substituting v  wj aj and adding the convective terms. Thus we have        T  d ÿ wj ux @   uy @  d ÿ wj Q d ÿ " r wj kr wj q dÿ  0 3:36 @x @y    ÿq

52 Generalization of the ®nite element concepts

 P " with   Ni ai being such that the prescribed values of  are given on the boundary ÿ and that aj  0 on that boundary (ignoring that term in (3.36)). Specializing to the Galerkin approximation, i.e., putting wj  Nj , we have immediately a set of equations of the form Ka  f  0 with  Kji 


3:37  d

rT Nj krNi d ÿ

 


Nj ux

 @Nj @Ni @Nj @Ni k  k  d @x @x @y @y     @Ni @Ni  N j uy Nj ux ÿ d @x @y    " Nj q dÿ fj  ÿ Nj Q d ÿ
 ÿq

 

@Ni @Ni  N j uy @x @y

3:38a 3:38b

Once again the components Kji and fj can be evaluated for a typical element or subdomain and systems of equations built up by standard methods. At this point it is important to mention that to satisfy the boundary conditions some of the parameters ai have to be prescribed and the number of approximation equations must be equal to the number of unknown parameters. It is nevertheless often convenient to form all equations for all parameters and prescribe the ®xed values at the end using precisely the same techniques as we have described in Chapter 1 for the insertion of prescribed boundary conditions in standard discrete problems. A further point concerning the coecients of the matrix K should be noted here. The ®rst part, corresponding to the pure heat conduction equation, is symmetric Kij  Kji  but the second is not and thus a system of non-symmetric equations needs to be solved. There is a basic reason for such non-symmetries which will be discussed in Sec. 3.9. To make the problem concrete consider the domain  to be divided into regular square elements of side h (Fig. 3.5). To preserve C0 continuity with nodes placed at corners, shape functions given as the product of the linear expansions can be written. For instance, for node i, as shown in Fig. 3.5, Ni  and for node j, Nj  h ÿ x y ; h h etc: xy hh

With these shape functions the reader is invited to evaluate typical element contributions and to assemble the equations for point 1 of the mesh numbered as

Virtual work as the `weak form' of equilibrium equations for analysis of solids or ¯uids
Nj y Ni 1 j i

53

x h h (a) 5 4 3

6

1

2

7

8

9

(b)

Fig. 3.5 A linear square element of C0 continuity. (a) Shape functions for a square element. (b) `Connected' equation for node 1.

shown in Fig. 3.5. The result will be (if no boundary of type ÿq is present and Q is assumed to be constant)       8 1 ux h uy h 1 ux h uy h 1 ux h uy h a1 ÿ ÿ ÿ ÿ ÿ ÿ ÿ a2 ÿ a3 ÿ a4 6k 3k 3 3 3k 3 12k 12k 3 6k       1 ux h uy h 1 ux h uy h 1 ux h uy h  ÿ  ÿ   ÿ a ÿ a6 ÿ a 6k 3 12k 12k 5 3 3k 3 12k 12k 7     1 ux h uy h 1 ux h uy h ÿ    ÿ 3:39 a8 ÿ a  4h2 Q 3k 3 6k 3 12k 12k 9 This equation is similar to those that would be obtained by using ®nite dierence approximations to the same equations in a fairly standard manner.8;9 In the example discussed some diculties arise when the convective terms are large. In such cases the Galerkin weighting is not acceptable and other forms have to be used. This is discussed in detail in Chapter 2 of the third volume.

3.4 Virtual work as the `weak form' of equilibrium equations for analysis of solids or ¯uids
In Chapter 2 we introduced a ®nite element by way of an application to the solid mechanics problem of linear elasticity. The integral statement necessary for

54 Generalization of the ®nite element concepts

formulation in terms of the ®nite element approximation was supplied via the principle of virtual work, which was assumed to be so basic as not to merit proof. Indeed, to many this is so, and the virtual work principle is considered as a statement of mechanics more fundamental than the traditional equilibrium conditions of Newton's laws of motion. Others will argue with this view and will point out that all work statements are derived from the classical laws pertaining to the equilibrium of the particle. We shall therefore show in this section that the virtual work statement is simply a `weak form' of equilibrium equations. In a general three-dimensional continuum the equilibrium equations of an elementary volume can be written in terms of the components of the symmetric cartesian stress tensor as10 9 8 > @x  @xy  @xz > > > > > 8 9 > @x @y @z > 8 9 > > > > > > bx > > > > A1 > > < = < @ @xy @yz = < = y  by  0  3:40 A   > 2 > > @y @x @z > > > > : ; : ; > > > A3 bz > > > > > @z @xz @yz > > > > > ; :   @z @x @y where bT  bx ; by ; bz  stands for the body forces acting per unit volume (which may well include acceleration eects). In solid mechanics the six stress components will be some general functions of the components of the displacement u  u; v; wT 3:41

and in ¯uid mechanics of the velocity vector u, which has identical components. Thus Eq. (3.40) can be considered as a general equation of the form Eq. (3.1), i.e., Au  0. To obtain a weak form we shall proceed as before, introducing an arbitrary weighting function vector, de®ned as v  u  u; v; wT 3:42

We can now write the integral statement of Eq. (3.13) as       @x @xy @xz    bx  vA2   wA3  d 3:43 uT Au dV  u @x @y @z   where V, the volume, is the problem domain. Integrating each term by parts and rearranging we can write this as      @ @ @ ÿ u  xy u  v  Á Á Á ÿ ubx ÿ vby ÿ wbz d x @x @y @x  3:44   ux nx  xy ny  xz nz   vÁ Á Á  wÁ Á Á dÿ  0
ÿ

where ÿ is the surface area of the solid (here again Green's formulae of Appendix G are used).

Partial discretization

55

In the ®rst set of bracketed terms we can recognize immediately the small strain operators acting on u, which can be termed a virtual displacement (or virtual velocity). We can therefore introduce a virtual strain (or strain rate) de®ned as 9 8 > @ > > u > > > > > @x > > > > > > > > @ > > > = < v >  S u 3:45 e  @y > > > >@ > > > w > > > > > @z > > > > > > > > F ; : F F where the strain operators are de®ned as in Chapter 2 [Eqs (2.2)±(2.4)]. Similarly, the terms in the second integral will be recognized as forces t: t  tx ; ty ; tz T 3:46 acting per unit area of the surface A. Arranging the six stress components in a vector r and similarly the six virtual strain (or rate of virtual strain) components in a vector e, we can write Eq. (3.44) simply as    eT r d ÿ uT b d ÿ uT t dÿ  0 3:47
  ÿ

which is the three dimensional equivalent virtual work statement used in Eqs (2.10) and (2.22) of Chapter 2. We see from the above that the virtual work statement is precisely the weak form of the equilibrium equations and is valid for non-linear as well as linear stress±strain (or stress±rate of strain) relations. The ®nite element approximation which we have derived in Chapter 2 is in fact a Galerkin formulation of the weighted residual process applied to the equilibrium equation. Thus, if we take u as the shape function times arbitrary parameters u  N a where the displacement ®eld is discretized, i.e., X u N i ai 3:48 3:49

together with the constitutive relation of Eq. (2.5), we shall determine once again all the basic expressions of Chapter 2 which are so essential to the solution of elasticity problems. Similar expressions are vital to the formulation of equivalent ¯uid mechanics problems as discussed further in the third volume.

3.5 Partial discretization
In the approximation to the problem of solving the dierential equation (3.1) by an expression of the standard form of Eq. (3.3), we have assumed that the shape functions N included in them are all independent coordinates of the problem

56 Generalization of the ®nite element concepts

and that a was simply a set of constants. The ®nal approximation equations were thus always of an algebraic form, from which a unique set of parameters could be determined. In some problems it is convenient to proceed dierently. Thus, for instance, if the independent variables are x, y and z we could allow the parameters a to be functions " of z and do the approximate expansion only in the domain of x, y, say . Thus, in place of Eq. (3.3) we would have u  Na N  Nx; y a  az Clearly the derivatives of a with respect to z will remain in the ®nal discretization and the result will be a set of ordinary dierential equations with z as the independent variable. In linear problems such a set will have the appearance  Ka  Ca  Á Á Á  f  0  where a  da=dz, etc. Such a partial discretization can obviously be used in dierent ways, but is particu" larly useful when the domain  is not dependent on z, i.e., when the problem is prismatic. In such a case the coecient matrices of the ordinary dierential equations, (3.51), are independent of z and the solution of the system can frequently be carried out eciently by standard analytical methods. This type of partial discretization has been applied extensively by Kantorovitch11 and is frequently known by his name. In the second volume we shall discuss such semi-analytical treatments in the context of prismatic solids where the ®nal solution is obtained in terms of Fourier series. However, the most frequently encountered " `prismatic' problem is one involving the time variable, where the space domain  is not subject to change. We shall address such problems in Chapter 17 of this volume. It is convenient by way of illustration to consider here heat conduction in a two-dimensional equation in its transient state. This is obtained from Eq. (3.10) by addition of the heat storage term c@=@t, where c is the speci®c heat per unit volume. We now have a problem posed in a domain x; y; t in which the following equation holds:     @ @ @ @ @ A  0 3:52 k  k Qÿc @x @x @y @y @t with boundary conditions identical to those of Eq. (3.10) and the temperature is zero at time zero. Taking X  % Ni ai 3:53 with ai  ai t and Ni  Ni x; y and using the Galerkin weighting procedure we follow precisely the steps outlined in Eqs (3.36)±(3.38) and arrive at a system of ordinary dierential equations Ka  C da f0 dt 3:54 3:51 3:50

Partial discretization

57

Here the expression for Kij is identical with that of Eq. (3.38a) (convective terms neglected), fi identical to Eq. (3.38b), and the reader can verify that the matrix C is de®ned by  Cij  Ni cNj dx dy 3:55


Once again the matrix C can be assembled from its element contributions. Various analytical and numerical procedures can be applied simply to the solution of such transient, ordinary, dierential equations which, again, we shall discuss in detail in Chapters 17 and 18. However, to illustrate the detail and the possible advantage of the process of partial discretization, we shall consider a very simple problem. Example. Consider a square prism of size L in which the transient heat conduction equation (3.52) applies and assume that the rate of heat generation varies with time as Q  Q0 eÿt 3:56 (this approximates a problem of heat development due to hydration of concrete). We assume that at t  0,   0 throughout. Further, we shall take   0 on all boundaries throughout all times. As a ®rst approximation a shape function for a one-parameter solution is taken:   N1 a1 x y cos 3:57 L L with x and y measured from the centre (Fig. 3.6). Evaluating the coecients, we have     L=2  L=2   @N1 2 @N1 2 2 k K11  k k dx dy  2 @x @y ÿL=2 ÿL=2  L=2  L=2 L2 c 2 3:58 C11  cN1 dx dy  4 ÿL=2 ÿL=2  L=2  L=2 4Q0 L2 ÿt f1  N1 Q0 eÿt dx dy  e 2 ÿL=2 ÿL=2 N1  cos Thus leads to an ordinary dierential equation with one parameter a1 : C11 da1  K11 a1  f1  0 dt 3:59

with a1  0 when t  0. The exact solution of this is easy to obtain, as is shown in Fig. 3.6 for speci®c values of the parameters  and k=L2 c. On the same ®gure we show a two-parameter solution with 3x 3y cos 3:60 L L which readers can pursue to test their grasp of the problem. The second component of the Fourier series is here omitted due to the required symmetry of solution. The remarkable accuracy of the one-term approximation in this example should be noted. N2  cos

58 Generalization of the ®nite element concepts
0.3 Two-term approximation π2c φ (x = 0, y = 0, t) 16 Q0 2π2 0.2 One-term approximation y k = 1.5 L2c

α=1 Q = Q0 e –αt φ = 0, t = 0 x

0.1 φ=0

0

0

1

2 t

3

4

Fig. 3.6 Two-dimensional transient heat development in a square prism: plot of temperature at centre.

3.6 Convergence
In the previous sections we have discussed how approximate solutions can be obtained by use of an expansion of the unknown function in terms of trial or shape functions. Further, we have stated the necessary conditions that such functions have to ful®l in order that the various integrals can be evaluated over the domain. Thus if various integrals contain only the values of N or its ®rst derivatives then N has to be C0 continuous. If second derivatives are involved, C1 continuity is needed, etc. The problem to which we have not yet addressed ourselves consists of the questions of just how good the approximation is and how it can be systematically improved to approach the exact answer. The ®rst question is more dicult to answer and presumes knowledge of the exact solution (see Chapter 14). The second is more rational and can be answered if we consider some systematic way in which the number of parameters a in the standard expansion of Eq. (3.3),  u
n X 1

N i ai

is presumed to increase. In some of the examples we have assumed, in eect, a trigonometric Fourier-type series limited to a ®nite number of terms with a single form of trial function assumed over the whole domain. Here addition of new terms would be simply an extension of the number of terms in the series included in the analysis, and as the Fourier series is known to be able to represent any function within any accuracy desired as the number of terms increases, we can talk about convergence of the approximation to the true solution as the number of terms increases.

Convergence 59

In other examples of this chapter we have used locally based functions which are fundamental in the ®nite element analysis. Here we have tacitly assumed that convergence occurs as the size of elements decreases and, hence, the number of a parameters speci®ed at nodes increases. It is with such convergence that we need to be concerned and we have already discussed this in the context of the analysis of elastic solids in Chapter 2 (Sec. 2.6). We have now to determine (a) that, as the number of elements increases, the unknown functions can be approximated as closely as required, and (b) how the error decreases with the size, h, of the element subdivisions (h is here some typical dimension of an element). The ®rst problem is that of completeness of the expansion and we shall here assume that all trial functions are polynomials (or at least include certain terms of a polynomial expansion). Clearly, as the approximation discussed here is to the weak, integral form typi®ed by Eqs (3.13) or (3.17) it is necessary that every term occurring under the integral be in the limit capable of being approximated as nearly as possible and, in particular, giving a single constant value over an in®nitesimal part of the domain . If a derivative of order m exists in any such term, then it is obviously necessary for the local polynomial to be at least of the order m so that, in the limit, such a constant value can be obtained. We will thus state that a necessary condition for the expansion to be covergent is the criterion of completeness: that a constant value of the mth derivative be attainable in the element domain (if mth derivatives occur in the integral form) when the size of any element tends to zero. This criterion is automatically ensured if the polynomials used in the shape function N are complete to mth order. This criterion is also equivalent to the one of constant strain postulated in Chapter 2 (Sec. 2.5). This, however, has to be satis®ed only in the limit h 3 0. If the actual order of a complete polynomial used in the ®nite element expansion is p 5 m, then the order of convergence can be ascertained by seeing how closely such a polynomial can follow the local Taylor expansion of the unknown u. Clearly the order of error will be simply Oh p  1  since only terms of order p can be rendered correctly. Knowledge of the order of convergence helps in ascertaining how good the approximation is if studies on several decreasing mesh sizes are conducted. Though, in Chapter 15, we shall see this asymptotic convergence rate is seldom reached if singularities occur in the problem. Once again we have reestablished some of the conditions discussed in Chapter 2. We shall not discuss, at this stage, approximations which do not satisfy the postulated continuity requirements except to remark that once again, in many cases, convergence and indeed improved results can be obtained (see Chapter 10). In the above we have referred to the convergence of a given element type as its size is reduced. This is sometimes referred to as h convergence. On the other hand, it is possible to consider a subdivision into elements of a given size and to obtain convergence to the exact solution by increasing the polynomial order p of each element. This is referred to as p convergence, which is obviously

60 Generalization of the ®nite element concepts

assured. In general p convergence is more rapid per degree of freedom introduced. We shall discuss both types further in Chapter 15.

Variational principles 3.7 What are `variational principles'?
What are variational principles and how can they be useful in the approximation to continuum problems? It is to these questions that the following sections are addressed. First a de®nition: a `variational principle' speci®es a scalar quantity (functional) Å, which is de®ned by an integral form       @u @u Å  F u; ; F F F d  E u; ; F F F dÿ 3:61 @x @x  ÿ in which u is the unknown function and F and E are speci®ed dierential operators. The solution to the continuum problem is a function u which makes Å stationary with respect to arbitrary changes u. Thus, for a solution to the continuum problem, the `variation' is Å  0 3:62 for any u, which de®nes the condition of stationarity.12 If a `variational principle' can be found, then means are immediately established for obtaining approximate solutions in the standard, integral form suitable for ®nite element analysis. Assuming a trial function expansion in the usual form [Eq. (3.3)] u% u
n X 1

N i ai

we can insert this into Eq. (3.61) and write Å  @Å @Å @Å a  a  Á Á Á  a  0 @a1 1 @a2 2 @an n 3:63

This being true for any variations a yields a set of equations 9 8 > @Å > > > > > > @a1 > > > = < @Å F F  F >0 @a > > > > @Å > > > > > ; : @an

3:64

from which parameters ai are found. The equations are of an integral form necessary for the ®nite element approximation as the original speci®cation of Å was given in terms of domain and boundary integrals. The process of ®nding stationarity with respect to trial function parameters a is an old one and is associated with the names of Rayleigh13 and Ritz.14 It has become

What are `variational principles'?

61

extremely important in ®nite element analysis which, to many investigators, is typi®ed as a `variational process'. If the functional Å is `quadratic', i.e., if the function u and its derivatives occur in powers not exceeding 2, then Eq. (3.64) reduces to a standard linear form similar to Eq. (3.8), i.e., @Å  Ka  f  0 @a 3:65

It is easy to show that the matrix K will now always be symmetric. To do this let us consider a linearization of the vector @Å=@a. This we can write as     2 3 @ @Å @ @Å   Áa1 ; Áa2 ; F F F 7 @Å 6 @a2 @a1 Á 3:66  4 @a1 @a1 5  KT Áa @a F F F in which KT is generally known as the tangent matrix, of signi®cance in non-linear analysis, and Áaj are small incremental changes to a. Now it is easy to see that KTij  @2Å  KT Tji @ai @aj 3:67

Hence KT is symmetric. For a quadratic functional we have, from Eq. (3.65),   @Å Á  K Áa or K  KT @a

3:68

and hence symmetry must exist. The fact that symmetric matrices will arise whenever a variational principle exists is one of the most important merits of variational approaches for discretization. However, symmetric forms will frequently arise directly from the Galerkin process. In such cases we simply conclude that the variational principle exists but we shall not need to use it directly. How then do `variational principles' arise and is it always possible to construct these for continuous problems? To answer the ®rst part of the question we note that frequently the physical aspects of the problem can be stated directly in a variational principle form. Theorems such as minimization of total potential energy to achieve equilibrium in mechanical systems, least energy dissipation principles in viscous ¯ow, etc., may be known to the reader and are considered by many as the basis of the formulation. We have already referred to the ®rst of these in Sec. 2.4 of Chapter 2. Variational principles of this kind are `natural' ones but unfortunately they do not exist for all continuum problems for which well-de®ned dierential equations may be formulated. However, there is another category of variational principles which we may call `contrived'. Such contrived principles can always be constructed for any dierentially speci®ed problems either by extending the number of unknown functions u by additional variables known as Lagrange multipliers, or by procedures imposing a higher degree of continuity requirements such as least square problems. In subsequent

62 Generalization of the ®nite element concepts

sections we shall discuss, respectively, such `natural' and `contrived' variational principles. Before proceeding further it is worth noting that, in addition to symmetry occurring in equations derived by variational means, sometimes further motivation arises. When `natural' variational principles exist the quantity Å may be of speci®c interest itself. If this arises a variational approach possesses the merit of easy evaluation of this functional. The reader will observe that if the functional is `quadratic' and yields Eq. (3.65), then we can write the approximate `functional' Å simply as Å  1 aT Ka  aT f 2 By simple dierentiation Å  1 aT Ka  1 aT K a  aT f 2 2 As K is symmetric, aT Ka  aT K a Hence Å  aT Ka  f  0 which is true for all a and hence Ka  f  0 3:69

3.8 `Natural' variational principles and their relation to governing differential equations
3.8.1 Euler equations
If we consider the de®nitions of Eqs (3.61) and (3.62) we observe that for stationarity we can write, after performing some dierentiations,   Å  uT Au d  uT Bu dÿ  0 3:70
 ÿ

As the above has to be true for any variations u, we must have and Au  0 Bu  0 in  on ÿ (3.71)

If A corresponds precisely to the dierential equations governing the problem and B to its boundary conditions, then the variational principle is a natural one. Equations (3.71) are known as the Euler dierential equations corresponding to the variational principle requiring the stationarity of Å. It is easy to show that for any variational principle a corresponding set of Euler equations can be established. The reverse is unfortunately not true, i.e., only certain forms of dierential equations are Euler

`Natural' variational principles and their relation to governing differential equations

63

equations of a variational functional. In the next section we shall consider the conditions necessary for the existence of variational principles and give a prescription for the establishment of Å from a set of suitable linear dierential equations. In this section we shall continue to assume that the form of the variational principle is known. To illustrate the process let us now consider a speci®c example. Suppose we specify the problem by requiring the stationarity of a functional         1 @ 2 1 @ 2 " Å k  k ÿ Q d ÿ q dÿ 3:72 @x 2 @y  2 ÿq in which k and Q depend only on position and  is de®ned such that   0 on ÿ , where ÿ and ÿq bound the domain . We now perform the variation.12 This can be written following the rules of dierentiation as         @ @ @ @   q 3:73 Å  k ÿ Q  d ÿ "  dÿ k @x @x @y @y  ÿq As   

@  @x

@  @x

3:74

we can integrate by parts (as in Sec. 3.3) and, noting that   0 on ÿ , obtain        @ @ @ @ Å  ÿ  k  k  Q d @x @x @y @y     @ " ÿ q dÿ  0 3:75a  k  @n ÿq This is of the form of Eq. (3.70) and we immediately observe that the Euler equations are     @ @ @ @ A  k  k Q in  @x @y @y @y 3:75b @ " ÿq0 on ÿq B  k @n " If  is prescribed so that    on ÿ and   0 on that boundary, then the problem is precisely the one we have already discussed in Sec. 3.2 and the functional (3.72) speci®es the two-dimensional heat conduction problem in an alternative way. In this case we have `guessed' the functional but the reader will observe that the variation operation could have been carried out for any functional speci®ed and corresponding Euler equations could have been established. Let us continue the process to obtain an approximate solution of the linear heat conduction problem. Taking, as usual, X  % Ni ai  Na 3:76

64 Generalization of the ®nite element concepts

we substitute this approximation into the expression for the functional Å [Eq. (3.72)] and obtain X X 2 2   1 @Ni 1 @Ni k k Å a a d  d @x i @y i 2 2   X X " ÿ Q Ni ai d ÿ 3:77 q Ni ai dÿ
 ÿq

On dierentiation with respect to a typical parameter aj we have    X  X @Nj @Nj @Å @Ni @Ni ai d  k ai d  k @aj @x @x @y @y    " ÿ QNj d ÿ qNj dÿ
 ÿq

3:78

and a system of equations for the solution of the problem is Ka  f  0 with  @Ni @Nj @Ni @Nj d  k d @x @x @y @y     " fj  ÿ Nj Q d ÿ Nj q dÿ  k
 ÿq

3:79

Kij  Kji 

3:80

The reader will observe that the approximation equations are here identical with those obtained in Sec. 3.5 for the same problem using the Galerkin process. No special advantage accrues to the variational formulation here, and indeed we can predict now that Galerkin and variational procedures must give the same answer for cases where natural variational principles exist.

3.8.2 Relation of the Galerkin method to approximation via variational principles
In the preceding example we have observed that the approximation obtained by the use of a natural variational principle and by the use of the Galerkin weighting process proved identical. That this is the case follows directly from Eq. (3.70), in which the variation was derived in terms of the original dierential equations and the associated boundary conditions. If we consider the usual trial function expansion [Eq. (3.3)] u %   Na u we can write the variation of this approximation as   N a u 3:81

`Natural' variational principles and their relation to governing differential equations

65

and inserting the above into (3.70) yields   Å  aT NT ANa d  aT NT BNa dÿ  0
 ÿ

3:82

The above form, being true for all a, requires that the expression under the integrals should be zero. The reader will immediately recognize this as simply the Galerkin form of the weighted residual statement discussed earlier [Eq. (3.25)], and identity is hereby proved. We need to underline, however, that this is only true if the Euler equations of the variational principle coincide with the governing equations of the original problem. The Galerkin process thus retains its greater range of applicability. At this stage another point must be made, however. If we consider a system of governing equations [Eq. (3.1)] 9 8 > A u > < 1 = Au  A2 u  0 > F > : F ; F with   Na, the Galerkin weighted residual equation becomes (disregarding the u boundary conditions)  NT A d  0 u 3:83


This form is not unique as the system of equations A can be ordered in a number of ways. Only one such ordering will correspond precisely with the Euler equations of a variational principle (if this exists) and the reader can verify that for an equation system weighted in the Galerkin manner at best only one arrangement of the vector A results in a symmetric set of equations. As an example, consider, for instance, the one-dimensional heat conduction problem (Example 1, Sec. 3.3) rede®ned as an equation system with two unknowns,  being the temperature and q the heat ¯ow. Disregarding at this stage the boundary conditions we can write these equations as 9 8 > q ÿ d > = < dx  0 3:84 Au  > dq ; :  Q> dx or as a linear equation system, Au  Lu  b  0 3 d     6 1; ÿ dx 7 0 q 6 7 L4 b u 3:85 5 d Q  ; 0 dx Writing the trial function in which a dierent interpolation is used for each function  1  X Ni 0 u N i ai Ni  0 Ni2 in which 2

66 Generalization of the ®nite element concepts

and applying the Galerkin process, we arrive at the usual linear equation system with 2 3 dNj2   Ni1 Nj1 ; ÿNi1 6 dx 7 dx 7 3:86 Kij  NT LNj dx  6 i 4 5 1   dNj 2 ; 0 Ni dx After integration by parts, this form yields a symmetric equationy system and Kij  Kji If the order of equations were simply reversed, i.e., using 2 3 dq 6  Q7 70 Au  6 dx 4 d 5 qÿ dx 3:87

3:88

application of the Galerkin process would now lead to non-symmetric equations quite dierent from those arising using the variational principle. The second type of Galerkin approximation would clearly be less desirable due to loss of symmetry in the ®nal equations. It is easy to show that the ®rst system corresponds precisely to the Euler equations of the variational functional deduced in the next section.

3.9 Establishment of natural variational principles for linear, self-adjoint differential equations
3.9.1 General theorems
General rules for deriving natural variational principles from non-linear dierential equations are complicated and even the tests necessary to establish the existence of such variational principles are not simple. Much mathematical work has been done, however, in this context by Vainberg,15 Tonti,16 Oden,17 and others. For linear dierential equations the situation is much simpler and a thorough study is available in the works of Mikhlin,18;19 and in this section a brief presentation of such rules is given. We shall consider here only the establishment of variational principles for a linear system of equations with forced boundary conditions, implying only variation of functions which yield u  0 on their boundaries. The extension to include natural boundary conditions is simple and will be omitted. Writing a linear system of dierential equations as Au  Lu  b  0 3:89

y As  Ni1  dNj2 dNi1 2 dx  ÿ N dx  boundary terms dx dx j

Establishment of natural variational principles for linear, self-adjoint differential equations

67

in which L is a linear dierential operator it can be shown that natural variational principles require that the operator L be such that   T w Lc d  cT Lw d  b:t: 3:90
 

for any two function sets w and c. In the above, `b.t.' stands for boundary terms which we disregard in the present context. The property required in the above operator is called that of self-adjointness or symmetry. If the operator L is self-adjoint, the variational principle can be written immediately as  Å  1 uT Lu  uT b d  b:t: 3:91 2


To prove the veracity of the last statement a variation needs to be considered. We thus write  Å  1 uT Lu  1 uT Lu  uT b d  b:t: 3:92 2 2


Noting that for any linear operator Lu  L u 3:93 and that u and u can be treated as any two independent functions, by identity (3.90) we can write Eq. (3.92) as  Å  uT Lu  b d  b:t: 3:94


We observe immediately that the term in the brackets, i.e. the Euler equation of the functional, is identical with the original equation postulated, and therefore the variational principle is veri®ed. The above gives a very simple test and a prescription for the establishment of natural variational principles for dierential equations of the problem. Consider, for instance, two examples. Example 1. This is a problem governed by the dierential equation similar to the heat conduction equation, e.g., r2   c  Q  0 with c and Q being dependent on position only. The above can be written in the general form of Eq. (3.89), with  2  @ @2 L  2c bQ @x2 @y 3:95

3:96

Verifying that self-adjointness applies (which we leave to the reader as an exercise), we immediately have a variational principle      2 1 @  @2 Å    c  Q dx dy 3:97 @x2 @y2  2

68 Generalization of the ®nite element concepts

" with  satisfying the forced boundary condition, i.e.,    on ÿ . Integration by parts of the ®rst two terms results in        1 @ 2 1 @ 2 1 2  ÿ c ÿ Q dx dy 3:98 Åÿ @x 2 @y 2  2 on noting that boundary terms with prescribed  do not alter the principle. Example 2. This problem concerns the equation system discussed in the previous section [Eqs (3.84) and (3.85)]. Again self-adjointness of the operator can be tested, and found to be satis®ed. We now write the functional as 2 3 d    T      T 1; ÿ q 1 q 6 0 dx 7 q 6 7 Å dx 5    2  4 d Q  ; 0 dx    1 2 1 d 1 dq q ÿ q    Q dx 3:99  2 2 @x 2 dx  The veri®cation of the correctness of the above, by executing a variation, is left to the reader. These two examples illustrate the simplicity of application of the general expressions. The reader will observe that self-adjointness of the operator will generally exist if even orders of dierentiation are present. For odd orders self-adjointness is only possible if the operator is a `skew'-symmetric matrix such as occurs in the second example.

3.9.2 Adjustment for self-adjointness
On occasion a linear operator which is not self-adjoint can be adjusted so that selfadjointness is achieved without altering the basic equation. Consider, for instance, the problem governed by the following dierential equation of a standard linear form: d2  d    Q  0  2 dx dx 3:100

In this equation  and  are functions of x. It is easy to see that the operator L is now a scalar: L d2 d   2 dx dx 3:101

and is not self-adjoint. Let p be some, as yet undetermined, function of x. We shall show that it is possible to convert Eq. (3.100) to a self-adjoint form by multiplying it by this function. The new operator becomes " L  pL 3:102

Maximum, minimum, or a saddle point?

69

To test for symmetry with any two functions and  we write     d2  d  pL dx  p 2  p  p dx dx dx  

3:103

On integration of the ®rst term, by parts, we have (b.t. denoting boundary terms)    d p d d  p   p dx dx  b:t: ÿ dx dx dx       d d d dp p   p ÿ  p dx  b:t: 3:104 ÿ dx dx dx dx  Symmetry (and therefore self-adjointness) is now achieved in the ®rst and last terms. The middle term will only be symmetric if it disappears, i.e., if p ÿ or dp   dxY p p e dp 0 dx 
 dx

3:105

3:106

By using this value of p the operator is made self-adjoint and a variational principle for the problem of Eq. (3.100) is easily found. A procedure of this kind has been used by Guymon et al.20 to derive variational principles for a convective diusion equation which is not self-adjoint. (We have noted such lack of symmetry in the equation in Example 2, Sec. 3.3.) A similar method for creating variational functionals can be extended to the special case of non-linearity of Eq. (3.89) when b  bu; x; F F F If Eq. (3.92) is inspected we note that we could write uT b  g if g  bT du This integration is often quite easy to accomplish.  3:108 3:107

3.10 Maximum, minimum, or a saddle point?
In discussing variational principles so far we have assumed simply that at the solution point Å  0, that is the functional is stationary. It is often desirable to know whether Å is at a maximum, minimum, or simply at a `saddle point'. If a maximum or a minimum is involved, then the approximation will always be `bounded', i.e., will provide approximate values of Å which are either smaller or larger than the correct ones.y This in itself may be of practical signi®cance.
y Provided all integrals are exactly evaluated.

70 Generalization of the ®nite element concepts
Π d2Π da 2 A d2Π da 2 d2Π <0 da 2 A a =0
A

>0
A

Fig. 3.7 Maximum, minimum, and a `saddle' point for a functional Å of one variable.

When, in elementary calculus, we consider a stationary point of a function Å of one variable a, we investigate the rate of change of dÅ with da and write   @Å @2Å da  2 da2 ddÅ  d 3:109 @a @a The sign of the second derivative determines whether Å is a minimum, maximum, or simply stationary (saddle point), as shown in Fig. 3.7. By analogy in the calculus of variations we shall consider changes of Å. Noting the general form of this quantity given by Eq. (3.63) and the notion of the second derivative of Eq. (3.66) we can write, in terms of discrete parameters,     @Å T @Å Å   a  aT  3:110  aT KT a @a @a If, in the above, Å is always negative then Å is obviously reaching a maximum, if it is always positive then Å is a minimum, but if the sign is indeterminate this shows only the existence of a saddle point. As a is an arbitrary vector this statement is equivalent to requiring the matrix KT to be negative de®nite for a maximum or positive de®nite for a minimum. The form of the matrix KT (or in linear problems of K which is identical to it) is thus of great importance in variational problems.

3.11 Constrained variational principles. Lagrange multipliers and adjoint functions
3.11.1 Lagrange multipliers
Consider the problem of making a functional Å stationary, subject to the unknown u obeying some set of additional dierential relationships Cu  0 in  3:111

Constrained variational principles. Lagrange multipliers and adjoint functions

71

We can introduce this constraint by forming another functional  " Åu; k  Åu  kT Cu d


3:112

in which k is some set of functions of the independent coordinates in the domain  known as Lagrange multipliers. The variation of the new functional is now   " Å  Å  kT Cu d  kT Cu d 3:113
 

and this is zero providing Cu  0 and, simultaneously, " Å  0

3:114

In a similar way, constraints can be introduced at some points or over boundaries of the domain. For instance, if we require that u obey Eu  0 on ÿ 3:115 we would add to the original functional the term  kT Eu dÿ
ÿ

3:116

with k now being an unknown function de®ned only on ÿ. Alternatively, if the constraint C is applicable only at one or more points of the system, then the simple addition of kT Cu at these points to the general functional Å will introduce a discrete number of constraints. It appears, therefore, possible to always introduce additional functions k and modify a functional to include any prescribed constraints. In the `discretization' process we shall now have to use trial functions to describe both u and k. Writing, for instance, X X  " "  k Ni bi  Nb 3:117 u Ni ai  Na we shall obtain a set of equations 9 8 > @Å > > > @Å < @a = 0  @c > @Å > > > ; : @b

c

  a b

3:118

from which both the sets of parameters a and b can be obtained. It is somewhat paradoxical that the `constrained' problem has resulted in a larger number of unknown parameters than the original one and, indeed, has complicated the solution. We shall, nevertheless, ®nd practical use for Lagrange multipliers in formulating some physical variational principles, and will make use of these in a more general context in Chapters 11 and 12. Example. The point about increasing the number of parameters to introduce a constraint may perhaps be best illustrated in a simple algebraic situation in which we require a stationary value of a quadratic function of two variables a1 and a2 : Å  2a2 ÿ 2a1 a2  a2  18a1  6a2 1 2 3:119

72 Generalization of the ®nite element concepts

subject to a constraint a1 ÿ a2  0 3:120 The obvious way to proceed would be to insert directly the equality `constraint' and obtain Å  a2  24a1 1 and write, for stationarity, @Å  0  2a1  24 @a1 a1  a2  ÿ12 3:122 3:121

Introducing a Lagrange multiplier  we can alternatively ®nd the stationarity of " Å  2a2 ÿ 2a1 a2  a2  18a1  6a2  a1 ÿ a2  3:123 1 2 and write three simultaneous equations " " @Å @Å 0 0 @a1 @a2 a1  a2  ÿ12 " @Å 0 @ 6

3:124

The solution of the above system again yields the correct answer but at considerably more eort. Unfortunately, in most continuum problems direct elimination of constraints cannot be so simply accomplished.y Before proceeding further it is of interest to investigate the form of equations resulting from the modi®ed functional Å of Eq. (3.112). If the original functional Å gave as its Euler equations a system Au  0 then we have " Å  


3:125 


uT Au d 




kT Cu d 

kT C d

3:126

Substituting the trial functions (3.117) we can write for a linear set of constraints Cu  L1 u  C1   " " Å  aT NT A d  bT NT L1   C1  d u u


 aT






3:127

 L1 NT k d  0

As this has to be true for all variations a and b, we have a system of equations    NT A d  L1 NT k d  0 u   3:128  " T L1   C1  d  0 u N


y In the ®nite element context, Szabo and Kassos21 use such direct elimination; however, this involves considerable algebraic manipulation.

Constrained variational principles. Lagrange multipliers and adjoint functions

73

For linear equations A, the ®rst term of the ®rst equation is precisely the ordinary, unconstrained, variational approximation Kaa a  fa 3:129

and inserting again the trial functions (3.117) we can write the approximated Eq. (3.128) as a linear system:      Kaa ; Kab a fa Kc c  0 3:130  T Kab ; 0 b fb with KT  ab 


" NT L1 N dY

 fb  ÿ


" NT C1 d

3:131

Clearly the system of equations is symmetric but now possesses zeros on the diagonal, and therefore the variational principle Å is merely stationary. Further, computational diculties may be encountered unless the solution process allows for zero diagonal terms.

3.11.2 Identi®cation of Lagrange multipliers. Forced boundary conditions and modi®ed variational principles
Although the Lagrange multipliers were introduced as a mathematical ®ction necessary for the enforcement of certain external constraints required to satisfy the original variational principle, we shall ®nd that in most physical situations they can be identi®ed with certain physical quantities of importance to the original mathematical model. Such an identi®cation will follow immediately from the de®nition of the variational principle established in Eq. (3.112) and through the " second of the Euler equations corresponding to it. The variation Å, written in Eq. (3.113), supplies through its third term the constraint equation. The ®rst two terms can always be rewritten as   kT Cu d  uT Au d  b:t:  0 3:132
 

This supplies the identi®cation of k. In the literature of variational calculation such identi®cation arises frequently and the reader is referred to the excellent text by Washizu22 for numerous examples. Example. Here we shall introduce this identi®cation by means of the example considered in Sec. 3.8.1. As we have noted, the variational principle of Eq. (3.72) established the governing equation and the natural boundary conditions of the heat conduction problem providing the forced boundary condition " C   ÿ   0 was satis®ed on ÿ in the choice of the trial function for . 3:133

74 Generalization of the ®nite element concepts

The above forced boundary condition can, however, be considered as a constraint on the original problem. We can write the constrained variational principle as  " " ÅÅ  ÿ  dÿ 3:134
ÿ

where Å is given by Eq. (3.72). Performing the variation we have   " dÿ  "  Å  Å  ÿ 
ÿ

ÿ

 dÿ

3:135

Å is now given by the expression (3.75a) augmented by an integral  @ dÿ k @n ÿ

3:136

which was previously disregarded (as we had assumed that   0 on ÿ ). In addition to the conditions of Eq. (3.75b), we now require that     @ " dÿ   ÿ     k dÿ  0 3:137 @n ÿ ÿ which must be true for all variations  and . The ®rst simply reiterates the constraint " 3:138 ÿ0 on ÿ The second de®nes  as   ÿk @ @n 3:139

Noting that k@=@n is equal to the ¯ux qn on the boundary ÿ , the physical identi®cation of the multiplier has been achieved. The identi®cation of the Lagrange variable leads to the possible establishment of a modi®ed variational principal in which  is replaced by the identi®cation. We could thus write a new principle for the above example:  @ " "  ÿ  dÿ 3:140 ÅÅÿ k ÿ @n in which once again Å is given by the expression (3.72) but  is not constrained to satisfy any boundary conditions. Use of such modi®ed variational principles can be made to restore interelement continuity and appears to have been ®rst introduced for that purpose by Kikuchi and Ando.23 In general these present interesting new procedures for establishing useful variational principles. A further extension of such principles has been made use of by Chen and Mei24 and Zienkiewicz et al.25 Washizu22 discusses many such applications in the context of structural mechanics. The reader can verify that the variational principle expressed in Eq. (3.140) leads to automatic satisfaction of all the necessary boundary conditions in the example considered. The use of modi®ed variational principles restores the problem to the original number of unknown functions or parameters and is often computationally advantageous.

Constrained variational principles. Lagrange multipliers and adjoint functions

75

3.11.3 A general variational principle: adjoint functions and operators
The Lagrange multiplier method leads to an obvious procedure of `creating' a variational principle for any set of equations even if the operators are not self-adjoint: Au  0 3:141 Treating all the above equations as a set of constraints we can obtain such a general variational functional simply by putting Å  0 in Eq. (3.112) and writing  " Å  kT Au d 3:142


now requiring stationarity for all variations of k and u. The new variational principle has, however, been introduced at the expense of doubling the number of variables in the discretized situation. Treating the case of linear equations only, i.e., Au  Lu  g  0 3:143 and discretizing we note, going through the steps involved in Eqs (3.126) to (3.130), that the ®nal system of equations now takes the form      0 Kab a 0  0 3:144 KT 0 b f ab with KT  ab f  


" NT LN d " NT g d 3:145



The equations are completely decoupled and the second set can be solved independently for all the parameters a describing the unknowns in which we were originally interested without consideration of the parameters b. It will be observed that this second set of equations is identical with an, apparently arbitrary, weighted residual process. We have thus completed the full circle and obtained the weighted residual forms of Sec. 3.3 from a general variational principle. The function k which appears in the variational principle of Eq. (3.142) is known as the adjoint function to u. By performing a variation on Eq. (3.142) it is easy to show that the Euler equations of the principle are such that Au  0 and AÃ u  0 where the operator A is such that   kT Au d  uT AÃ k d
  Ã

3:146 3:147

3:148

76 Generalization of the ®nite element concepts

The operator AÃ is known as the adjoint operator and will exist only in linear problems (see Appendix H). For the full signi®cance of the adjoint operator the reader is advised to consult mathematical texts.26

3.12 Constrained variational principles. Penalty functions and the least square method
3.12.1 Penalty functions
In the previous section we have seen how the process of introducing Lagrange multipliers allows constrained variational principles to be obtained at the expense of increasing the total number of unknowns. Further, we have shown that even in linear problems the algebraic equations which have to be solved are now complicated by having zero diagonal terms. In this section we shall consider an alternative procedure of introducing constraints which does not possess these drawbacks. Considering once again the problem of obtaining stationarity of Å with a set of constraint equations Cu  0 in domain , we note that the product
2 2 CT C  C1  C2  Á Á Á

3:149

where CT  C1 ; C2 ; F F F must always be a quantity which is positive or zero. Clearly, the latter value is found when the constraints are satis®ed and clearly the variation CT C  0 as the product reaches that minimum. We can now immediately write a new functional  " Å  Å   CT uCu d


3:150

3:151

in which  is a `penalty number' and then require the stationarity for the constrained solution. If Å is itself a minimum of the solution then  should be a positive number. " The solution obtained by the stationarity of the functional Å will satisfy the constraints only approximately. The larger the value of  the better will be the constraints achieved. Further, it seems obvious that the process is best suited to cases where Å is a minimum (or maximum) principle, but success can be obtained even with purely saddle point problems. The process is equally applicable to constrants applied on boundaries or simple discrete constraints. In this latter case integration is dropped. Example. To clarify ideas let us once again consider the algebraic problem of Sec. 3.11, in which the stationarity of a functional given by Eq. (3.119) was sought subject to a constraint. With the penalty function approach we now seek the

Constrained variational principles. Penalty functions and the least square method
Table 3.1  1 a1  ÿ12:00 a2  ÿ13:50 2 ÿ12:00 ÿ13:00 6 ÿ12:00 ÿ12:43 10 ÿ12:00 ÿ12:78 100 ÿ12:00 ÿ12:03

77

minimum of a functional " Å  2a2 ÿ 2a1 a2  a2  18a1  6a2  a1 ÿ a2 2 1 2 3:152

with respect to the variation of both parameters a1 and a2 . Writing the two simultaneous equations " @Å 0 @a1 " @Å 0 @a2 3:153

we ®nd that as  is increased we approach the correct solution. In Table 3.1 the results are set out demonstrating the convergence. The reader will observe that in a problem formulated in the above manner the constraint introduces no additional unknown parameters ± but neither does it decrease their original number. The process will always result in strongly positive de®nite matrices if the original variational principle is one of a minimum. In practical applications the method of penalty functions has proved to be quite eective,27 and indeed is often introduced intuitively. One such `intuitive' application was already made when we enforced the value of boundary parameters in the manner indicated in Chapter 1, Sec. 1.4. In the example presented here (and frequently practised in the real assembly of discretized ®nite element equations), the forced boundary conditions are not introduced a priori and the problem gives, on assembly, a singular system of equations Ka  f  0 which can be obtained from a functional (providing K is symmetric) Å  1 aT Ka  aT f 2 Introducing a prescribed value of a1 , i.e., writing " a1 ÿ a1  0 the functional can be modi®ed to " " Å  Å  a1 ÿ a1 2 yielding " K 11  K11  2 f"  f1 ÿ 2"1 a 1 3:158 and giving no change in any of the other matrix coecients. This is precisely the procedure adopted in Chapter 1 (page 10) for modifying the equations, to introduce prescribed values of a1 (2 here replacing , the `large number' of Sec. 1.4). Many applications of such a `discrete' kind are discussed by Campbell.28 3:156 3:157 3:155 3:154

78 Generalization of the ®nite element concepts

It is easy to show in another context27;29 that the use of a high Poisson's ratio  3 0:5 for the study of incompressible solids or ¯uids is in fact equivalent to the introduction of a penalty term to suppress any compressibility allowed by an arbitrary displacement variation. The use of the penalty function in the ®nite element context presents certain diculties. Firstly, the constrained functional of Eq. (3.151) leads to equations of the form K1  K2 a  f  0 3:159 where K1 derives from the original functions and K2 from the constraints. As  increases the above equation degenerates: K2 a  ÿf= 3 0 and a  0 unless the matrix K2 is singular. The phenomenon where a A 0 is known as locking and has often been encountered by researchers who failed to recognize its source. This singularity in the equations does not always arise and we shall discuss means of its introduction in Chapters 11 and 12. Secondly, with large but ®nite values of  numerical diculties will be encountered. Noting that discretization errors can be of comparable magnitude to those due to not satisfying the constraint, we can make   constant 1=hn ensuring a limiting convergence to the correct answer. Fried30;31 discusses this problem in detail. A more general discussion of the whole topic is given in reference 32 and in Chapter 12 where the relationship between Lagrange constraints and penalty forms is made clear.

3.12.2 Least square approximations
In Sec. 3.11.3 we have shown how a constrained variational principle procedure could be used to construct a general variational principle if the constraints become simply the governing equations of the problem Cu  Au 3:160 Obviously the same procedure can be used in the context of the penalty function approach by setting Å  0 in Eq. (3.151). We can thus write a `variational principle'   " Å  A2  A2  Á Á Á d  AT uAu d 3:161 1 2
 

for any set of dierential equations. In the above equation the boundary conditions are assumed to be satis®ed by u (forced boundary condition) and the parameter  is dropped as it becomes a multiplier. Clearly, the above statement is a requirement that the sum of the squares of the residuals of the dierential equations should be a minimum at the correct solution.

Constrained variational principles. Penalty functions and the least square method

79

This minimum is obviously zero at that point, and the process is simply the wellknown least square method of approximation. It is equally obvious that we could obtain the correct solution by minimizing any functional of the form   " Å  p1 A2  p2 A2  Á Á Á d  AT upAu d 3:162 1 2
 

in which p1 , p2 , F F F , etc., are positive valued weighting functions or constants and p is a diagonal matrix: 2 3 p1 0 6 7 p2 6 7 7 p6 3:163 6 7 p3 4 5 FF 0 F The above alternative form is sometimes convenient as it puts dierent importance on the satisfaction of individual components of the equation and allows additional freedom in the choice of the approximate solution. Once again this weighting function could be chosen so as to ensure a constant ratio of terms contributed by various elements, although this has not yet been put into practice. Least square methods of the kind shown above are a very powerful alternative procedure for obtaining integral forms from which an approximate solution can be started, and have been used with considerable success.33;34 As the least square variational principles can be written for any set of dierential equations without introducing additional variables, we may well enquire what is the dierence between these and the natural variational principles discussed previously. On performing a variation in a speci®c case the reader will ®nd that the Euler equations which are obtained no longer give the original dierential equations but give higher order derivatives of these. This introduces the possibility of spurious solutions if incorrect boundary conditions are used. Further, higher order continuity of trial function is now generally needed. This may be a serious drawback but frequently can be by-passed by stating the original problem as a set of lower order equations. We shall now consider the general form of discretized equations resulting from the least square approximation for linear equation sets (again neglecting boundary conditions which are enforced). Thus, if we take Au  Lu  b and take the usual trial function approximation   Na u we can write, substituting into (3.162),  "  LNa  bT pLNa  b d Å


3:164 3:165

3:166

and obtain   " Å  aT LNT pLNa  b d  LNa  bT pLN a d  0
 

3:167

80 Generalization of the ®nite element concepts

or, as p is symmetric,      " LNT pLN d a  LNT pb d  0 Å  2aT
 

3:168

This immediately yields the approximation equation in the usual form: Ka  f  0 3:169

and the reader can observe that the matrix K is symmetric and positive de®nite. To illustrate an actual example, consider the problem governed by Eq. (3.95) for which we have already obtained a natural variational principle [Eq. (3.98)] in which only ®rst derivatives were involved requiring C0 continuity for u. Now, if we use the operator L and term b de®ned by Eq. (3.96), we have a set of approximating equations with  Kij  r2 Ni  cNi r2 Nj  cNj  dx dy  3:170  fi  r2 Ni  cNi Q dx dy


The reader will observe that now C1 continuity is needed for the trial functions N. An alternative avoiding this diculty is to write Eq. (3.95) as a ®rst-order system. This can be written as 9 8 > > @qx @qy > > >   c  Q > > > @x > > @y > > > > = < @ 0 3:171 Au  ÿ qx > > @x > > > > > > > > @ > > > > ÿ qy ; : @y or, introducing the vector u, u  ; qx ; qy T  Na as the unknown we can write the standard linear form (3.164) as Lu  b  0 where 2 6 6 6 @ L6 ; 6 @x 6 4 @ ; @y c; @ ; @x ÿ1; 0; @ 3 @y 7 7 7 0 7 7 7 5 ÿ1 8 9 >Q> < = b 0 > > : ; 0 3:172

3:173

The reader can now perform the substitution into Eq. (3.168) to obtain the approximation equations in a form requiring only C0 continuity ± introduced,

Constrained variational principles. Penalty functions and the least square method

81

however, at the expense of additional variables. Use of such forms has been made extensively in the ®nite element context.33;34

3.12.3 Galerkin least squares, stabilization
It is interesting to note that the concept of penalty formulation introduced earlier in this section was anticipated as early as 1943 by Courant35 in a somewhat dierent manner. He used the original variational principle augmented by the dierential equations of the problem employed as least square constraints. In this manner he claimed, though never proved, that the convergence rate could be accelerated. The suggestion put forward by Courant has been used eectively by others though in a somewhat dierent manner. Noting that the Galerkin process is, for self-adjoint equations, equivalent to that of minimizing a functional, the least square formulation using the original equation is simply added to the Galerkin form. Here it allows non-self adjoint operators to be used, for instance, and this feature has been exploited with success. Consider, for instance, the problem which we have discussed in Section 3.9.2 [viz. Eq. (3.100)] with   0. This equation, as we have already pointed out, is non-self adjoint but Galerkin methods have been successfully used in its solution providing the convection term ( d=dx) remains relatively small compared to the second derivative term (the diusion term). However, it is found that as the convection term increases the solution becomes highly oscillatory. We shall discuss the stabilization of such problems in a general manner exhaustively in Volume 3 as such problems are frequently encountered in ¯uid mechanics. But here it is easy to consider the problem in a preliminary manner. Suppose in a Galerkin form given by  


  dv d d ÿv  Q dx  0 dx dx dx

3:174

we add a multiple of the minimization of the least square of the total equation. The result is  


  dv d d ÿv  Q dx dx dx dx    2   2 dv dv d  d   Q dx  0    dx dx dx2 dx2 

3:175

and we see immediately that an additional diusive term has been added which depends on the parameter , though at the expense of having higher derivatives appearing in the integrals. If only linear elements are used and the discontinuities ignored at element interfaces, the process of adding the diusive terms can stabilize the oscillations which would otherwise occur. The idea appears to have ®rst been used by Hughes36 . This process in the view of the authors is somewhat unorthodox as discontinuity of derivatives is ignored, and alternatives to this will be discussed at length in Chapter two of Volume 3.

82 Generalization of the ®nite element concepts

It interesting to note also that another application of the same Galerkin least square process can be made to the mixed formulation with two variables u and p for incompressible problems. We shall discuss such problems in Chapter 12 of this volume and show how this process can be made applicable there. Finally, it is of interest to note that the simple procedure introduced by Courant can also be eective in the prevention of locking of other problems. The treatment for beams has been studied by Freund and Salonen40 and it appears that quite an eective process can be reached.

3.13 Concluding remarks ± ®nite difference and boundary methods
This very extensive chapter presents the general possibilities of using the ®nite element process in almost any mathematical or mathematically modelled physical problem. The essential approximation processes have been given in as simple a form as possible, at the same time presenting a fully comprehensive picture which should allow the reader to understand much of the literature and indeed to experiment with new permutations. In the chapters that follow we shall apply to various physical problems a limited selection of the methods to which allusion has been made. In some we shall show, however, that certain extensions of the process are possible (Chapters 12 and 16) and in another (Chapter 10) how a violation of some of the rules here expounded can be accepted. The numerous approximation procedures discussed fall into several categories. To remind the reader of these, we present in Table 3.2 a comprehensive catalogue of the methods used here and in Chapter 2. The only aspect of the ®nite element process mentioned in that table that has not been discussed here is that of a direct physical method. In such models an `atomic' rather than continuum concept is the starting point. While much interest exists in the possibilities oered by such models, their discussion is outside the scope of this book. In all the continuum processes discussed the ®rst step is always the choice of suitable shape or trial functions. A few simple forms of such functions have been introduced as the need demanded and many new forms will be introduced in subsequent chapters. Indeed, the reader who has mastered the essence of the present chapter will have little diculty in applying the ®nite element method to any suitably de®ned physical problem. For further reading references 41±45 could be consulted. The methods listed do not include speci®cally two well-known techniques, i.e., ®nite dierence methods and boundary solution methods (sometimes known as boundary elements). In the general sense these belong under the category of the generalized ®nite element method discussed here.41 1. Boundary solution methods choose the trial functions such that the governing equation is automatically satis®ed in the domain . Thus starting from the general approximation equation (3.25), we note that only boundary terms are retained. We shall return to such approximations in Chapter 13. 2. Finite dierence procedures can be interpreted as an approximation based on local, discontinuous, shape functions with collocation weighting applied (although

Concluding remarks ± ®nite difference and boundary methods
Table 3.2 Finite element approximation Integral forms of continuum problems trial functions X u Ni ai ÿÿ ÿ ÿ ÿ ÿÿÿ ÿÿ ÿ ÿÿ ÿÿÿÿ ÿ ÿÿ ÿ ÿ ÿÿÿ ÿÿ ÿ ÿÿ ÿ ÿ ÿ ÿÿ ÿÿÿ ÿ ÿ ÿ ÿ ÿ ÿ ÿ ÿ ÿ
"

83

Variational principles ÿ ÿÿÿ ÿ ÿÿ ÿÿ

ÿ ÿ
"

Direct physical model

ÿ ÿ
"

ÿ ÿ

Weighted integrals of partial dierential equation governing (weak formulations) ÿ ÿ ÿÿ ÿ ÿÿ ÿ ÿ ÿ ÿÿ ÿ ÿ ÿ ÿ ÿÿ ÿÿÿ ÿÿ ÿ ÿ ÿ ÿÿÿ ÿÿÿ ÿ ÿ

"

Global physical statements (e.g. virtual work)

"

Meaningful physical principles

usually the derivation of the approximation algorithm is based on a Taylor expansion). As Galerkin or variational approaches give, in the energy sense, the best approximation, this method has only the merit of computational simplicity and occasionally a loss of accuracy. To illustrate this process we discuss an approximation carried out for the onedimensional equation (3.27) (viz. p. 47). Here we represent a localized approximation through equally spaced nodal point values by x       1 x ÿ xi 2 x ÿ xi x ÿ xi 2 1 x ÿ xi 2 x ÿ xi ÿ ;  ; 1ÿ 2 2 h h2 h2 h2 h2 9 8 > i ÿ 1 > > > = < 3:176 Â i > > > > ; : i  1

where h  xi  1 ÿ xi (shown in Fig. 3.8). It is clear that adjacent parabolic approximations in this case are discontinuous between the nodes. Values of the function and its

ÿ ÿ

ÿ ÿ ÿ ÿ Least square forms
" 3

Galerkin Wj  Nj 
"

"

ÿ ÿ
"

ÿ ÿ

ÿÿÿ ÿ ÿ ÿ ÿ ÿ ÿÿÿ ÿ ÿ ÿ ÿ ÿ

ÿ ÿ ÿ ÿ ÿÿ ÿ ÿ ÿ ÿÿ

ÿ ÿ ÿ ÿ ÿÿÿ ÿÿÿ ÿÿ ÿ ÿ ÿ ÿÿ ÿÿÿ ÿÿÿ ÿ

Constrained langragian forms Adjoint functions

"

Miscellaneous weight functions

"

Penalty function forms

"

Collocation (point or subdomain)

"

ÿ ÿ

"

3

ÿ ÿ

"

"

84 Generalization of the ®nite element concepts

φi

x i–2 i–1 i i+1 i+2

Fig. 3.8. A local, discontinuous shape function by parabolic segments used to obtain a ®nite difference approximation.

®rst two derivatives at a typical node i are given by xi   i  @  1    ÿ i ÿ 1  @x x  xi 2h i  1  @2  1   2 i  1 ÿ 2i  i ÿ 1  2 @x x  xi h

3:177

If we insert these into the governing equation at node i, we note immediately that the approximating equation at the node becomes 1 i ÿ 1 ÿ 2i  i  1   Qi  0 h2 3:178

This is identical (within a multiple of h) to the assembled ®nite element equations (which we did not do explicitly) for the approximation with linear elements discussed in Eq. (3.35). This is indeed one of the cases in which the approximation is identical rather than dierent. In Chapter 16 we shall be discussing such ®nite dierence and point approximations in more detail. However, the reader will note the present exercise is simply given to underline the similarity of ®nite element and ®nite dierence processes. Many textbooks deal exclusively with these types of approximations. References 46±50 discuss ®nite dierence approximation and references 51±54 relate to boundary methods.

References
1. S.H. Crandall. Engineering Analysis. McGraw-Hill, 1956. 2. B.A. Finlayson. The Method of Weighted Residuals and Variational Principles. Academic Press, 1972. 3. R.A. Frazer, W.P. Jones, and S.W. Sken. Approximations to functions and to the solutions of dierential equations. Aero. Research Committee Report 1799, 1937. 4. C.B. Biezeno and R. Grammel. Technische Dynamik, p. 142, Springer-Verlag, 1933. 5. B.G. Galerkin. Series solution of some problems of elastic equilibrium of rods and plates (Russian). Vestn. Inzh. Tech., 19, 897±908, 1915.

