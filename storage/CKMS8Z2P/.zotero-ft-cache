An Algorithm for Computing Customized 3D Printed Implants with Curvature Constrained Channels for Enhancing Intracavitary Brachytherapy Radiation Delivery
Animesh Garg, Sachin Patil, Timmy Siauw, J. Adam M. Cunha, I-Chow Hsu, Pieter Abbeel, Jean Pouliot, Ken Goldberg
Abstractâ Brachytherapy is a widely-used treatment modality for cancer in many sites in the body. In brachytherapy, small radioactive sources are positioned proximal to cancerous tumors. An ongoing challenge is to accurately place sources on a set of dwell positions to sufï¬ciently irradiate the tumors while limiting radiation damage to healthy organs and tissues. In current practice, standardized applicators with internal channels are inserted into body cavities to guide the sources. These standardized implants are one-size-ï¬ts-all and are prone to shifting inside the body, resulting in suboptimal dosages. We propose a new approach that builds on recent results in 3D printing and steerable needle motion planning to create customized implants containing customized curvature-constrained internal channels that ï¬t securely, minimize air gaps, and precisely guide radioactive sources through printed channels. When compared with standardized implants, customized implants also have the potential to provide better coverage: more potential source dwell positions proximal to tumors. We present an algorithm for computing curvature-constrained channels based on rapidly-expanding randomized trees (RRT). We consider a prototypical case of OB/GYN cervical and vaginal cancer with three treatment options: standardized ring implant (current practice), customized implant with linear channels, and customized implant with curved channels. Results with a twoparameter coverage metric suggest that customized implants with curved channels can offer signiï¬cant improvement over current practice.

Fig. 1. Case study for OB/GYN cancer. Left: 3D model of customized implant for treating tumors of the cervix and endometrium of the vaginal cavity. The ï¬gure shows an anatomical conï¬guration of the vaginal canal (in buff) with the cervix at the distal end and vaginal opening at the bottom of the cavity. Two tumors, one above the cervix (top) and one on the vaginal sidewall, are depicted in solid red. Right: Picture of a customized implant with 11 curvature constrained channels generated by the algorithm (8 catheters are placed for visual aid) for the anatomy on the left. The radioactive source (seed) can be precisely guided through each channel sequentially, by a wire controlled programmable Afterloader, to precisely deliver treatment to the tumors.

I. I NTRODUCTION Automation science addresses the accuracy and quality of processes in a variety of applications from manufacturing to healthcare. Each year, over 500, 000 cancer patients worldwide are treated with brachytherapy [1], a form of radiotherapy where needles or implants are temporarily inserted into the body to guide small radioactive sources close to tumors (brachys: Greek for proximal). Brachytherapy is widely used to treat cancer in a number of anatomical sties: interstitial locations such as prostate, pelvic sidewall, breast, liver, brain; and intracavitary locations such as nasal cavity, throat, tongue, rectum, cervix, and the vaginal canal [2]. Under the current practice of high dose rate brachytherapy (HDR-BT), a radioactive source is guided through hollow needles or catheters (interstitial) or through channels inside a standardized implant (applicator) that is inserted into a body cavity (intracavitary). The radioactive source is then pushed all the way through the needle or implant channel using an attached wire, and precisely withdrawn by an automated afterloader that causes the source to dwell for speciï¬ed times at speciï¬ed points along the needle or channel to deliver the

desired radiation dose. Biological effectiveness requires the prescribed dose be divided into 2-4 iterations and delivered with intervening gaps of 5-6 hours. As illustrated in Figure 2, existing clinical methods employ standardized implants that do not conform to the patient anatomy allowing for relative movement, and only offer a ï¬xed set of possible dwell position options for placing sources. In existing practice, patients are required to remain immobile over the course of treatment to maintain the geometric positions between anatomy and sources. Another limitation is that treatment quality depends on precisely positioning the sources to sufï¬ciently irradiate the tumors while minimizing radiation delivered to healthy organs and tissues. As noted by Magne et al. [3], âthe proper placement of the applicator within vagina is the most important ï¬rst step to avoid tumor underdosage or excessive dose to critical organsâ. We propose a new approach for HDR-BT intracavitary treatment that builds on recent results in 3D printing and steerable needle motion planning to design customized implants with interior curvature-constrained channels that can ï¬t precisely and guide radioactive sources to customized dwell points proximal to cancerous tumors. Such curved

Fig. 3. Schematic of a typical [4](Permission pending).

192 Ir

source used in GYN Brachythrapy

Fig. 2. Four standardized templates/applicators/implants for gynecological brachytherapy. (A) Vaginal cylinder applicator with 8 parallel catheters, (B & D) Ovoids applicator, (C) Ring applicator. B,C&D also have a uterine tandem and allow for interstitial catheters. The uterine tandem provides a channel for dwell positions inside the uterine canal. The ring(C) and ovoids(B & D) act as guides for inserting catheters into the tissue surrounding the cervix.

channels have potential to reach targets that may not be reachable with existing methods. Customized implants can also provide a much better ï¬t to increase patient comfort, reduce shifting due to movement and changes in bladder and bowel geometry, and permit patient mobility between treatment sessions. We present an algorithm for computing curvature constrained channels that ï¬t inside the speciï¬ed implant geometry and meet dose and delivery requirements. The radiation source for HDR brachytherapy for treatment of GYN tumors is typically an 192 Ir core embedded in a steel capsule 0.9 mm in diameter and â¼5.0 mm in length [4] as shown in Figure 3. The cylindrical geometry imposes curvature constraints on the channels; given a channel diameter of 2.5 mm, we calculate the minimum local curvature as â¼10 mm. Figure 1 illustrates an OB/GYN case study with typical cervical and vaginal tumors (the approach is also relevant to almost any other intracavitary HDR-BT). We next review related work. We deï¬ne the problem in Section III and present the algorithm for computing curvature-constrained non-intersecting paths in Section IV. Section V describes the case study and results. II. R ELATED W ORK Automation science has been applied to a number of healthcare applications to better treatment quality by improving repeatability and reliability. Huang et al. [5] studied planning of robotic therapy and task-oriented functions for hand rehabilitation, Solis et al. [6] explored the use of automation for studying human motor skills for medical task training. Mendez et al. [7] studied automatic control of anesthesia, and Subburaj et al. [8] studied computer assisted joint reconstruction surgery. In our previous paper, Garg et al. [9], we addressed limitations imposed by standardized external templates, for guiding linear needles, used in prostate cancer treatment. We demonstrated that a set of linear brachytherapy needles can

be accurately placed in a non-parallel (skew-line) pattern, by a specialized robot, to avoid puncturing sensitive organs. In the present paper, we extend these ideas in several ways. We explore the use of customized 3D printed implants to achieve precise patient anatomy alignment without a robot and present an algorithm for computing curved interior channels through the 3D printed implant for delivering radioactive sources in intracavitary brachytherapy. Potter et al. [10] present recommendations on intracavity BT dose distributions for gynecological cancers. There are a number of commercially available implants/applicators for treating cervical and vaginal cancers, for e.g. Fletcher applicators [11], Utretch applicator [12], Vienna applicator [13] and Mold type applicators [3]. These standardized implants can be combined with linear catheters as illustrated in Figure 2. Used by many radiation oncologists, these intracavitary applicators include an intrauterine tandem and intravaginal ovoids, and produce a pear-shaped dose distribution centered on the cervix, allowing a high dose to be delivered to the cervix while sparing bladder and rectum. Although these systems allow some adaptation to patient anatomy, in correct placement and patient movement (and ï¬lling of bladder and bowels) can cause shifts in the applicator position and hence result in undesired doses. One exciting innovation is the approach described by Magne et al. [3], which proposes use of a customized implant created using vaginal impression with plaster that accurately shows the topography and extension of tumors and the speciï¬c anatomy of the vagina and cervix. An silicone implant is made using this plaster mold, and two linear catheters and tandem shaft are inserted by the oncologist into the implant. The authors report decreased relative movement of implant while the patient is mobile over three days, thereby improving conformity between planned and delivered dose distributions. Treatment of patients with tumor extensions to the endometrial tissue of the vaginal wall often requires two separate implants if treated with standard applicators. A custom implant allows the oncologist to account for tumor extensions in a single iteration. The authors report their experience with more than 5000 patients and note that their method has three main advantages: patient tailored treatment, MRI procedure compatibility without image quality disturbance, and increased patient comfort. We note that Magne et al prepare the mold implant manually and correct placement of catheters is highly dependent on oncologistâs experience. Roy et al. [14] explored the use of precision machining for making external templates as guides for linear needle

conï¬gurations. These templates and paths were not generated algorithmically. In the present paper we explore an extension where MRI/CT scans are used to reconstruct precise 3D model of patient anatomy (or the plaster cast may be scanned). This model is provided as input to our algorithm for computing a set of internal curved channels that can be embedded in a plastic implant of the same shape as the vaginal volume. Recent advances in 3D printing (also known as additive manufacturing) are poised to have major impact on many ï¬elds as described by Lipson [15]. Jacobs [16] is an early introduction. Non-toxic, FDA approved materials are allowing 3D printed parts to be used for medical applications [17] such as bone replacement [18] and oral surgery implants [19]. A growing body of research has been reported on motion planning for steering needles [20]â[22]. The objective is to steer a ï¬exible needle with curvature constraints through tissue to internal targets by exploiting asymmetries at the needle tip. Such needles can reach targets that cannot be reached by stiff linear needles. The needle is a nonholonomic system and is related to motion planning for ï¬xed-wing aircraft [23]. Computing a set of internal channels is a similar problem in that curvature is constrained but has the distinct advantage that there is no uncertainty due to tissue properties or needle mechanics: channels can be printed with high accuracy. It is also important that channels do not intersect. We build on prior work by Patil et al. [21] which uses rapidly exploring random trees (RRT) [24] for planning curvature constrained paths for steerable needles [22]. III. P ROBLEM D EFINITION The objective is to compute a set of non-intersecting curvature-constrained channels within the implant that reach targets proximal to tumors for delivery of radiation and if needed, a report of which tumor zones cannot be reached. The input is the registered pre-operative geometry from a combination of 3D scan of the plaster cast and CT (or MRI) scan of the patient. This input includes: external geometry of the implant speciï¬ed as a triangle mesh; the desired entry zone at the base of the implant for all channels; and the locations of tumors and organs-at-risk (OAR) (vaginal wall, cervix, rectum, urethra, bladder, uterus). The channel layout problem can then be stated as follows: Objective: Given a 3D model of the implant volume I, which may include internal voids that will be treated as obstacles for channels, a set of 3D cancerous tumors that require radiation treatment T , a speciï¬cation of the entry region at the base of the implant E, the maximum allowable entry angle (deviation from normal) Î±, the minimum radius of curvature of the channel, rmin , and the channel diameter, w, corresponding to the width of the catheter carrying the source, the objective is to compute a set of non-intersecting curvature constrained channels C = {C1 , C2 , . . . , CN } starting from E that lie within I and are proximal to as much of the set T as possible.

A. Coverage Quality Metric The ability to deliver radiation doses depends on the arrangement of potential source dwell points and their proximity to tumors. The radiation dosage is assumed to follow an inverse square law. We measure the quality of an implant by the percentage of tumor volume that is âcoveredâ by the set of dwell points, where coverage is a function of the distance between a dwell point (source) and a tumor point (target). Higher quality reduces the the maximum dwell time needed to treat tumors and the potential for hot spots that can harm healthy tissue. Alternate dose models can be based on inverse dose planning [4], which we will study in future work. To compare implants and channels for a given set of tumors T , we consider the set of reachable dwell positions and how thoroughly they âcoverâ the set of tumors. Consider a set of reachable dwell positions S (for instance in case of 3D printed implants these are evenly spaced inside reachable dwell segments). We discretize the set of tumors into a set of evenly spaced points dT . We quantify the proximity of a dwell position dS from a tumor point dT with the âcoverage radiusâ Î´ such that: if dS lies within a ball of radius Î´ centered at dT , then dS is said to cover dT . Hence the cover of dT is the set cover(dT, Î´) = {dS : dS â dT
2

â¤ Î´, dS â S}.

(1)

It is also helpful to consider cases where tumor points can be covered by multiple dwell points, say n. We deï¬ne the quality of coverage Q(n, Î´) as the percentage of tumor volume such that each tumor point dT within that volume T (T â T ) is covered by at least n dwell positions within a ball of radius Î´ centered at dT . Hence, Q(n, Î´) = 1 |T | I{|cover(dT, Î´)| â¥ n} dT, (2)

T

where I{Â·} is the indicator function and | Â·| is set cardinality. Reaching 100% coverage with smaller radiation radius and more dwell positions can reduce occurrence of hot spots and increase dose conformation to the tumor geometry to spare healthy tissue. IV. C HANNEL L AYOUT A LGORITHM (CLA) The Channel Layout Algorithm (CLA) is summarized in Alg. IV. The ï¬rst step is generating a set of dwell segments proximal to the given set of tumors. Starting from the dwell segment most distal to the entry zone, we use the curvature constraints to construct an RRT backward from the segment toward the entry zone, stopping if/when we ï¬nd a channel that avoids obstacles. We then treat this channel as an obstacle and consider the next dwell segment until all dwell segments are considered. We describe each step in detail below. generate dwell segments(Â·): We start by computing a candidate set of dwell segments, which are linear segments near tumors that may include multiple potential source dwell positions. We can also consider curved dwell segments and segments in alternate orientations.

Algorithm 1 C â channel layout(I, E, T , rmin , w) 1: D â generate dwell segments(I, T ) 2: C = â 3: for all d â D do 4: X ââ 5: X â add vertex(Xd ) 6: repeat 7: prand â random point in R3 (I, C) 8: Xnear â nearest neighbor(prand , X , rmin ) 9: Xnew â circular arc(Xnear , prand ) 10: if collision free(Xnear , Xnew , I, C) then 11: X â add vertex(Xnew ) 12: X â add edge(Xnear , Xnew ) 13: end if 14: until ((pnew â E) â§ permissible(Rnew )) 15: Cd â build channel(X , Xnew , w) 16: C â C âª Cd 17: end for 18: return C

yrand

Xrand xrand zrand
[x, y, z]T

w

znear xnear Xnear ynear
[0, 0, 0]T

l
y x2 +
2

z

r Î¸
[0, âr, 0]T

Ï

Fig. 4. The medial axis of each channel is parameterized with a sequence of circular arcs {Î¨1 , Î¨2 , . . . , Î¨n }. We show one such circular arc here (orange) parameterized as a tuple [l, Ï, r]. The channel is obtained by sweeping a disk of diameter w along the length of the arc. This arc connects the state Xnear â SE(3) at the nearest tree node to the randomly sampled point prand â R3 . We assume that the medial axis of the channel is oriented along the local z-axis at each point along the arc. The circular arc is constructed by rotating the local frame Xnear by an angle Î¸ around a line parallel to the local x-axis and passing through the point [0, âr, 0]T , r > rmin . The rotation Ï rotates the tangential frame at the end of one circular arc to align it with the plane that contains the subsequent circular arc.

Given the set of tumors T and the implant volume I, we compute the set of dwell segments D as follows. We discretize the implant volume with a regular voxel grid, where each voxel is a cube of side length equal to the channel width w. The surface of the implant volume is represented as a triangle mesh. We mark all triangles on implant whose surface normals intersect with tumor mesh. All marked triangles are then projected inwards in opposite direction to their surface normals by a distance w/2 to account for the channel width. All voxels intersecting with projected triangles are noted. These voxels represent a discretization of the volume that should ideally be covered with the dwell segments. This is also known as the âpencil packing problem,â for which ï¬nding an optimal solution is NP-hard [25]. Currently, we select a set linear segments suboptimally, that cover the marked voxels (see Section VI for planned extensions). For every dwell segment in D, we compute a channel inside the implant volume that reaches it or a report that no channel can be found. We consider the dwell segments in decreasing order of distance from the entry region E. The medial axis of each curvature constrained channel can be parameterized as a sequence of circular arcs {Î¨1 , Î¨2 , . . . , Î¨n } in R3 , where each circular arc Î¨i is parameterized as a tuple [li , Ïi , ri ]T (Figure 4). Here, li is the length of the arc, ri > rmin is the radius of the arc, and Ïi is the twist applied to the tangential frame at the end of Î¨i that rotates the plane containing the arc Î¨i to the plane that contains the arc Î¨i+1 . The channel is constructed by sweeping a circle of diameter w along the medial axis. Although the channels are constructed in 3D space, the state space of the layout problem comprises of both the position and orientation in SE(3) because of the constraints on the channel curvature. The position and orientation constraint at the end of each dwell segment d â D can be described as Xd = Rd pd â SE(3) comprising of the position pd 0 1

of the end of the segment and rotation matrix Rd encoding the orientation of the dwell segment in 3D. Without loss of generality, we assume that the dwell segment d is oriented along the z-axis of the local coordinate frame attached to the end of dwell segment. Recent results in motion planning for nonholonomic systems emphasize sampling-based methods such as the Rapidly-exploring Random Tree (RRT) planner [24] where the probability of ï¬nding a solution converges to one, if such a solution exists, as the number of samples approaches inï¬nity. We employ this approach building on an algorithm to compute curvature constrained needle paths in R3 [21]. Given a dwell segment d â D, we use the planner to compute the medial axis of the channel while staying within the implant volume and avoiding obstacles and the set of existing channels C in the environment. We plan backwards starting from the dwell segment d to the entry region E because the larger entry region is less constrained. Given initial state Xd and entry region, the algorithm incrementally builds a tree X over the state space, while conforming to nonholonomic motion constraints of the system and avoiding obstacles. As described in Patil et al. [21], building the tree in the SE(3) state space directly is computationally inefï¬cient, so we sample a random point prand â R3 rather than a random state Xrand â SE(3). The planner then identiï¬es a node in the tree Xnear that is closest to the sample prand , as deï¬ned by a speciï¬ed distance metric Ï[Â·]. The sample prand is then connected to Xnear using a circular arc parameterized by the tuple [l, Ï, r]T . If the circular arc does not collide with the implant volume or existing channels and the minimum clearance from the obstacles is at least the channel width w, we add the arc as an edge in the tree. This process is repeated until either the tree X connects Xd and E or the available computation time is exceeded, in which case the planner reports that a solution cannot be found. The medial axis of the channel can then be extracted from the

Fig. 5. This sequence of ï¬gures depicts the procedure followed while generating a custom implant. The image in (a) shows a contoured image slice from CT-Scan. The image in (b) shows the 3D model of anatomy reconstructed from the set of contoured CT images. The image in (c) shows smoothed meshes of only the tumor and the vaginal cavity extracted from the 3D model. These meshes are used for generating internal channels. The image in (d) shows a custom 3D printed implant shaped as the corresponding vaginal cavity with catheters inserted in the channels.

tree by traversing backwards from the entry region to the dwell segment that corresponds to the root of the tree. random point in R3 (Â·): We sample a random point prand â R3 within the implant volume I that is not collision with any of the channels in C. The sampled point can then near be connected to a given state Xnear = R0 pnear directly 1 using a circular arc parameterized by [l, Ï, r]T , where l is the arc length, Ï is the change in orientation of the node Xnear around the znear -axis, and r is the arc radius (Figure 4). Let T [x, y, z]T = Rnear (prand â pnear ) be the coordinates of prand in the local coordinate frame of Xnear . The parameters of the circular arc are then given by: x2 + y 2 + z 2 r= , (3) 2 x2 + y 2 Ï = arctan(x, ây), (4) l = r arctan(z, r â x2 + y 2 ). (5) To build toward the entry zone, we incorporate two forms of biasing when constructing the tree. First, sample from the entry zone with a higher probability than the rest of the implant volume. Second, whenever a new node Xnew is added to the tree, the planner attempts to connect Xnew to a randomly sampled point in the entry zone E. nearest neighbor(Â·): We use the distance measure proposed by Patil et al. [21] that is customized for nonholonomic systems with curvature constraints to select the tree node that is nearest to the sampled point prand . Since the channel has a minimum radius of curvature rmin , not all sampled points will be reachable from a given state. The reachable near set from a state Xnear = R0 pnear consists of all points 1 that can be connected to pnear by a circular arc that has a radius r â¥ rmin and is tangent to the znear -axis of the local coordinate frame. We use this deï¬nition of the reachable set to deï¬ne the distance metric Ï[Xrand , prand ] as the length of such a circular arc connecting prand and Xnear if prand is in the reachable set of Xnear , and inï¬nity otherwise. Ï[Xrand , prand ] = l(â¡ rÎ¸) if r â¥ rmin â§ Î¸ â¥ 0 . (6) â otherwise

circular arc(Â·): Given a circular arc parameterized as

[l, Ï, r]T and a maximum step size â to progress at each iteration of the RRT algorithm, we compute the position and orientation of the new node Xnew by composing a rotation of Ï around the znear -axis and then applying a rotation of Î¸ = min{l, â}/r around a line parallel to the xnear -axis and passing through the point [0, âr, 0]T , r > rmin in the local coordinate frame of Xnear . collision free(Â·): To enable obstacle avoidance, only collision free arcs are added to the tree. We check if the circular arc connecting Xnear and Xnew is collision free by approximating it as a sequence of line segments and checking if all the segments are collision free. Since the obstacle deï¬nitions are obtained from segmentation of 3D scans, the obstacle meshes are likely to be non-manifold. We use the SOLID library [26] for detecting collisions with arbitrary, polyhedral obstacles at interactive rates. We also check if the minimum clearance of the circular arc is at least the channel width w from the implant volume and existing channels to ensure that the channel that is constructed around the medial axis of this arc is collision free. permissible(Â·): Since the catheter carrying the source is inserted through the channels, we want the channel orientation at the entry region E to as close as possible to perpendicular to E. We allow a cone of permissible orientations, i.e., the dot product of the local z-axis at a point on the channel medial axis at the entry region and the normal to the entry region should be less than the maximum allowable entry angle (deviation from normal), Î±. build channel(Â·): A channel is found when the position pnew of a newly added state Xnew is found to lie in the entry region E and the orientation Rnew is permissible. By traversing the tree X backwards from Xnew to the root Xd , we obtain a path composed of piecewise circular arcs {Î¨1 , Î¨2 , . . . , Î¨n } constituting the medial axis of the channel, each with radius r > rmin . We build the channel by sweeping a circle of diameter w along the medial axis. The channel is then added to the list of existing channels C and the process is repeated for the next most distant dwell segment until all dwell segments D are considered. As it may not be possible to ï¬nd solutions for all dwell segments,

Fig. 6. Standardized ring implant (white) that cannot conform to patient anatomy. Only 12 dwell positions(in blue) are reachable in this case.

Fig. 7. 3D Printed implant with only linear channels: Left: candidate set of 70 dwell positions. Right: only 21 dwell positions can be reached using linear channels.

we report a segment as unreachable if a maximum number of iterations of the RRT algorithm are exceeded and no valid path is found to the entry region E. Alternate orderings of dwell segments might generate better solutions and we will explore other heuristics in future work. V. C ASE S TUDY AND E VALUATION Physical evaluation of the proposed technique requires following a multi-step procedure as illustrated in Figure 5. A CT-scan is performed on a patient, and a clinician contours different organs in the CT-scan images. One such CT-image slice with organ contours is shown in Figure 5(a). A labeled 3D model of the anatomy is then reconstructed from the CTscan images as shown in Figure 5(b). Thereafter, the tumor and the vaginal cavity are considered separately as shown in Figure 5(c) for planning purposes. Using the algorithm described in Section IV, internal channels are planned in the vaginal cavity. A modiï¬ed mesh for vaginal cavity containing internal channels is created and printed using a 3D printer. Figure 5(d) shows an image of a custom implant with catheters inserted in the channels. The channels have been extended to be open at distal end of the implant and catheters are shown to exit the implant. In practice, channels will not have an opening at the distal end and catheters will remain in the implant interior. As a case study, we used anonymized data from an actual patient CT-scan from UCSF Mt. Zion Center. Also, a side tumor was added to anatomy to supplement the complexity of the case. The vaginal cavity was contained in a 70 Ã 52 Ã 54mm bounding box with anatomy shown in Figure 1. We consider three treatment methods: standardized ring implant (current practice), customized 3D printed implant with linear channels, and customized 3D printed implant with curved channels. We compare them with the coverage quality metric deï¬ned in Section III. We ï¬rst consider the standardized ring implant. The left image in Figure 6 shows a ring implant placed in the vaginal cavity. The ring implant contains a toroidal channel running around the interior of the ring and a number (usually 6) of parallel catheters running along the axis of symmetry of the ring near its outer diameter. A central tube (uterine tandem) passes into the uterine canal via the cervix. In a clinical procedure, the ring implant is placed against the

cervix by the physician and then the patient is scanned using either MR or CT imaging. After scanning, a physician digitally segments the anatomical structures and digitizes the positions of the catheters. Using these structures and the set of catheter positions deï¬ned by their geometry, dose optimization software determines the best subset of dwell positions and times at each of these positions. The right image in Figure 6 shows one such conï¬guration of dwell positions superimposed on the implant. Next we consider an alternative technique to the plaster mold proposed by Magne et al. [3], where the channels are manually created by the clinician by pushing linear catheters into the soft material. The right image in the Figure 7 shows a set of linear channels (skew lines) that reach as many of the dwell positions as permitted by the size of the entry zone. Finally we consider the custom implant with curvatureconstrained non-linear channels generated by the CLA algorithm as shown in Figure 8. The standardized ring implant can reach 12 potential radiation source dwell points, the custom implant with linear channels can reach 21 dwell points and the 3D Printed implant with curved channels can reach 70 dwell points (11 dwell segments discretized at 5 mm intervals). Table I lists the values of Î´ in mm at which coverage quality Q reaches 100%. Figure 9 plots the quality metric comparing three implant options for the three implant options for different values of the number of dwell positions n. As n increases, full tumor coverage (Q = 100%) is achieved
n (multiple) 1 5 10 15 20 Implant Type 3D Printed with Standardized Ring Linear Channels 73.36 74.32 75.55 86.00 76.64 102.99 96.35 N/A 106.21 N/A 3D Printed with Curved Channels 73.35 73.36 74.45 75.55 76.65

TABLE I T HE MINIMUM COVERAGE RADIUS (Î´ IN MM ) NEEDED TO ACHIEVE 100% COVERAGE (Q), FOR 1, 5, 10, 15 AND 20 DWELL POINTS RESPECTIVELY. T HE 3D PRINTED IMPLANT WITH CURVED CHANNELS
ACHIEVES FULL COVERAGE WITH SMALLER COVERAGE RADIUS IN ALL CASES .

T HE RING IMPLANT REACHES 12

DWELL POSITIONS AND HENCE

IS NOT APPLICABLE FOR

n > 12

Fig. 8. 3D Printed implant with curved channels computed by the CLA algorithm: Left: 11 dwell segments. Right: channels computed by the CLA algorithm.

with signiï¬cantly lower Î´ in the case of curved channels as opposed to linear channels or standard ring implants. VI. D ISCUSSION AND F UTURE W ORK At CASE 2012, we presented a new approach to interstitial brachytherapy using a robot to precisely align linear needles Garg et al. [9]. In this paper, we propose a new approach to perform intracavitary brachytherapy using 3D printing and present an algorithm for generating curvature-constrained internal non-linear channels. We consider a case-study with an OB/GYN cervical and vaginal cancer to compare three treatment options: standardized implant (current practice), customized implant with linear channels, and customized implant with curved channels. Results with a two-parameter coverage metric, summarized in Section V and Table 1, suggest that customized implants with curved channels can offer signiï¬cant improvement over current practice. Such improvements in the coverage metric: (a) increase options for dose planning, which can reduce occurrence of hot spots, and (b) increase dose conformity with the tumor geometry to spare healthy tissue. We envision that such 3D printed implants are clinically viable as outlined below in the potential treatment procedure: 1. Create a cavity model: We may use a patient CT/MRI scan along with manual organ contouring. Alternatively, a plaster cast of the cavity can be created. 2. 3D scan the plaster cast noting locations of tumors on surface when possible. 3. Create a planning implant using 3D printing with CT/MRI opaque ï¬ducial markers for registration. 4. Scan patient after inserting planning implant: Improve 3D anatomy model with associated ï¬ducial markers embedded to account for post insertion anatomy changes. 5. Compute dose plan and channels in implant using our Channel Layout Algorithm (CLA) along with inverse dose planning to achieve dose objectives and spare healthy tissue. 6. 3D print the ï¬nal custom implant with internal channels. 7. Insert custom implant and deliver treatment using a programmable afterloader device, which controls the radiation source, over several sessions as needed. In future work, we will explore a number of extensions

Fig. 9. Comparison of quality metric Q (percentage of tumor volume covered) versus the radiation radius Î´ for (A) n = 1, (B) n = 10, and (C) n = 20 dwell positions for each of three treatment options: standardized ring implant (current practice), customized 3D printed implant with linear channels, and customized 3D printed implant with curved channels. As n increases, full tumor coverage (Q = 100%) is achieved with signiï¬cantly lower Î´ in the case of curved channels as opposed to linear channels or standard ring implants.

and study how the concept can be applied to other anatomical intracavitary locations. We are now working on an extended case study where we will incorporate the IPIP [27] inverse dose planning algorithm with the CLA algorithm to generate channels and dwell times. For selecting the set of dwell segments, we will implement the efï¬cient approximation algorithm proposed by Arkin et al. [25] for the âPencil Packing Problemâ. We will also consider how a single channel might reach several desired dwell segments and alternate heuristics for ordering dwell segments. Several other exciting extensions can be facilitated by innovations in 3D printing. For instance, emerging 3D printing technologies allow printing of a wide variety of materials including FDA-approved plastics, resins, and composites. Multiple materials can be printed in sequence, allowing com-

Fig. 10. Conceptual illustration of how lead shielding could be incorporated into the implant as it is now possible to include multiple materials during 3D printing fabrication. (A) illustrates a channel proximal to a small tumor shown in red. (B,C) are close-up views of the co-axial source, channel, and lead shielding, the latter with a small cylindrical void that serves as a âtargeting windowâ to allow radiation to be emitted toward the tumor while shielding nearby healthy tissue.

plex devices to be printed. Metals such as lead can also be printed, making it possible to incorporate radiation shielding into the implant as it is fabricated. This has potential to shield healthy tissue and direct radiation to small tumor targets as illustrated in Figure 10. ACKNOWLEDGMENT This research was funded in part by NSF Awards IIS1227406 and ARRA 0905344. We thank Zach Mulder for his help ï¬nding the model of human anatomy for the case study and the staff at UCSF Medical Center at Mt. Zion, San Francisco, CA for input on the clinical procedures for GYN HDR brachytherapy. We would also like to thank Ben Kehoe for offering valuable advice in improving the paper. R EFERENCES
[1] J. Valentin et al., âPrevention of High-Dose Rate Brachytherapy Accidents,â Annals of the ICRP, Publication 97, vol. 35, no. 2, p. 1, 2005. [2] K. Wallner, J. C. Blasko, and M. Datolli, Prostate Brachytherapy Made Complicated. Seattle, WA: Smart Medicine Press, 2001. [3] N. MagnÂ´ , C. Chargari, N. SanFilippo, T. Messai, A. Gerbaulet, and e C. Haie-Meder, âTechnical aspects and perspectives of the vaginal mold applicator for brachytherapy of gynecologic malignancies,â Brachytherapy, vol. 9, no. 3, pp. 274â277, 2010. [4] J. Borg and D. Rogers, âMonte carlo calculations of photon spectra in air from 192ir sources,â National Research Council Report PIRS-629r, Ontario, Canada, 1999. [5] Y. Y. Huang and K. H. Low, âComprehensive planning of robotic therapy and assessment of task-oriented functions via improved QFD applicable to hand rehabilitation,â in IEEE Conference on Automation Science and Engineering (CASE), pp. 252â257, 2010. [6] J. Solis and A. Takanishi, âTowards enhancing the understanding of human motor learning,â in IEEE International Conference on Automation Science and Engineering, pp. 591â596, Aug. 2009. [7] J. A. Mendez, S. Torres, J. A. Reboso, and H. Reboso, âModelbased controller for anesthesia automation,â in IEEE International Conference on Automation Science and Engineering, pp. 379â384, Aug. 2009. [8] K. Subburaj, B. Ravi, and M. G. Agarwal, âAutomated 3D geometric reasoning in Computer Assisted joint reconstructive surgery,â in IEEE International Conference on Automation Science and Engineering, pp. 367â372, Aug. 2009.

[9] A. Garg, T. Siauw, D. Berenson, A. Cunha, I.-C. Hsu, J. Pouliot, D. Stoianovici, and K. Goldberg, âInitial experiments toward automated robotic implantation of skew-line needle arrangements for HDR brachytherapy,â in IEEE International Conference on Automation Science and Engineering (CASE), pp. 26â33, Aug. 2012. [10] R. PÂ¨ tter, C. Haie-Meder, E. V. Limbergen, I. Barillot, and Others, o âRecommendations from gynaecological (GYN) GEC ESTRO working group (II): Concepts and terms in 3D image-based treatment planning in cervix cancer brachytherap 3D dose volume parameters and aspects of 3D image-based anatomy, radiation physics, radiobiology,â Radiotherapy and Oncology, vol. 78, no. 1, pp. 67â77, 2006. [11] L. Delclos, G. H. Fletcher, E. Bailey Moore, and V. A. Sampiere, âMinicolpostats, dome cylinders, other additions and improvements of the Fletcher-Suit afterloadable system: Indications and limitations of their use,â International Journal of Radiation Oncology* Biology* Physics, vol. 6, no. 9, pp. 1195â1206, 1980. [12] M. Bernstein, K. J. Mehta, R. Yaparpalvi, H. Kuo, and S. Kalnicki, âResults of the Hybrid Interstitial-Intracavitary Utrecht Aapplicator for cervical cancer in an Outpatient setting,â Radiotherapy and Oncology, vol. 103, p. S116, 2012. [13] J. C. A. Dimopoulos, C. Kirisits, P. Petric, P. Georg, S. Lang, D. Berger, and R. PÂ¨ tter, âThe Vienna applicator for combined o intracavitary and interstitial brachytherapy of cervical cancer: Clinical feasibility and preliminary results,â International Journal of Radiation Oncology*Biology*Physics, vol. 66, no. 1, pp. 83â90, 2006. [14] J. N. Roy, K. E. Wallner, L. L. Anderson, and C. Ling, âCTbased optimized planning for transperineal prostate implant with customized template,â International Journal of Radiation Oncology*Biology*Physics, vol. 21, pp. 483â489, July 1991. [15] H. Lipson and M. Kurman, Fabricated: The New World of 3D Printing. Wiley, 2013. [16] P. F. Jacobs and D. T. Reid, Rapid prototyping & manufacturing: Fundamentals of stereolithography. Society of Manufacturing Engineers in cooperation with the Computer and Automated Systems Association of SME, 1992. [17] F. P. W. Melchels, J. Feijen, and D. W. Grijpma, âA review on stereolithography and its applications in biomedical engineering.,â Biomaterials, vol. 31, pp. 6121â30, Aug. 2010. [18] H. Seitz, W. Rieder, S. Irsen, B. Leukers, and C. Tille, âThreedimensional printing of porous ceramic scaffolds for bone tissue engineering.,â Journal of biomedical materials research. Part B, Applied biomaterials, vol. 74, pp. 782â8, Aug. 2005. [19] J. Dâhaese, T. Van De Velde, A. Komiyama, M. Hultin, and H. De Bruyn, âAccuracy and complications using computer-designed stereolithographic surgical guides for oral rehabilitation by means of dental implants: a review of the literature.,â Clinical implant dentistry and related research, vol. 14, pp. 321â35, June 2012. [20] V. Duindam, R. Alterovitz, and K. Goldberg, âMotion planning for steerable needles in 3D environments with obstacles using rapidlyexploring Random Trees and backchaining,â in IEEE International Conference on Automation Science and Engineering, pp. 41â46, Aug. 2008. [21] S. Patil and R. Alterovitz, âInteractive Motion Planning for Steerable Needles in 3D Environments with Obstacles.,â IEEE/RAS-EMBS International Conference on Biomedical Robotics and Biomechatronics, pp. 893â899, Jan. 2010. [22] N. J. Cowan, K. Goldberg, G. S. Chirikjian, G. Fichtinger, R. Alterovitz, K. B. Reed, V. Kallem, W. Park, S. Misra, and A. M. Okamura, âRobotic needle steering: Design, modeling, planning, and image guidance,â in Surgical Robotics: System Applications and Visions, ch. 23, pp. 557â582, Springer, 2011. [23] M. Hwangbo, J. Kuffner, and T. Kanade, âEfï¬cient Two-phase 3D Motion Planning for Small Fixed-wing UAVs,â in IEEE International Conference on Robotics and Automation, pp. 1035â1041, Apr. 2007. [24] S. M. LaValle, Planning Algorithms. Cambridge, U.K.: Cambridge University Press, 2006. Available at http://planning.cs.uiuc.edu. [25] E. M. Arkin, S. P. Fekete, J. Kim, J. S. Mitchell, G. R. Sabhnani, and J. Zou, âThe pencil packing problem,â 2009. [26] G. van den Bergen, Collision detection in interactive 3D environments. Morgan Kaufmann, 2004. [27] T. Siauw, A. Cunha, A. AtamtÂ¨ rk, I.-C. Hsu, J. Pouliot, and K. Goldu berg, âIPIP: a new approach to inverse planning for hdr brachytherapy by directly optimizing dosimetric indices,â Medical Physics, vol. 38, p. 4045, 2011.

