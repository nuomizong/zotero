Quadrilateral Mesh Simpliﬁcation
Joel Daniels University of Utah Cl´ udio T. Silva a University of Utah Jason Shepherd Sandia National Laboratories Elaine Cohen University of Utah

Figure 1: Our simpliﬁcation algorithm can be used to generate a pure quad level-of-detail hierarchy. The algorithm preserves topology during simpliﬁcation, and attempts to optimize geometric ﬁdelity and quad structure (vertex valences near 4) throughout the process.

Abstract
We introduce a simpliﬁcation algorithm for meshes composed of quadrilateral elements. It is reminiscent of edge-collapse based methods for triangle meshes, but takes a novel approach to the challenging problem of maintaining the quadrilateral connectivity during level-of-detail creation. The method consists of a set of unit operations applied to the dual of the mesh, each designed to improve mesh structure and maintain topological genus. Geometric shape is maintained by an extension of a quadric error metric to quad meshes. The technique is straightforward to implement and efﬁcient enough to be applied to real-world models. Our technique can handle models with sharp features, and can be used to re-mesh general polygonal, i.e. tri- and quad-dominant, meshes into quadonly meshes.

The goal of mesh simpliﬁcation, analogous to downsampling in digital signal processing, is to gracefully remove elements while maintaining mesh ﬁdelity. Mesh simpliﬁcation is an important geometry processing operation that has been used as a building block for many higher-level processing steps, including mesh compression, rendering, progressive transmission, editing operations, smoothing, parameterization, and shape reconstruction. It is for this reason that triangle mesh simpliﬁcation techniques have been some of the most useful operations developed. A major challenge associated with quadrilateral simpliﬁcation, unlike triangle-based techniques, is the consideration of the structured nature of the quadrilateral elements that force global constraints on the mesh connectivity. For instance, it is not possible to create a quadrangulation of a planar surface region bounded by a polyline with an odd number of vertices. For triangle meshes it is possible to limit the attention to local operations, that is, to collapse an edge in a triangle mesh, one only needs to consider the triangles in its one-neighborhood. In contrast, the deletion of a single quad element may require more global consideration, removing a larger collection of elements. Our algorithm includes operations that are related to edge-collapse methods for triangle meshes, but addresses the challenging problem of maintaining the quadrilateral connectivity at all levels-of-detail. The method consists of a set of unit operations applied to the dual of the mesh, each designed to improve mesh structure for various conﬁgurations and maintain topological genus. Fidelity of geometric shape is achieved through an extension of a quadric error metric to quad meshes. Additionally, our technique preserves sharp features in models and can be used for re-meshing tri- and quad-dominant meshes into fully quad-meshes. Contributions. In this paper, we introduce a technique for quadrilateral mesh simpliﬁcation that we term QMS. Our technique is based on the novel idea of exploiting the dual structure of the mesh. We propose simpliﬁcation operators and a prioritization scheme to develop quality mesh structure at coarse representations while leveraging an extension of the quadric error metric to preserve geometry. We also show how our simpliﬁcation algorithm can be used for re-meshing tri- and quad-dominant meshes into fully quadmeshes. Our experimental results demonstrate the efﬁciency and effectiveness of our technique on a variety of models.

1

Introduction

Although in the past geometry processing methods have been dominated by techniques that operate on triangular meshes, there is a growing interest in developing algorithms that operate natively on quad meshes (i.e., meshes composed of only quadrilateral elements). The motivation for the use of this type of mesh has been well articulated in pioneering work on quad re-meshing, e.g., [Lai et al. 2008; Dong et al. 2006; Marinov and Kobbelt 2006; Alliez et al. 2003]. Our attraction to this surface representation can be attributed to the ability of quad elements to naturally describe principal curvature directional ﬁelds and to share a common domain with surface parameterization solutions. These characteristics enable a number of important applications, including texturing and modeling with splines. An additional motivation for our work in quadbased meshing is the use of such models in ﬁnite element analysis.

2

Related Work

While triangle- and tetrahedral-based simpliﬁcation schemes have been thoroughly studied, few techniques exist that directly address quadrilateral mesh simpliﬁcation. Some research has investigated quadrilateral improvement methods [Staten and Canann 1997; Kinney 1997] which results in simpliﬁed models; however, it does not provide a controllable means to reduce element counts in the ﬁnal mesh. Another improvement technique [Bremer et al. 2002], developed to augment vertex valences on grafted surfaces, uses a ring collapse method, related to our poly-chord structure (Sec. 3). Related quadrilateral coarsening approaches have also exploited the ring structure, developing restructuring [Staten et al. 2008] and localized deletion techniques [Dewey 2008]. Quadrilateral remeshing algorithms are used to achieve varying level-of-detail meshes, thus mimicking simpliﬁcation in a bottomup approach. Quadrilateral generation algorithms often have control parameters that tune the sizes of the created elements, with which they can construct meshes with varying levels of detail. Tracing iso-curves over orthogonal vector ﬁelds that form a chart covering a surface yields the connectivity that deﬁnes a quadrilateral mesh [Kalberer et al. 2007; Dong et al. 2005]. This technique extends earlier anisotropic quadrilateral meshing algorithms that use principal curvature to deﬁne the frames over the surface [Marinov and Kobbelt 2004; Alliez et al. 2003]. These techniques generate high quality, feature aware quadrilateral meshes, and can achieve level-of-detail meshes by adapting the spacing between the traced parameter lines. A coarse-to-ﬁne approach for generating quad shape approximation is proposed in [Guskov et al. 2002]. Divide-and-conquer quadrilateral remeshing schemes segment the input model then individually remesh each region. Paving [Blacker and Stephenson 1991] is an early advancing front scheme that generates quadrilateral meshes of segmented and bounded regions of a model. Krishnamurthy and Levoy [1996] proposed a method based on using a grid for resampling regions extracted by a userguided segmentation technique. A two step algorithm [Marinov and Kobbelt 2006] automatically segments the model with a clustering method similar to variational shape approximation [Cohen-Steiner et al. 2004]. Samples are deﬁned uniformly along the boundary edges to obtain water-tight boundaries between adjacent regions; then, the vertices are optimally paired using Bezier curves to deﬁne the quadrilateral elements internal to each region. Morse-Smale complexes automatically segment a surface into regions homeomorphic to a disc [Ni et al. 2004], and parameterization methods can guide the quadrilateral-based remesh [Dong et al. 2006; Tong et al. 2006]. These divide-and-conquer approaches require careful attention along boundary edges to obtain a piece-wise continuous surface representation across the divided regions. By modifying the density of samples during the conquer phase, these techniques are able to output models of varying element counts. Another method of quadrilateral mesh generation is the direct conversion of triangular mesh elements into quadrilaterals. Splitting schemes based on Catmull-Clark subdivision [Catmull and Clark 1978] and its square root extension [Kobbelt 1996], directly transform the triangles into quadrilaterals. However, these techniques greatly increase the number of elements describing the model and tend to result in unstructured meshes. Complete matching conversion, another direct conversion scheme, pairs neighboring triangles to deﬁne a single quadrilateral, the method seeks pairing combinations that will couple every element with another. Q-Morph [Owen et al. 1999] is an advancing front conversion mechanism that builds on this concept. Bubble packing [Shimada 1993; Shimada and Gossard 1995], in particular rectan-

Figure 2: The dual structure of a highly structured mesh is itself highly structured (left); whereas, a non-structured mesh contains a complex dual representation (right).

gular cell based algorithms [Shimada 1999; Viswanath et al. 2000], build quadrilateral-dominant meshes through near complete matchings of Delaunay triangulations. Vertices are distributed over the surface using repulsion forces, where each rectangular cell encodes multiple functions similar to a clustered group of charged particles. Other quadrilateral mesh generation methods [Eck and Hoppe 1996; Takeuchi et al. 2000] leverage conversion methods in combination with triangular-based simpliﬁcation methods. Conversion back-and-forth between the quadrilateral and triangular mesh representations allows the use of established triangle mesh simpliﬁcation algorithms while modeling quadrilateral elements. The control of the ﬁnal element quality is not supported, and may prove difﬁcult, for such approaches because the triangle-based simpliﬁcation is unaware of the related quadrilateral elements. Additionally, conversion between representations can become expensive and unstable, as it is not guaranteed to be one-to-one and onto. Instead, we propose a simpliﬁcation method to directly reduce quadrilateral elements that does not require such conversions. Simpliﬁcation methods execute deletion operations to reduce the number of elements until breaching a prescribed error threshold [Luebke et al. 2002]. In our work, we propose a generalization of the triangle edge collapse (see Sec. 3) that provides promising adaptability to quadrilateral meshing; whereas, quadrilateral vertex merging does not maintain quadrilateral-only meshes and neighborhood reconﬁguration is an inherently expensive operation. Triangular-based simpliﬁcation methods generate an automated prioritization method using a quadric error metric (QEM) [Garland and Heckbert 1997], with extended development [Hoppe 1999; Lindstrom 2002; Lindstrom and Silva 2001], which deﬁnes a measurement tool to compare and minimize the collapse affects on the geometric structure. The QEM matrix encodes the planar equations of the neighboring triangles to store geometric data per vertex or edge. We accumulate the QEM data for the mesh vertices by virtually subdividing each quadrilateral into four triangular elements connecting each edge to the centroid. For further discussion of triangular mesh simpliﬁcation, we direct the reader to [Cignoni et al. 1998] and [Luebke et al. 2002].

3

Quadrilateral Mesh Simpliﬁcation

Our simpliﬁcation algorithm is based on a set of operations that modify the dual structure of the quad mesh in a controlled manner. The dual representation of a quadrilateral mesh [Borden et al. 2002] (see Figs. 2 and 3) is deﬁned to have the following components: • the dual of a quadrilateral element is its centroid, • the dual of a quadrilateral edge is the chord that connects the centroids of neighboring quadrilaterals, • the dual of a vertex is the polygon formed by connecting the centroids, in a cyclic order, of neighboring quad elements.

Figure 3: Three deletion operations utilized throughout this paper: poly-chord (a-c), quadrilateral (d-f) and doublet collapse (g-l). For a quadrilateral mesh with the dual representation (a), deletion of the selected poly-chord (b) merges the vertex groups (red) creating the simpliﬁed mesh (c). A quadrilateral collapse (d) merges two opposing vertices thus modifying the topology of two highlighted chords in the simpliﬁed mesh (e). Deletion of a doublet, two neighboring quadrilaterals that share two consecutive edges (h), removes the common edges to create a single element, altering the dual structure (i). In the presence of an annotated feature, the doublet quadrilaterals (k) are simultaneously collapsed to preserve the topology of the feature (l).

An important structure is the poly-chord, a polyline whose adjacent segments are chords that meet at a common centroid and are dual to opposing edges in that quadrilateral. On a closed quadrilateral mesh without boundaries, the poly-chords always form closed loops. That is, starting at a single edge on a closed quadrilateral mesh and traversing opposite edges on adjacent quadrilaterals, the traversal will always end at the starting edge. The polychord is a generalization of the ring structure constructed in related quadrilateral-based research [Bremer et al. 2002; Dewey 2008]. Many simpliﬁcation techniques for triangle meshes are based on edge-collapse operations. Unfortunately, if an edge is collapsed in a quad structure, triangles are introduced and structure is lost. We adapt ideas proposed in [Shepherd 2007] who showed, in the context of hexahedral mesh generation, that the quality of a hex mesh is related to properties of its dual structure. In our case, we use the dual structure as a tool for designing simpliﬁcation operators. In order to sharpen our intuition, consider the dual structure of the two different quad representations of a torus shown in Fig. 2. A high-quality quad mesh of a torus (shown on the left) with uniform valence 4 vertices has a similar dual structure, with chords that tend to meet at approximately right angles, poly-chordal loops that exhibit low curvature, and polygons that are dual to the vertices are generally rectangular (i.e., four-sided). The lower-quality quad mesh (shown on the right) has chords intersecting with nonright angles, poly-chordal loops that exhibit higher curvature, and the polygons that are dual to the vertices of the mesh are typically non-rectangular (i.e., typically, are not four-sided). Below, we design operators that are used to modify the dual structure of the quad mesh to improve its overall quality. To raise geometric ﬁdelity, we extend the well-known quadric-error metric to assist prioritization of the simpliﬁcation operators based on the geometric error incurred by each operation, as well as to determine the locations of created vertices.

it passes by merging the vertices of each edge dual to the selected poly-chord. A poly-chord, as it is related to hexahedral meshing, is equivalent to the intersection of a hexahedral dual sheet [Murdoch et al. 1997] with the boundary surface. Because removal of hexahedral sheets has been shown to preserve the hexahedral connectivity during mesh improvement [Borden et al. 2002], it follows that the lower dimensional equivalent, poly-chord deletions, preserve quadrilateral-only surface elements. Quadrilateral Collapse. The quadrilateral collapse is a localized deletion operator that removes a selected element by merging diagonally opposing vertices (also described as a quadrilateral close [Kinney 1997]). By imagining the quadrilateral as two triangle elements connected by an edge between the merging vertices, observe that the described quadrilateral collapse is a generalization of the triangle edge collapse. The elements modiﬁed by a quadrilateral collapse are limited to a local neighborhood and maintains our quadrilateral-only constraint. We emphasize the modiﬁcations that result to the connectivity of the dual poly-chords, observing that the collapse describes a swap in the connectivity of two poly-chords. Doublet Collapse. Doublets, neighboring quadrilaterals that share two consecutive edges, are removed from the quadrilateral mesh following each collapse operation. The valence 2 doublet vertex describes a degenerate critical point, associated with a degenerate dual polygon. Under normal circumstances, a doublet is removed by merging the two faces into a single quadrilateral element modifying the connectivity of the highlighted dual chords. The removal of a doublet may generate new doublets, requiring additional deletions, and, similar to the quadrilateral collapse, modiﬁes the structure of two poly-chords.

3.2

Prioritizing Operations

3.1

Simpliﬁcation Operations

We introduce three different simpliﬁcation operators, each designed to modify the dual representation of a quadrilateral mesh, as illustrated in Fig. 3. The poly-chord collapse is a global operator while and the quadrilateral and doublet collapses induce modiﬁcation of the dual structure through localized deletions. Poly-Chord Collapse. Removal of a poly-chord from the dual representation simultaneously deletes all quadrilaterals through which

To improve the mesh connectivity and maintain geometric ﬁdelity, it is important that the algorithm selects the elements for deletion intelligently. The prioritization of the collapse operations is achieved by queuing the elements based on the impact of the deletion on the resulting mesh. A combination of factors is considered by the weighting scheme, including the quality of the ﬁnal vertex valences, the geometric loss, and the area distortion associated with each collapse operator. Consequently, our prioritization scheme is able to reduce the accumulated geometric error while improving the element quality during sequential deletions. The poly-chord collapse is a more complicated operator than the quadrilateral deletion so the weighting scheme discussion focuses

user to vary the inﬂuence of the geometric-, area-, and valencebased functions. For a quadrilateral q with vertices (in counterclockwise order) a, b, c, d, the QEM measurement Eq (q) associated with a quadrilateral collapse is based on the loss of shape ﬁdelity induced by merging the chosen opposing vertices, for example, merging a and c to vac . The area term Ed (q) measures the ˜ distance between the two merging vertices of q. The ﬁnal weighting term, Ev (q), measures the difference between the current vertex valences and the new conﬁguration and is biased to favor collapses that improve the local connectivity. The valence term sums the difference of the created valences from the originals, Ev (q) = βa (|ν(a) − 4| − |ν(˜ac ) − 4|) v + δb (|ν(b) − 5| − |ν(b) − 4|) + βc (|ν(c) − 4| − |ν(˜ac ) − 4|) v + δd (|ν(d) − 5| − |ν(d) − 4|) ( 0, if |ν(i) − 4| ≤ |ν(˜) − 4| v βi = 1, otherwise ( 0, if |ν(i) − 5| ≤ |ν(i) − 4| δi = 1, otherwise Thus, Ev penalizes quadrilateral collapses that lower the quality of the local vertex valences. Note that for a given quadrilateral two collapse conﬁgurations exist, each with distinct metrics. Finally, doublets are given the highest priority and collapsed when detected.

Figure 4: A poly-chord may form a complex knot over a signiﬁcant portion of the mesh (a single poly-chord is shown in the image on the right) complicating, and often invalidating, its collapse. The localized quadrilateral collapse is used to modify the chord structure, unwinding such knots. on this operator. The error metric E assigned to a poly-chord p is E(p) = αq (1 − e−Eq (p) ) + αd (1 − e−Ed (p) ) + αv (1 − e−Ev (p) ) where αs are user deﬁned positive scalars that sum to 1. This function considers multiple contributors, written as 1 − ex to scale the terms to the range [0, 1], that weigh the impact of the deletion, similar in purpose to [Smith and Boier-Martin 2005]. The user deﬁned α’s allow control of each term’s inﬂuence. The function Eq (p) returns the worst case QEM error over all of the groups of merging vertices for the poly-chord p, representing an upper bound on the geometric impact of the collapse. QEM matrices are computed for the mesh vertices by virtually subdividing each quadrilateral into four triangular elements connected at the quadrilateral centroid. This allows for a hinging effect to accommodate for non-planar quadrilaterals while accumulating the planar equations for the original mesh vertices using the established trianglebased QEM scheme. The function Ed (p) evaluates the length of the longest edge collapse (or group of edges) due to the collapse of the poly-chord p. The purpose of Ed is to prioritize collapses in order to construct square elements. The ﬁnal weighting term, Ev (p), measures the change in vertex valences from the ideal 4 and penalizes poly-chord collapses that deteriorate the valences of neighboring vertices. The poly-chord p Ni is decomposed into multiple vertex groups Vi = {vi,j=0 }M that i=0 merge to a single new vertex vi , illustrated in Fig. 3b. The valence ˜ weighting term sums the worst created valence with the average, Ev (p) = max max βi,j (|ν(vi,j ) − 4| − |ν(˜i ) − 4|)) v
i j

3.3

Na¨ve Simpliﬁcation ı

The repeated iteration of any single collapse operator, while ideal in some circumstances, proves inadequate when applied to a broader spectrum of quadrilateral mesh connectivity. In particular, illustrated in Fig. 7, the poly-chord simpliﬁcation scheme ideally reduces the structured Pensatore quadrilateral mesh, maintaining the high quality elements at all levels of detail. However, in an unstructured model, poly-chord deletions create many high valence vertices and poorly shaped quadrilaterals. Furthermore, the method terminates early, unable to generate lower resolution models, due to the creation of a complex poly-chord structure. Even for quadrilateral meshes that exhibit a relatively structured connectivity (Fig. 4) the poly-chords may exhibit a knotting effect, winding over a signiﬁcant portion of the model, prohibiting further deletions. On the other hand, the quadrilateral-based scheme is not impeded by the dependence on the dual structure. Given unstructured meshes, the weighting scheme prioritizes the collapses such that the number of ideal vertices signiﬁcantly improves through simpliﬁcation, illustrated in Fig. 7. However, this technique increases the number of non-ideal valence vertices undesirably during simpliﬁcation of structured quadrilateral meshes.

+ 1/M

M X i=0

1/Ni

Ni X j=0

3.4
βi,j (|ν(vi,j ) − 4| − |ν(˜i ) − 4|)) v

Simpliﬁcation Algorithm

βi,j

( 0, if |ν(vi,j ) − 4| ≤ |ν(˜i ) − 4| v = 1, otherwise

where ν(v) returns the valence of v. Thus, Ev penalizes poly-chord collapses that result in non-ideal vertices while sorting the deletions with equivalent worst cases based on their average created valence. The weighting metric assigned to each quadrilateral element for the quadrilateral collapse is computed similarly as E(p), allowing the

We propose a novel quadrilateral mesh simpliﬁcation, that we call QMS, algorithm that balances the poly-chord and quadrilateral collapses to achieve a ﬂexibility that generates high quality results independent of the structure of the mesh connectivity, further analyzed in Sec. 4. As shown in the state diagram, illustrated in Fig. 5, the algorithm favors the poly-chord collapse, iteratively choosing the deletion that best improves the mesh’s connectivity while least affecting its geometry (looping over state transitions a and b). When no further poly-chord collapses are available, bounded by threshold tolerances, the algorithm selects a quadrilateral element for deletion (state transition c). The quadrilateral collapse modiﬁes

the local neighborhood’s adjacencies and alters the dual poly-chord structure. Consequently, the algorithm returns to the poly-chord collapse state (via state transitions d and b), to inspect the deletion eligibility of the newly conﬁgured poly-chords. By removing the doublets after each collapse (state transitions a and d), as opposed to implementing a ﬁnal pass, our experiments indicated a better control over the element count and quality of the ﬁnal mesh. The state transition from the poly-chord collapse to the quadrilateral-based collapse enables the adaptive nature of our simpliﬁcation method. This approach relies on the quadrilateral collapse to unwind complex knots that prevent poly-chord collapses, illustrated in Fig. 4, to continue simpliﬁcation. Furthermore, given unstructured meshes, the algorithm quickly transitions to the quadrilateral collapse, avoiding the poor quality results associated with poly-chord deletions. Alpha Terms. For the simpliﬁcation results shown throughout this paper, mesh connectivity is the dominant factor of the sorting metrics (αv = 0.9, αq , αd = 0.05). With these settings, the collapses are sorted primarily by the quality of the valences created during the deletion, greedily selecting the best possible vertex valence conﬁguration after each iteration. The small weights given to the QEM and area metrics allow similar valence generating collapses to be sorted based on their geometric impact. The rationale for the three different error terms is to offer user controls to allow for tuning, necessary in pathological cases. For instance, the rook model (Fig. 5) has a latitude-longitude based connectivity with two polar points. For this model, the classic valencebased weighting scheme deletes all longitudinal poly-chords prior to any of the latitude oriented poly-chords. This creates many elongated rectangles, prompting, instead, a weighting scheme that split the QEM and area terms evenly with little or no emphasis on the valence information (αv = 0.05, αq , αd = 0.475). Mesh Smoothing. The QEMs associated with each collapse are used primarily to inﬂuence the new vertex locations to better maintain the surface geometry. However, as illustrated in Fig. 6, these vertex locations may not create high quality quadrilaterals. To improve element quality, we implement a posteriori smoothing procedure described by [Zhang et al. 2005], to modify vertex locations applied after the simpliﬁcation has ﬁnished. The mesh vertices are perturbed in the normal direction to reduce mesh noise while preserving the mesh volume; simultaneously, a tangential movement is included to improve the quad aspect ratios. Note that one reason to prioritize valence 4 vertices in the alpha parameters is that it augments element quality obtained through smoothing. Topology Preservation. To preserve the topology of the manifold mesh, we virtually turn the quadrilateral mesh into a simplicial mesh and use the Link condition [Edelsbrunner 2006]. In the neighborhood of a quadrilateral collapse, the quadrilaterals are divided

Figure 6: The original model, 22k quadrilaterals with 50% ideal vertices, is reduced to 5k quadrilaterals with 96% ideal vertices. The diagrams compare angle distributions, goal 90◦ , before and after the smoothing process.

into two triangles by inserting a cross-diagonal edge radiating from the merging vertices, equating its link condition discussion to that of the triangular edge collapse. Because the poly-chord collapse consists of multiple simultaneous edge contractions, the discussion is more complicated. Deletion of the poly-chord p executes multiple edge collapses simultaneously, merging the vertex pairs Vi into the new vertices vi ˜ for each mesh edge dual to p. Where the poly-chord is adjacent to itself or self-intersects, illustrated in Fig. 3, multiple vertex pairs Vi will merge into a single vertex; however, for this discussion, each edge is inspected individually. While inspecting a vertex pair Vi , the remaining vertex pairs are temporarily replaced with their collapse vertex Vk = vk , ∀k, k = i, to account for the multiple edge ˜ collapses occurring. The remaining quadrilaterals sharing the vertices in Vi are virtually divided into two triangles by inserting the cross-diagonal edge originating from one of the vertices in Vi . The mesh topology is preserved during poly-chord deletions by comparing the intersection of Link conditions associated with the oneneighborhoods of the vertices in Vi to the union of those associated with the one-neighborhood of the mesh edge connecting Vi . For further details, we refer the reader to [Edelsbrunner 2006]. Complexity. The complexity of a single call to the different operators differ; while quadrilateral and doublet collapse operators take Θ(1), a single poly-chord operation can take Θ(n). Still, it is not hard to use amortized analysis to show that the overall cost of each operation is still Θ(1). The argument is based on the fact that once an element is deleted, it is not touched again. Sharp Features. In some applications, the preservation of user annotated feature edges is important. Our method supports the preservation of feature edges. Included in Fig. 11 are two manufacturable models that contain user annotated features highlighting the sharp edges of the mesh. Our implementation ensures that the simpliﬁed feature edges are homeomorphic to their original counterparts. Conceptually, triangular facets are created by connecting each feature edge to a temporary transition vertex. In this way, the feature edges belong to

Figure 5: Our QMS state diagram.

Figure 7: Simpliﬁcation results for a structured (left) and an unstructured (right) quad mesh using the poly-chord, quad-based and QMS algorithms. The poly-chord method maintains high quality elements for a structured mesh, but generates high vertex valences for unstructured meshes at intermediate resolutions and is unable to complete the simpliﬁcation to lower resolutions. The quad-based simpliﬁcation generates additional critical points on the structured mesh, but improves the unstructured mesh’s structure. QMS mimics the poly-chord results for structured meshes and the quad-based results for unstructured meshes, performing well, independent of the underlying connectivity.

three polygonal faces, thus deﬁning degree-3 edges. The remaining edges of the 2-manifold quadrilateral mesh are degree-2, shared by only 2 quadrilateral elements. The Link condition supports the preservation of the non-2-manifold edges to ensure topological isomorphism of the annotated features. The preservation of feature edges deﬁnes additional constraints that restrict the simpliﬁcation operators and invalidate some potential collapses. While this is terminal for the poly-chord and quadrilateral collapse operators, we deﬁne a special case to handle doublet deletions along feature edges. Illustrated in Fig. 3, when the shared edges of a doublet are annotated as part of a feature edge, the two quadrilaterals are simultaneously collapsed. If the synchronized quadrilateral collapse special case maintains the topology of the mesh and features edges, the doublet is removed from the mesh.

4

Experimental Results and Applications

We have implemented the QMS algorithm as described in Sec. 3 in C++. Our code was written with ﬂexibility in mind, with no particular effort given to optimizations for speed at this time. The running times reported in this section were performed on a dual core AMD Opteron 2.21 GHz processor with 4GB memory. The code is robust, and our implementation has been tested on a large of quadrilateral meshes, including those shown in this paper. For quad meshes, in addition to the visual quality of the simpliﬁed models as shown in Fig. 11, we consider quality metrics measured to assess the ﬁnal results. Here, we examine the connectivity of the simpliﬁed meshes as well as the quality of the quadrilateral elements. An ideal vertex, important in ﬁnite element meshing, has a valence of 4. Non-ideal vertices are critical points that complicate parameterization solutions and geometric computations. Included in Table 1 is the percentage of ideal vertices, the number of critical points, and the worst case valence for each mesh. To further investigate the quality of the quadrilateral elements, in Fig. 8 we plot a histogram of the original and simpliﬁed element angles and scaled Jacobians. The scaled Jacobian is a metric equal to 1.0 for a rectangular element, 0.0 if three vertices (of the four) are co-linear, and negated if the quadrilateral is not convex. Ideally, the angles of a quadrilateral mesh are near 90◦ and the scaled Jacobians near 1.0, corresponding to orthogonal corners in the mesh.

Figure 8: A comparison of the angle distributions and scaled Jacobians measured on the original and QMS simpliﬁed meshes shown throughout this paper, analyzed in Table 1. The QMS algorithm produces angles near 90◦ and scaled Jacobians near 1.0 despite the input distributions.

As shown in Table 1, the QMS algorithm generates high quality connectivity, maintaining low worst case valences and reducing the number of extraordinary points. For unstructured models, i.e. the bumpy torus and the Pensatore2 , the simpliﬁcation results signiﬁcantly improve the percent of ideal valence vertices. Simpliﬁcation of highly structured models, i.e. the Pensatore1 and Ra models, generates high quality results. In some cases, the number of extraordinay points increases on the semi-structured models, i.e. the Bimba and casting models. This is due to a number of quadrilateral collapses executed in order to unwind complex poly-chords (Fig. 4). The improved connectivity augments the quality of the correspond-

Model Pensatore1

|Quads| 44k 5.2k 2.5k 46k 5.7k 2.9k 95k 23.5k 62.8k 15.5k 7.8k 3.9k 970 32.4k 8k 4k 2k 490 20.8k 5.1k 2.6k 1.3k 630 3.9k 925 450 190 95

Time (sec) n/a 52 53 n/a 157 160 n/a 878 n/a 479 500 505 506 n/a 115 119 120 121 n/a 30 31 32 32 n/a 1 1 1 1

Vertex Valences % Ideal |Critical| Worst 99.9% 99.9% 99.9% 50% 76% 80% 50% 66% 98% 94% 92% 89% 80% 97% 91% 88% 84% 73% 98% 90% 86% 79% 67% 98% 94% 90% 81% 69% 8 8 8 23k 1.3k 556 47.6k 8006 726 898 600 398 189 876 678 475 314 131 405 491 344 259 205 52 52 44 36 28 3 3 3 10 7 6 13 10 6 6 6 7 6 6 6 6 6 6 6 6 6 6 6 5 5 5 5 5

Pensatore2 Torus

Bimba

Fish

Casting

Figure 10: The elements of a triangular mesh (a) are split using a Catmull-Clark based scheme to generate a quadrilateral-only mesh (b) which is simpliﬁed to the original element count (c).

Ra

Table 1: Performance and vertex valence analysis of models shown throughout the paper: the structured and unstructured pensatore (1,2 respectively, Fig. 7), the bumpy torus (Fig. 10), and the bimba, ﬁsh, casting and Ra (Fig. 11) models.

Because our simpliﬁcation method preserves the quadrilateral connectivity, the proposed remeshing technique generates quad-only remeshes of polygonal, i.e. tri- and quad-dominant, models. Geometric error thresholds during simpliﬁcation are used to constrain the output remesh within a bounded distance of the original model surface. Additionally, our validation methods maintain mesh topology and user-annotated feature edges, thus recreating important (i.e. sharp) curves from the original model. We can further improve the ratio of ideal valence vertices to critical points by extending the remeshing pipeline, simplifying to a quarter of the desired element count then subdivide the results via CatmullClark. The additional simpliﬁcation and subdivision increases the geometric error of the ﬁnal results. Consequently, it may necessitate a projection of the ﬁnal vertices to the original surface.

ing quadrilateral elements (Fig 8). Despite the quality of the input models, our QMS algorithm results in simpliﬁed meshes with good quality angles and scaled Jacobians. Some degradation is inherent, similar to the geometric error incurred during the deletions. Importantly, the element quality of the two models with poor original distributions in Fig. 8, corresponding to the bumpy torus (Fig. 10) and the Pensatore2 (Fig. 7), are improved through the QMS simpliﬁcation. There are no similarly bad distributions evident in the simpliﬁed histograms. The low quality mesh angles and corresponding scaled Jacobians are attributed to the preservation of feature edges, i.e. the casting and Ra models (Fig. 11), discussed in Sec. 5.

5

Discussion & Limitations

4.1

Quadrilateral Remeshing

We introduce a novel approach to quadrilateral remeshing of arbitrary topological and polygonal surface meshes. Our remeshing pipeline constructs a quad-only mesh by splitting the polygonal elements based on the rules of Catmull-Clark subdivision then simpliﬁes to the desired element count, illustrated in Fig. 10. A single iteration of Catmull-Clark subdivision constructs quad-only meshes despite the polygonal types of the original model, shown in Fig. 9.

Our QMS algorithm balances poly-chord and quad-based simpliﬁcation operators to generate quality meshes independent of the underlying mesh structure. As illustrated in Fig. 7, QMS is an improved approach over any single operation type. For the structured mesh, QMS behaves similarly to the poly-chord simpliﬁcation method, better maintaining mesh regularity with a minimal number of critical points and near orthogonal edges. However, where the poly-chord collapse performs poorly, terminating early on the unstructured mesh, QMS instead mimics the results of the quad-based simpliﬁcation scheme. Due to the global effects of the polychord collapse operator, it is difﬁcult to limit the deletions to localized regions. However, this operator describes a deletion scheme that can not be duplicated by any number of localized quadrilateral collapses, and it proves instrumental in the preservation of high quality connectivity. The assorted deletion types enable a ﬂexibility within our QMS algorithm, generating quality LOD meshes for arbitrary mesh structures. Quadric error metrics are used to reduce the loss of geometric ﬁdelity experienced during the simpliﬁcation process. Consequently, even when the weighting metrics used to sort the simpliﬁcation operators heavily emphasize connectivity improvement, the reduced meshes maintain high shape ﬁdelity. Illustrated in Fig. 11 are several organic and machined models simpliﬁed using the QMS algorithm, weighing the deletions solely based on connectivity.

Figure 9: A single iteration of the Catmull-Clark splitting scheme generates quad-only meshes despite the original polygonal type.

Figure 12: The QMS algorithm generates controlled level-of-detail representations, shown in the comparison between QEM triangle mesh simpliﬁcation and our method for the dragon model with 150k elements (top) at 37.5k (middle) and 9.4k elements (bottom).

Figure 11: The hybrid simpliﬁcation generates controlled level-ofdetail representations for quadrilateral-only models while preserving the topology of the mesh and annotated features.

Our simpliﬁcation algorithm is unable to discern when too many elements have been deleted from constrained regions surrounding the user annotated feature edges. In practice, simpliﬁcation to coarse representations generates low quality edge angles (Fig. 8), sometimes resulting in negative scaled Jacobians, indicating inverted elements. These poorly shaped elements typically reside in regions of the constrained feature edges. While the mesh topology is preserved, the inverted elements may inhibit computations and visualization of the mesh. Another issue is that when compared to triangle simpliﬁcation (Fig. 12), it is harder to maintain small detailed features like the scales of the dragon because of the global nature of the poly-chord collapses. However, it should be possible to annotate such regions as feature edges to preserve these structures.

rently, the scheme implements a greedy prioritization, that focuses on improving the connectivity of the mesh. It may be possible to improve the ﬁnal results of the QMS algorithm by intelligently selecting quad collapses that better improve the poly-chord structure. We would like to further explore other optimizations, including minimizing extraordinary vertices, controlling element size and scaling, aligning elements to curvature vectors and other related challenges. We are also interested in creating high-efﬁcient implementations of this framework, including out-of-core and streaming approaches. Furthermore, we are interested in other applications, e.g., quality remeshing and progressive quad-based compression. Acknowledgments. We would like to thank Matt Berger, PeerTimo Bremer, Tiago Etiene, Valerio Pascucci, Carlos Scheidegger, John Schreiner, and the anonymous reviewers for insightful discussions and constructive comments. We thank the AIM@SHAPE project for access to 3-D models used in our research. This research has been funded the National Science Foundation (grants CCF-0541402, CNS-0751152, CCF-0528201, OCE-0424602, CNS-0514485, IIS-0513692, CCF-0401498, OISE0405402, CNS-0551724), the Department of Energy SciDAC (VACET and SDM centers), and IBM Faculty Awards (2005, 2006, and 2007). Sandia is a multiprogram laboratory operated by Sandia Corporation, a Lockheed Martin Company, for the United States Department of Energy’s National Nuclear Security Administration under contract DE-AC04-94AL85000.

6

Conclusion

In this paper we show how it is possible to use the dual structure to develop a quadrilateral mesh simpliﬁcation (QMS) technique. To the best of our knowledge, QMS is the ﬁrst fully automatic technique for simpliﬁcation of quad meshes using quality metrics. Robustness is one of the key strengths of this approach; we have successfully experimented with our QMS implementation on a large number of models. Another is simplicity; it is relatively easy to implement our algorithm and reproduce our results. We only touched on the potential applications of this framework with our description of a simple quad remeshing approach. We believe this technique can be used as a building block in many other geometry processing algorithms for quad meshes. There are many avenues for future research. We plan to investigate improvements of the simpliﬁcation weighting, stressing the relationship between the quad collapse and the dual structure. Cur-

References
´ A LLIEZ , P., C OHEN -S TEINER , D., D EVILLERS , O., L E VY, B., AND D ESBRUN , M. 2003. Anisotropic polygonal remeshing. In ACM SIGGRAPH, 485–493. B LACKER , T., AND S TEPHENSON , M. 1991. Paving: A new approach to automated quadrilateral mesh generation. International Journal for Numerical Methods in Engineering (May), 811–847.

B ORDEN , M., B ENZLEY, S., AND S HEPHERD , J. 2002. Hexahedral sheet extraction. In 11th International Meshing Roundtable, 147–152. B REMER , P., P ORUMBESCU , S., J OY, K., AND H AMANN , B. 2002. Automatic semi-regular mesh construction from adaptive distance ﬁelds. Curve and Surface Fitting: Saint-Malo. C ATMULL , E., AND C LARK , J. 1978. Recursively generated bspline surfaces on arbitrary topological meshes. Computer Aided Design 10, 6, 350–355. C IGNONI , P., M ONTANI , C., AND S COPIGNO , R. 1998. A comparison of mesh simpliﬁcation algorithms. Computers and Graphics 22, 1 (February), 37–54. C OHEN -S TEINER , D., A LLIEZ , P., AND D ESBRUN , M. 2004. Variational shape approximation. In ACM SIGGRAPH, 905– 914. D EWEY, M. 2008. Automated Quadrilateral Coarsening by Ring Collapse. Master’s thesis, Bringham Young University. D ONG , S., K IRCHER , S., AND G ARLAND , M. 2005. Harmonic functions for quadrilateral remeshing of arbitrary manifolds. Computer Aided Geometric Design 22, 5, 392–423. D ONG , S., B REMER , P.-T., G ARLAND , M., PASCUCCI , V., AND H ART, J. C. 2006. Spectral surface quadrangulation. In ACM SIGGRAPH, 1057–1066. E CK , M., AND H OPPE , H. 1996. Automatic reconstruction of b-spline surfaces of arbitrary topological type. In ACM SIGGRAPH, 325–334. E DELSBRUNNER , H. 2006. Geometry and Topology for Mesh Generation. Cambridge University Press, New York, NY, USA. G ARLAND , M., AND H ECKBERT, P. 1997. Surface simpliﬁcation using quadric error metrics. In ACM SIGGRAPH, 209–216. ¨ G USKOV, I., K HODAKOVSKY, A., S CHR ODER , P., AND S WELDENS , W. 2002. Hybrid meshes: multiresolution using regular and irregular reﬁnement. In ACM Symposium on Computational Geometry, 264–272. H OPPE , H. 1999. New quadric metric for simplifying meshes with appearance attributes. In IEEE Visualization, 56–66. K ALBERER , F., N IESER , M., AND P OLTHIER , K. 2007. Quadcover: Surface parameterization using branched coverings. Computer Graphics Forum 26, 3, 375–384. K INNEY, P. 1997. Cleanup: Improving quadrilateral ﬁnite element meshes. In 6th International Meshing Roundtable, 437–447. KOBBELT, L. 1996. Interpolatory subdivision on open quadrilateral nets with arbitrary topology. Computer Graphics Forum 15, 3, 409–420. K RISHNAMURTHY, V., AND L EVOY, M. 1996. Fitting smooth surface to dense polygon meshes. In ACM SIGGRAPH, 313– 324. L AI , Y.-K., KOBBELT, L., AND H U , S.-M. 2008. An incremental approach to feature aligned quad dominant remeshing. In ACM Solid and Physical Modeling Symposium. L INDSTROM , P., AND S ILVA , C. 2001. A memory insensitive technique for large model simpliﬁcation. In IEEE Visualization, 121–126. L INDSTROM , P. 2002. Out-of-core simpliﬁcation of large polygonal meshes. In ACM SIGGRAPH, 259–262.

L UEBKE , D., WATSON , B., C OHEN , J. D., R EDDY, M., AND VARSHNEY, A. 2002. Level of Detail for 3D Graphics. Elsevier Science Inc., New York, NY, USA. M ARINOV, M., AND KOBBELT, L. 2004. Direct anisotropic quaddominant remeshing. In Paciﬁc Graphics, 207–216. M ARINOV, M., AND KOBBELT, L. 2006. A robust two-step procedure for quad-dominant remeshing. Computer Graphics Forum 25, 3, 537–546. M URDOCH , P., B ENZLEY, S., B LACKER , T., AND M ITCHELL , S. 1997. The spatial twist continuum: A connectivity based method for representing all-hexahedral ﬁnite element meshes. Finite Element in Analysis and Design 28, 2 (December), 137–149. N I , X., G ARLAND , M., AND H ART, J. C. 2004. Fair morse functions for extracting the topological structure of a surface mesh. In ACM SIGGRAPH, 613–622. OWEN , S., S TATEN , M., C ANANN , S., AND S AIGAL , S. 1999. Q-morph: An indirect approach to advancing front quad meshing. International Journal for Numerical Methods in Engineering (March), 1317–1340. S HEPHERD , J. 2007. Topologic and Geometric Constraint-Based Hexahedral Mesh Generation. PhD thesis, University of Utah. S HIMADA , K., AND G OSSARD , D. C. 1995. Bubble mesh: automated triangular meshing of non-manifold geometry by sphere packing. In 3rd ACM Symposium on Solid Modeling and Applications, 409–419. S HIMADA , K. 1993. Physically-based mesh generation: automated triangulation of surfaces and volumes via bubble packing. PhD thesis, Massachusetts Institute of Technology. S HIMADA , K. 1999. Quadrilateral meshing with directionality control via close packing of square cells. SIAM Conference on Geometric Modeling. S MITH , J., AND B OIER -M ARTIN , I. 2005. Combining metrics for mesh simpliﬁcation and parameterization. In ACM SIGGRAPH Sketches, 135. S TATEN , M. L., AND C ANANN , S. A. 1997. Post reﬁnement element shape improvement for quadrilateral meshes. ASME AMD: Trends in Unstructured Mesh Generation, 9–16. S TATEN , M., B ENZLEY, S., AND S COTT, M. 2008. A methodology for quadrilateral ﬁnite element mesh coarsening. Engineering with Computers, 241–251. TAKEUCHI , S., S UZUKI , H., K IMURA , F., K ANAI , T., AND S HI MADA , K. 2000. Subdivision surface ﬁtting with qem-based mesh simpliﬁcation and reconstruction of approximated b-spline surfaces. In Paciﬁc Graphics, 202. T ONG , Y., A LLIEZ , P., C OHEN -S TEINER , D., AND D ESBRUN , M. 2006. Designing quadrangulations with discrete harmonic forms. In Symposium on Geometry Processing, 201–210. V ISWANATH , N., S HIMADA , K., AND I TOH , T. 2000. Quadrilateral meshing with anisotropy and directionality control via close packing of rectangular cells. In 9th International Meshing Roundtable, 227–238. Z HANG , Y., BAJAJ , C., AND G UOLIANG , X. 2005. Surface smoothing and quality improvement of quadrilateral/hexahedral meshes with geometric ﬂow. In 14th International Meshing Roundtable, 449–468.

